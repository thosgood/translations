\documentclass[a4paper,fleqn]{article}

\usepackage[left=1.6in,right=1.6in,top=1.3in,bottom=1.3in]{geometry}

\title{\sc{Structured categories}}
\author{Charles Ehresmann}
\date{1963}

\newcommand{\origcit}{%
  \textsc{Ehresmann, Charles.}
  ``Catégories structurées''.
  \par\emph{Annales scientifiques de l'École normale supérieure}~\textbf{80} (1963), pp.~349--426.
  \par\url{http://www.numdam.org/item/?id=ASENS_1963_3_80_4_349_0}
}


%% Standard packages %%

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{colorlinks,linkcolor={blue!50!black},citecolor={blue!50!black},urlcolor={blue!80!black}}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{footmisc}
\usepackage{tikz-cd}
\usetikzlibrary{arrows,arrows.meta}
\tikzcdset{arrow style=tikz, diagrams={>=latex}}


%% Typography and such %%

% \usepackage{fouriernc}
\usepackage{Baskervaldx}
\usepackage[cal=boondoxo]{mathalfa}

\renewcommand{\thesection}{\Roman{section}}
\renewcommand{\thesubsubsection}{\Roman{subsubsection}}
\setcounter{secnumdepth}{2}


%% Environments %%

\usepackage{amsthm}
\usepackage[capitalize,nameinlink]{cleveref}

\crefname{section}{§\!}{§§\!}
\crefname{subsection}{§\!}{§§\!}
\crefname{subsubsection}{§\!}{§§\!}

\newenvironment{translator}[1]
  {\phantomsection\par\medskip\noindent\small\textbf{#1.}\itshape}
  {\par\medskip}

\theoremstyle{plain}

\newtheorem{innertheorem}{Theorem}
% \newtheorem*{innertheorem*}{Theorem}
\newenvironment{theorem}[1]
  {\renewcommand\theinnertheorem{#1}\innertheorem}
  {\endinnertheorem}
  % {\expandafter\ifx\expandafter\relax
  % \renewcommand\theinnertheorem{#1}\innertheorem\relax\else\innertheorem*\fi}
  % {\expandafter\ifx\expandafter\relax
  % \endinnertheorem\relax\else\endinnertheorem*\fi}
\newtheorem*{theorem*}{Theorem}

\newtheorem{innerproposition}{Proposition}
\newenvironment{proposition}[1]
  {\renewcommand\theinnerproposition{#1}\innerproposition}
  {\endinnerproposition}
\newtheorem*{proposition*}{Proposition}

\newtheorem{innercorollary}{Corollary}
\newenvironment{corollary}[1]
  {\renewcommand\theinnercorollary{#1}\innercorollary}
  {\endinnercorollary}
\newtheorem*{corollary*}{Corollary}

\theoremstyle{definition}

\newtheorem{innerdefinition}{Definition}
\newenvironment{definition}[1]
  {\renewcommand\theinnerdefinition{#1}\innerdefinition}
  {\endinnerdefinition}

\newtheorem*{remark}{Remark}
\newtheorem*{remarks}{Remarks}
\newtheorem*{example}{Example}
\newtheorem*{examples}{Examples}
\newtheorem*{particular}{Particular case}

\usepackage{etoolbox}
% \AtEndEnvironment{definition}{\par\ignorespacesafterend\hfill$\lrcorner$}

\makeatletter
\def\blfootnote{\xdef\@thefnmark{}\@footnotetext}
\makeatother
\newcommand{\comm}[2]{{\normalfont\textsuperscript{[#1]}}\blfootnote{\label{footnote:#1}\textbf{[#1]} #2}}

\usepackage{mdframed}

\newenvironment{longcomm}[1]
  {\noindent\textbf{[#1]}\rmfamily}
  {}
\surroundwithmdframed[innertopmargin=10pt,innerbottommargin=10pt]{longcomm}


%% Shortcuts %%

\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}

\newcommand{\oldpage}[1]{{\marginpar{\footnotesize$\bigg\vert$\,\,\,\,\textit{p.~#1}}}}
\newcommand{\todo}{{\color{purple}\textbf{TO-DO }}}

\newcommand{\textand}{\quad\text{and}\quad}

\newcommand{\CC}{\mathcal{C}}
\newcommand{\tCC}{\widetilde{\CC}}
\newcommand{\HH}{\mathcal{H}}
\newcommand{\rHH}{\mathrm{H}}
\newcommand{\bHH}{\overline{\HH}}
\renewcommand{\SS}{\mathcal{S}}
\newcommand{\bSS}{\overline{\SS}}
\newcommand{\MM}{\mathcal{M}}
\usepackage{upgreek}
\newcommand{\comp}{\upchi}
\newcommand{\KK}{\mathcal{K}}
\newcommand{\FF}{\mathcal{F}}
\renewcommand{\AA}{\mathcal{A}}
\newcommand{\TT}{\mathcal{T}}
\newcommand{\tTT}{\widetilde{\TT}}
\newcommand{\UU}{\mathcal{U}}
\newcommand{\relrho}{\mathrel{\rho}}
\newcommand{\relrhobar}{\mathrel{\overline{\rho}}}
\newcommand{\subs}{\mathrel{\propto}}
\newcommand{\sups}{\mathrel{\reflectbox{$\propto$}}}
\newcommand{\Id}{\mathrm{Id}}
\newcommand{\Hom}{\mathrm{Hom}}
\newcommand{\VV}{\mathcal{V}}
\newcommand{\II}{\mathcal{I}}
\newcommand{\GG}{\mathcal{G}}
\newcommand{\DD}{\mathcal{D}}
\newcommand{\NN}{\mathcal{N}}

\setlength{\fboxsep}{1pt}
\newcommand{\boxnum}[1]{{\fbox{\scriptsize${#1}$\vphantom{$jk$}}}}

% Boxes
\newcommand{\hsqbox}{{\boxminus}}
\newcommand{\vsqbox}{{\rotatebox{90}{$\boxminus$}}}
% Unary operators
\DeclareMathOperator{\sq}{\square}
\DeclareMathOperator{\hsq}{\raisebox{-.05em}{$\hsqbox$}}
\DeclareMathOperator{\vsq}{\raisebox{-.1em}{$\vsqbox$}}
\DeclareMathOperator{\ohsq}{\overline{\hsq}}
\DeclareMathOperator{\ovsq}{\overline{\raisebox{-.1em}{$\vsqbox$}}}
\DeclareMathOperator{\trio}{\sqsupset}
% Binary operators
\newcommand{\hmult}{\mathbin{\raisebox{-.05em}{$\hsqbox$}}}
\newcommand{\vmult}{\mathbin{\raisebox{-.1em}{$\vsqbox$}}}
\usepackage{scalerel}
\newcommand{\sqsubs}{\mathrel{\mathrlap{\square}\raisebox{.17em}{\scaleobj{0.65}{\,\,\propto}}}}

% \newcommand{\smallbullet}{{\raisebox{0.1em}{\scalebox{0.5}{$\bullet$}}}}
\newcommand{\smallbullet}{\bullet}


%% Bibliography %%

\usepackage[backend=bibtex]{biblatex}
\addbibresource{ASENS-80-1963-349.bib}
\renewbibmacro{in:}{%
  \ifboolexpr{%
     test {\ifentrytype{article}}%
  }{}{\printtext{\bibstring{in}\intitlepunct}}%
}


%% Document %%

\begin{document}

\maketitle

  \begin{translator}{Note from the translator}
    This document is a translation from French of the article

    \medskip
    {\normalfont\origcit}

    \medskip
    {\noindent}produced with kind permission from Andrée Ehresmann.

    \medskip

    This version has also incorporated comments and errata from \cite[Comments on Part III-1, p.~342--363]{coll} (henceforth ``the comments and errata'').
    Some of these correct minor typos, and have been inserted silently.
    Some of these are supplementary (and sometimes longer) comments by Andrée Ehresmann, and have been included essentially verbatim (modulo minor typos) --- either as footnotes or directly within the text itself, depending on length and pertinence --- along with their comment number;
    sometimes they make reference to the comments and errata concerning other papers;
    since they are written by Andrée, they often refer to simply ``Charles'', or ``we''.

    The page numbers of the original article are included at the relevant locations in the margins of this version.
    The bibliography numbering from the original has been retained, and additional citations from the comments and errata are listed in separate bibliographies, numbered as in \cite{coll}, but with a slight modification: those referring to the works within \cite{coll} are preceded by an ``Œ''; those referring to external works are preceded by a ``C''.

    \medskip

    We also repeat here a few comments on notation from \cite[Comments on Part III-1, p.~337--338]{coll}, since there are a few conventions that the modern reader might find confusing.
    Categories are thought of as \emph{classes} equipped with a composition, so they are named by their morphisms instead of their objects, e.g. $\MM$ for ``maps'' instead of $\mathsf{Set}$, and $\FF$ for ``functors'' instead of $\mathsf{Cat}$.
    With this in mind, a category is often denoted by $\CC^{\smallbullet}$, where $\CC$ is its class of morphism and $\smallbullet$ is its composition operator; the class of its objects is written $\CC_0^\smallbullet$ and objects are often identified with their identity morphisms, and called \emph{units}.
    The domain and codomain of a morphism are denoted by $\alpha$ and $\beta$ (respectively).
    Functors $F$ from a category $\CC$ to a category $\CC'$ are written as $(\CC',F,\CC)$ (i.e. in the ``diagrammatic'' direction), and similarly for morphisms; the Hom functor is accordingly written $\CC(e',e)$.

    We have, however, made the decision to replace $\to$ with $\mapsto$ when denoting the action of a morphism on objects, in line with what a modern reader would tend to expect.

    \medskip

    \hfill--- Timothy Hosgood (translator)
  \end{translator}

%% Content %%

\tableofcontents



\section*{Introduction}
\addcontentsline{toc}{section}{\protect\numberline{}Introduction}

\oldpage{349}

This article is the first part of a work on the notion of structured categories and of species of structured structures.
The main results are summarised in a series in \emph{Notes à l'Académie des Sciences} \cite{3e}.

\hyperref[section:i]{Section~I} begins with a short reminder on the notions of species of structures and categories of homomorphisms.
Let $(\CC,p,\HH,\SS)$ be a category of homomorphisms over $\CC$ such that $\SS$ contains the groupoid of invertible elements of the category $\HH$, and such that $\CC$ is further endowed with the structure of an inductive category.
We define the substructures of a structure of $\HH$.
This notion makes precise that of a sub-object of an arbitrary category, using the fact that $\HH$ is a category of homomorphisms and $\CC$ an inductive category;\comm{21.1}{This notion of substructure is simplified in subsequent papers (\cite{coll61,coll66,coll69}), where it is freed from any order on $\CC$.}
it leads to endowing $\HH$ with the structure of an ordered category, which is the subject of the main results of this section.

Let $(\MM,p,\HH,\Gamma)$ be a category of homomorphisms with finite products, over a category $\MM$ of maps;
we define, at the start of \hyperref[section:ii]{Section~II}, $\HH$-structured categories (or, more precisely, $\HH(\HH',\HH'')$-structured categories).
\comm{21.2}{Structured categories are, in a more modern language, categories internal to a concrete category $\HH$ such that the ``internal'' source, target, and composition can be applied on those of a usual category by the concrete functor $p\colon\HH\to\mathsf{Set}$ (cf. Comment~55.2).}
We then give a certain number of examples: topological categories and differential categories \cite{3b}; double categories that arise, in particular, in the theory of natural transformations between functors \cite{3d}; order-structured categories, in particular inductive categories and inductive groupoids \cite{3c}, etc.
\oldpage{350}
These examples, which I was led to consider in the study of fibred spaces, foliated spaces, extensions of differential varieties, and local structures in general, are the origin of this work.
The end of \hyperref[section:ii]{Section~II} contains a series of general theorems:

\begin{itemize}
  \item $\HH$-structured functors form a category of homomorphisms over a category of functors, and over $\MM$;
    it has finite products and is right solving.
  \item Let $(\CC^\smallbullet,s)$ be an $\HH$-structured category;
    if $\overline{\CC}^\smallbullet$ is a subcategory of $\CC^\smallbullet$, and $\overline{s}$ a substructure of $s$ such that $p(\overline{s})=\overline{\CC}$, then $(\overline{\CC}^\smallbullet,\overline{s})$ is an $\HH$-structured category.
  \item If $(\CC^\smallbullet,s)$ is an $\HH$-structured category, then the categories of trios and of quartets of $\CC^\smallbullet$ are $\HH$-structured categories.
\end{itemize}

All of these theorems use the additional hypothesis that $(\MM,p,\HH,\Gamma)$ is a right-solving category of homomorphisms (that is, $\HH$ contains ``enough'' substructures).
\comm{22.1}{A faithful set-valued functor is right solving if and only if it creates canonical equalisers (cf. Comment~221.2 on \cite{coll100}).}

The second part of this article (to appear soon) will contain the theory of species of structured structures;\comm{22.2}{This second part has not been developed, but only sketched in four notes: \cite{coll89,coll90,coll95,coll96}.}
we will show how the complete enlargement procedure of an inductive groupoid can be generalised to species of structured structures.
We will then give some applications of all these concepts to more specific problems.



\section{Categories of homomorphisms and substructures}
\label{section:i}

\subsection{Conventions}
\label{section:i.1}

A category will be in general represented by the symbol denoted the underlying class (or \emph{support}) of the category along with the symbol for the composition law that makes this class a category as a superscript.
For example: $\CC^\perp$, $\CC_1^\perp$, $\overline{\CC}^\perp$ (resp. $\CC^\smallbullet$, $\CC_1^\smallbullet$, $\overline{\CC}^\smallbullet$), \ldots denote the categories obtained by endowing the class $\CC$, $\CC_1$, $\overline{\CC}$, \ldots with the composition law $\perp$ (resp. $\smallbullet$).
The class of units of a category will be denoted by the symbol representing the category along with a $0$ as a subscript.
For example: $\CC_0^\perp$, $(\CC_1^\perp)_0$, $\overline{\CC}_0^\perp$, \ldots.
If a class of objects is naturally associated to the category (for example, the classes in a category of maps from one class to another), then we will tacitly identify the units with the corresponding objects.\comm{22.4}{This identification must be considered as an abbreviation, not as a formal operation (cf. Comment~211.1 on \cite{coll100}).}

Let $\CC^\perp$ be a category.
The source and target maps that send an element $f\in\CC^\perp$ to its right and left units will be denoted $\alpha^\perp$ and $\beta^\perp$ (respectively).
The class of pairs $(g,f)$ such that the composite $g\perp f$ is defined (that is, such that $\alpha^\perp(g)=\beta^\perp(f)$) will be denoted by the symbol $\CC^\perp\star\CC^\perp$;
\[
  (g,f) \longmapsto g\perp f
  \qquad\text{where $(g,f\in\CC^\perp\star\CC^\perp)$}
\]
will be denoted by the symbol $\comp^\perp$.

\oldpage{351}
To simplify notation, if no confusion is possible, we will represent a category by the same symbol as its underlying class;
in this case, it is to be understood that the composition law is denoted by $\smallbullet$;
we thus write $\CC$ instead of $\CC^\smallbullet$.
Similarly, we will also write $\CC_0$, $\alpha$, and $\beta$ instead of $\CC_0^\smallbullet$, $\alpha^\smallbullet$, and $\beta^\smallbullet$ (respectively).

Let $\overline{C}^\perp$ and $\CC^\perp$ be two categories;
the word ``functor'' will always mean a contravariant functor.
A functor from $\CC^\perp$ to $\overline{\CC}^\perp$ will be denoted either by a triple $(\overline{\CC}^\perp,F,\CC^\perp)$, where $F$ is the corresponding map, or by just the letter $F$.
The restriction of $F$ to the class $\CC_0^\perp$, considered as a map from $\CC_0^\perp$ to $\overline{\CC}_0^\perp$, will be denoted $F_0$.



\subsection{Reminder on species of structures}
\label{section:i.2}

Since the notion of species of structures \cite{3a} is essential in this article, we will recall the definition and main properties.

\begin{definition}{1}
\label{definition:i-1}
  We say that a category $\CC$ is a \emph{category of operators on a class $\Sigma_0$} if we have defined a composition law $(f,z)\mapsto fz$ for certain pairs $(f,z)\in\CC\times\Sigma_0$ such that $fz\in\Sigma_0$ and such that the following axioms are satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      \emph{Associativity.}
      If one of $g(fz)$ or $(g\smallbullet f)z$ is defined, then both of them are defined, and
      \[
        g(fz)
        = (g\smallbullet f)z;
      \]
    \item[\normalfont(2)]
      If $g\smallbullet f$ and $fz$ are defined, then $g(fz)$ is defined;
    \item[\normalfont(3)]
      Let $e\in\CC_0$;
      if $ez$ is defined, then $ez=z$;
    \item[\normalfont(4)]
      \begin{enumerate}
        \item[(a)]
          For all $z\in\Sigma_0$, there exists at least one $f\in\CC$ such that $fz$ is defined;
        \item[(b)]
          For all $f\in\CC$, there exists at least one $z\in\Sigma_0$ such that $fz$ is defined.
      \end{enumerate}
  \end{enumerate}
\end{definition}

These axioms imply that, for all $z\in\Sigma_0$, there exists exactly one $e\in\CC_0$ such that $ez$ is defined;
we thus obtain a map $p_0\colon z\mapsto e$ from $\Sigma_0$ to $\CC_0$;
we say that $z$ is a \emph{structure} on $p_0(z)$.

\begin{definition}{2}
\label{definition:i-2}
  Let $\Sigma_0$ be a class, and $\CC$ a category;
  we say that $\Sigma_0$ is a \emph{species of structures over $\CC$} if we have a subcategory $\CC_1$ of $\CC$ that is a category of operators on $\Sigma_0$;
  let $p_0$ be the corresponding map from $\Sigma_0$ to $\CC_0$;
  we also say that $(\CC,p_0,\Sigma_0)$ is a \emph{species of structures}.
  If, further, $\CC_1=\CC$, then we say that $[\CC,p_0,\Sigma_0]$ is a \emph{species of structures on $\CC$}.
\end{definition}

Let $(\CC,p_0,\Sigma_0)$ be a species of structures.
Let $\Sigma$ be the class of pairs $(f,z)\in\CC\times\Sigma_0$ such that $fz$ is defined, i.e. such that $\alpha(f)=p_0(z)$.

\begin{longcomm}{23.1}
  This ``i.e.'' is not correct: if $fz$ exists, then $\alpha(f)=p_0(z)$;
  but the converse is not true.
  For instance, if $\CC_1$ is the groupoid of isomorphisms of $\CC$, then the assertion is valid only if the acting category is $\CC$ itself.
  Hence the notion of a \emph{strong species of structures}: a species of structures in which the acting subcategory contains each $f$ whose source is in it;
  equivalently, the composite $fz$ exists if and only if $\alpha(f)=p_0(z)$.

  Strong species of structures are characterised by axioms~(1), (2), (3), and (4a) --- but not (4b) --- of \cref{definition:i-1} for an acting category (cf. \hyperref[remark:i-2]{Remark~2} in \cref{section:i.3}).
  The corresponding functor $p\colon\Sigma\to\CC$ from the hypermorphisms category satisfies the condition that the diagram
  \[
    \begin{tikzcd}
      \Sigma_0
        \ar[d,swap,"p_0"]
      & \Sigma
        \ar[l]
        \ar[d]
    \\\CC_0
      & \CC
        \ar[l,"\alpha"]
    \end{tikzcd}
  \]
  is a pullback (which is somewhat stronger than condition~(E) below);
  in more modern language, this means that $p$ is a discrete opfibration.
  Conversely, each discrete opfibration determines a strong species of structures.
\end{longcomm}

Endowed with the composition law
\[
  (f',z')\smallbullet(f,z)
  = (f'\smallbullet f,z)
  \quad\text{if and only if}\quad
  z'=fz,
\]
\oldpage{352}
$\Sigma$ is a category, called the \emph{associated category of hypermorphisms} of the species of structures $(\CC,p_0,\Sigma_0)$.
The class of units of $\Sigma$ can be identified with $\Sigma_0$ by associating $(e,z)$ with $z$.
The map $p_0$ extends to a functor $(\CC,p,\Sigma)$ satisfying the following property:
\begin{enumerate}
  \item[\normalfont(E)] \itshape
    For all $h\in\Sigma$ and all $z\in\Sigma_0$ such that
    \[
      p_0(z)
      = p_0(\alpha(h))
    \]
    there exists exactly one $h'\in\Sigma$ such that
    \[
      p(h')=p(h)
      \textand
      \alpha(h')=z.
    \]
\end{enumerate}
The species of structures $(\CC,p_0,\Sigma_0)$ is also denoted by $(\CC,p,\Sigma)$.

Conversely, let $\CC$ and $\Sigma$ be two categories.
Let $(\CC,p,\Sigma)$ be a functor satisfying condition~(E);
we say that $\Sigma$ is a \emph{category over $\CC$ with respect to $p$}.
We can show \cite{3a} that $p(\Sigma)$ is a subcategory of $\CC$, and that the map
\[
  h\longmapsto \big(p(h),\alpha(h)\big)
\]
lets us identify $\Sigma$ with the associated category of hypermorphisms of the species of structures $(\CC,p_0,\Sigma_0)$ in which the composition law is defined by
\[
  (f,z) \longmapsto \beta(h)
\]
if and only if there exists $h\in\Sigma$ such that
\[
  f=p(h)
  \textand
  z=\alpha(h).
\]



\subsection{Species of structures dominated by a category}
\label{section:i.3}

We denote by $\MM_0$ a class of classes such that if it contains $X$ then it also contains all the subsets of $X$.

\begin{longcomm}{24.1}
  The set-theoretical assumptions here are not explicit (cf. also Comment~155.1 on \cite{coll66} and Comment~211.2 on \cite{coll100}).
  Charles was very conscious of the problem.
  For instance, he suggested such foundational questions as a thesis subject to Houdebine~\cite{comm55}, pointing out Quine's theory of types \cite{comm87}.
  Later on, he was much interested by Lawvere's category-based theory \cite{comm64}.

  In fact, Charles' conception on this subject evolved from 1957 to 1967: in \cite{coll47} he wanted to speak about ``the category $\widetilde{\mathcal{E}}$ of all sets'', whence the (not too formal) distinction between classes and sets, as in Bernays--Gödel theory \cite{comm10}.
  In \cite{coll55}, as well as this 1963 paper, logical problems are avoided thanks to the use of a ``class $\MM_0$ of classes'';
  Charles thought of $\MM_0$ as a ``large enough'' variable set (and the word ``class'' is used to indicate that no particular set theory is adopted), on which conditions are added when necessary (for instance, $\MM_0$ is closed under products and subsets in \cref{section:ii});
  in \cite{coll66,coll100}, $\MM_0$ must be closed under quotients and countable coproducts.
  From \cite{coll109} onwards, $\MM_0$ becomes a universe.

  Note that the letter $\MM$ was really chosen to stress the variability of the class (in geometry, a variable point is often denoted by $M$...);
  but we thought of two other interpretations of this letter: ``Mengen'' in German, and ``maps'' in English;
  and the latter is well suited since later texts are written in English, and we liked to name a category by its morphisms instead of its objects.
\end{longcomm}

Then $\MM_0$ can be identified with a class of units of the category $\MM$ whose elements are triples $(M',f,M)$ such that $M,M'\in\MM_0$ and $f$ is a surjection from $M$ onto a subclass of $M'$, and with the composition law defined by
\[
  (M'',f',M'_1)\smallbullet(M',f,M)
  = (M'',f'f,M)
  \quad\text{if and only if}\quad
  M'_1=M'
\]
where $f'f$ denotes the surjection
\[
  x\longmapsto f'(f(x)).
\]
If $\overline{f}=(M',f,M)$, then we also write $\overline{f}(x)$ to mean $f(x)$.

Let $(\CC,p,\Sigma)$ be a species of structures such that $p^{-1}(e)$ belongs to $\MM_0$ for all $e\in p_0(\Sigma_0)$.
Let $f\in p(\Sigma)$ and set
\[
  \begin{aligned}
    e&=\alpha(f),
  \\e'&=\beta(f).
  \end{aligned}
\]
Set
\[
  F(f)
  = \big(p^{-1}(e'),\widetilde{f},p^{-1}(e)\big)
  \in\MM
\]
\oldpage{353}
where
\[
  \widetilde{f}(z)
  =fz
  \qquad\text{for all $z$ such that $p(z)=e$;}
\]
then $F(e)$ can be identified with $p^{-1}(e)$.
If $f$ is an invertible element of $p(\Sigma)$, then the map $\widetilde{f}$ is a bijection from $F(e)$ to $F(e')$.
The map $F\colon f\mapsto F(f)$ for $f\in p(\Sigma)$ is a functor from $\alpha(F)=p(\Sigma)$ to $\MM$ satisfying the axiom
\begin{enumerate}
  \item[(A)] \itshape
    Let $e,e'\in\alpha(F)_0$; then
    \[
      F(e)\neq\varnothing;
    \]
    further, if $e\neq e'$ then
    \[
      F(e)\cap F(e')=\varnothing.
    \]
\end{enumerate}
Furthermore, the pair $(\CC,F)$ entirely determines $(\CC,p,\Sigma)$.

Conversely, let $(\CC,F)$ be a pair such that $F$ is a functor from a subcategory $\alpha(F)$ of $\CC$ to $\MM$ satisfying condition~(A).
We can show \cite{3a} that the class $\Sigma_0$, given by the union of the classes $F(e)$ over all $e\in\alpha(F)_0$, is a species of structures over $\CC$, in which the composition law is defined by
\[
  (f,z)\longmapsto F(f)(z)
  \quad\text{if and only if}\quad
  z\in F(\alpha(f)).
\]
We say that $(\CC,F)$ is a \emph{a pair defining a species of structures}, namely the species of structures $\Sigma_0$ constructed above.

\begin{remarks}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
    \label{remark:i-1}
      Let $\CC$ be a category, $\alpha(F)$ a subcategory, and $(\MM,F,\alpha(F))$ a functor.
      Let $\overline{F}$ be the functor that sends $f\in\alpha(F)$ to the map
      \[
        (\alpha(f),z)
        \longmapsto\big(\beta(f),F(f)(z)\big)
        \qquad\text{where $z\in F(\alpha(f))$.}
      \]
      The pair $(\CC,\overline{F})$ defines the species of structures $(\CC,p_0,\Sigma_0)$, where $\Sigma_0$ is the class of pairs $(e,z)$ such that $e\in\alpha(F)_0$, $z\in F(e)$, and
      \[
        p_0(e,z)=e.
      \]
    \item[\normalfont(2)]
    \label{remark:i-2}
      Let $(\CC,F)$ be a pair defining a species of structures $(\CC,p,\Sigma)$ such that $\alpha(F)$ contains $f\in\CC$ whenever $\alpha(f)\in\alpha(F)$;
      this is equivalent to saying that we are given a composition law between the category $\CC$ and the class $\Sigma_0$ that satisfies axioms~(1), (2), (3), and (4a) of Definition 1.
      We can extend $F$ to a functor $(\MM,\overline{F},\CC)$ given by
      \[
        \begin{aligned}
          \overline{F}(f)&=F(f)
          \qquad&&\text{for all $f\in\alpha(F)$;}
        \\\overline{F}(e)&=\varnothing
          \qquad&&\text{for all $e\in\CC_0$ and $e\not\in\alpha(F)_0$;}
        \\\overline{F}(f')&=\big(\overline{F}(\beta(f')),\varnothing,\varnothing)
          \qquad&&\text{for all $f'\not\in\alpha(F)$.}
        \end{aligned}
      \]
    \item[\normalfont(3)]
    \label{remark:i-3}
      Let $\CC^\smallbullet$ be a category;
      the triple $(\CC^\smallbullet,\beta,\CC)$ is a species of structures for the composition law $\smallbullet$;
      if $e\in\CC_0^\smallbullet$ then the triple $(\CC^\smallbullet,\beta,\alpha^{-1}(e))$ is a sub-species of structures \cite{3a} of $(\CC^\smallbullet,\beta,\CC)$.\comm{25.2}{The set-valued functor associated to $(\CC^\smallbullet,\beta,\alpha^{-1}(e))$ is the partial Hom functor $\Hom(e,-)\colon\CC\to\mathsf{Set}$.}
  \end{enumerate}
\end{remarks}

\begin{longcomm}{25.1}
  \emph{Motivations for (internal) actions.}

  Charles first met (topological or differentiable) actions of categories (more precisely, of groupoids) in his theory of fibre bundles: in \cite{coll28} in 1950, he shows that, if $E$ is a fibre bundle, then the groupoid $S$ of isomorphisms from fibre to fibre, equipped with its canonical topology, acts (continuously) on the total space of $E$, and the fibre bundles associated to $E$ are those spaces on which $S$ acts.
  So (\cite{coll50}) the category of fibre bundles is equivalent to the category of actions of ``locally trivial groupoids'', which are some concrete internal groupoids in the category of topological spaces.
  The category of principal fibre bundles is equivalent to the category of locally trivial groupoids.

  Almost simultaneously (\cite{coll39}), he came upon ``local species of structures'' (i.e. internal species of structures in the category of local classes) in his attempt to unify the treatment of structures defined by a ``gluing together'' process.

  In 1957, these examples led him to introduce acting categories and species of structures (\cite{coll47}).
  He chose the latter term in reference to Bourbaki's species of structures, whose ``transport by isomorphism of structures'' is so axiomatised;
  indeed, at that time, Charles was most preoccupied by ``good'' definitions of structures.

  In \cite{coll47}, he proves equivalences between three notions: species of structures, hypermorphisms functors, and set-valued functors satisfying condition~(A) above.
  He also gives the enlargement theorem for species of structures (cf. Comment~29.2) which is equivalent to the Kan extension theorem (\cite{comm58}, published the year after) for set-valued functors, except that the problem is looked at ``upside-down'', with the set-valued functor being replaced by the associated hypermorphisms functor (and this led to the more general theorems on extension of functors in \cite{coll77,coll122}).
  He uses this enlargement theorem as the first step in his construction of the important ``complete enlargement'' of a local species of structures, the structures of which are defined by atlases;
  the second step consists of a generalisation of the associated sheaf theorem to presheaves over a local class, thanks to an original method (extended in \cite{coll110} to local functors).
  Locally homogeneous spaces, differentiable or analytic or foliated manifolds, fibre bundles, \ldots are obtained as particular cases.

  In \cite{coll55}, Charles explicitly says that the category of species of structures with covariant maps is:

  \begin{itemize}
    \item equivalent to the category of functors satisfying condition~(E) above, with square of functors as morphisms;

    \item isomorphic to the category of pairs defining a species of structures, with a morphism $(\Phi,\phi)\colon(\CC,F)\to(\CC,F')$ being defined by
      \[
        \begin{tikzcd}
          &&\MM
        \\& \ar[ur,"F'"] \ar[dl]
          && \ar[ul,swap,"F",""{below,name=F}] \ar[dr,"\iota"] \ar[ll,from=F,Rightarrow,bend left=10,"\phi"]
        \\\CC'
          &&&& \CC \ar[llll,"\Phi"]
        \end{tikzcd}
      \]
      where $\phi\colon F\to F'\Phi\iota$ is a natural transformation;

    \item equivalent to the category of pairs $(\CC,F)$, where $F$ is a set-valued functor whose domain is a sub-category of $\CC$.
  \end{itemize}

  These equivalences restrict (\hyperref[remark:i-2]{Remarks~1 and 2}, and Comment~23.1) to equivalences between the categories of strong species of structures, of discrete opfibrations, and of set-valued functors.

  Topological, differentiable, and local species of structures are instances of structured (or ``concrete internal'') species of structures, which are defined in \cite{coll59,coll60} by ``lifting'' the action along the forgetful functor of a concrete category;
  enlargement theorems for them are given in \cite{coll89,coll90,coll95,coll96}.
  In fact, sketches in the sense of \cite{coll106} are easily drawn, the set models of which are species of structures and discrete opfibrations \cite{coll117};
  the models in a category $\HH$ are \emph{internal species of structures} and \emph{internal discrete opfibrations} (also called \emph{internal diagrams} or \emph{internal presheaves}, cf. Johnstone~\cite{comm56}).
  Thanks to the equivalences indicated above, this provides an ``internalisation'' of the ``external'' notion of set-valued functor, by looking at it ``upside-down'';
  Charles already stressed this fact in his lectures in the early sixties.
  This probably did inspire Bénabou, who was one of the first categorists to apply it (in his definition of internal distributors \cite{comm7}).
  The development of topos theory led other categorists to adopt (or rediscover) this point of view some ten years later (cf. MacLane's analysis of Johnstone's book \cite{comm75}).
\end{longcomm}

\oldpage{354}
Let $(\CC^\smallbullet,F_e)$ be the pair defining the species of structures $(\CC^\smallbullet,\beta,\alpha^{-1}(e))$, and $\overline{F}_e$ the functor associated to $F_e$ by \hyperref[remark:i-2]{Remark~2} above.
A functor $(\MM,G,\CC^\smallbullet)$ is said to be representable \cite{2} if there exists some $e\in\CC_0^\smallbullet$ such that $G$ and $\overline{F}_e$ are induced from one another by a natural equivalence.
To every pair $(\CC,F)$ that defines a species of structures $(\CC,p,\Sigma)$, we can associated a representable functor $\overline{F}$ in the following way:

Let $a$ be an arbitrary element that does not belong to $\CC$.
Let $\CC'_1$ be the class of pairs $(z,a)$, where $z\in\Sigma_0$.
Let $\CC'$ be the class given by the union of $\CC$, $\{a\}$, and $\CC'_1$.
This class is a category for the composition law
\[
  (\gamma',\gamma)
  \longmapsto\gamma'\smallbullet\gamma
\]
if and only if one of the following conditions is satisfied:
\begin{enumerate}
  \item[\normalfont(1)]
    $\gamma,\gamma'\in\CC$ and $\alpha(\gamma')=\beta(\gamma)$;
    then $\gamma'\smallbullet\gamma$ is the composition of $\gamma'$ and $\gamma$ in $\CC$;
  \item[\normalfont(2)]
    $\gamma'\in\CC$, $\gamma=(z,a)$, and $z\in F(\alpha(\gamma'))$;
    then
    \[
      \gamma'\smallbullet\gamma
      =(\gamma'z,a)
    \]
  \item[\normalfont(3)]
    $\gamma'=(z,a)$ and $\gamma=a$;
    then
    \[
      \gamma'\smallbullet\gamma
      =(z,a).
    \]
\end{enumerate}
\hyperref[remark:i-2]{Remark~2} then allows us to extend $F$ to a functor $(\MM,\overline{F},\CC')$;
this functor $\overline{F}$, which is identical to $(\MM,\overline{F}_a,\CC')$, is representable.\comm{26.1}{Regarding $\CC'$, Bénabou gives the following criterion: $F\colon\CC\to\SS$ is representable if and only if $\CC\hookrightarrow\CC'$ has a left adjoint \cite{comm5}.}

\begin{definition}{3}
\label{definition:i-3}
  Let $\CC$ be a category, and $(\MM,\gamma,\KK)$ a functor.
  We define a \emph{species of structures dominated by $(\gamma,\KK)$} to be a pair $(\CC,F)$ such that $(\KK,F,\alpha(F))$ is a functor and $(\CC,\gamma F)$ defines a species of structures;
  the species of structures defined by $(\CC,\gamma F)$ is called the \emph{species of structures under $(\CC,F)$}.
\end{definition}

\begin{longcomm}{26.2}
  \emph{Enriched species of structures.}

  Analysis problems prompted us to introduce $\gamma$-dominated species of structures (in \cite{comm28}).

  If $\CC$ is a category, and if the species of structures defined by the Hom functor is dominated by $(\gamma,\KK)$, then $\CC$ is called a \emph{$\gamma$-dominated} category \cite{coll77}.
  A refinement of this notion, namely that of a \emph{strongly $\gamma$-dominated} category from \cite{coll104,coll109}, is equivalent to the notion of a $\KK$-category (cf. \cite{comm31}) when $\KK$ is a concrete cartesian category.

  A fine study of dominated categories is due to Foltz~\cite{comm33}.

  More generally, let $\mathbf{V}$ be a monoidal category.
  Then a {$\mathbf{V}$-species of structures} may be defined by the following data:
  \begin{itemize}
    \item a $\mathbf{V}$-category $\mathbf{C}$,

    \item for each object $e$ of $\mathbf{C}$, an object $F(e)$ of $\mathbf{V}$,

    \item for each pair $(e',e)$ of objects of $\mathbf{C}$, a morphism $k'_{e',e}\colon\mathbf{C}(e',e)\otimes F(e)\to F(e')$ satisfying the identity and associativity axioms, which are given by asking for the diagrams
    \[
      \begin{tikzcd}
        F(e)
          \ar[r,"k'_{e,e}"]
        & \mathbf{C}(e,e)\otimes F(e)
      \\I\otimes F(e)
          \ar[u,"\sim"{anchor=south,rotate=90}]
          \ar[ur,swap,"i_e\otimes F(e)"]
      \end{tikzcd}
    \]
    \[
      \begin{tikzcd}[column sep=tiny]
        & F(e'')
        & \mathbf{C}(e'',e)\otimes F(e)
          \ar[l,swap,"k'_{e'',e}"]
      \\\mathbf{C}(e'',e')\otimes F(e')
          \ar[ur,"k'_{e'',e'}"]
      \\& \mathbf{C}(e'',e')\otimes\big(\mathbf{C}(e',e)\otimes F(e)\big)
          \ar[ul,"{\mathbf{C}(e'',e')\otimes k'_{e',e}}"]
        & \big(\mathbf{C}(e'',e')\otimes\mathbf{C}(e',e)\big)\otimes F(e)
          \ar[l,swap,"\sim","\mathrm{assoc.}"{below}]
          \ar[uu,swap,"k_{e'',e',e}\otimes F(e)"]
      \end{tikzcd}
    \]
    to commute, where $I$ is the unit of $\otimes$, and where $i_{(-)}$ and $k_{(-,-,-)}$ are the identity and associativity morphisms (respectively).
  \end{itemize}

  Suppose that $\mathbf{V}$ is a cartesian category with commuting coproducts, and that $I$ is connected (in the sense of Penon~\cite{comm83}).
  In \cite[Appendix]{coll120}, we proved that the category of $\mathbf{V}$-categories (with small enough classes of objects) is equivalent to the category of internal category whose object of objects is a coproduct of copies of $I$.
  Similarly:

  \begin{proposition}{A}
    The category of $\mathbf{V}$-species of structures is equivalent to the category of pseudo-discrete internal species of structures in $\mathbf{V}$ (where pseudo-district means that the object of structures is the coproduct of the fibres).
  \end{proposition}

  Now let $(\CC,F)$ be a species of structures dominated by $(\mathbf{V},\gamma)$, where $\gamma=\Hom(I,-)$.
  If $\gamma$ admits a left adjoint that preserve products, then there exists a free $\mathbf{V}$-category $\mathbf{C}$ generated by $\CC$, and the $F(e)$ determine a ``free'' $\mathbf{V}$-species of structures over $\mathbf{C}$.
  Hence:

  \begin{proposition}{B}
    The category of species of structures that are dominated by $(\mathbf{V},\gamma)$ is equivalent to the category of free $\mathbf{V}$-species of structures over a free $\mathbf{V}$-category.
  \end{proposition}

  So, in this case, the notion of internal species of structures encompasses the notions of enriched and dominated species of structures.
\end{longcomm}

We will later return to the notion of a species of structures dominated by a category (Sections~III and IV).
For now, we will only consider particular cases.

Let $\FF$ be the category of all functors $(\bSS^\smallbullet,G,\SS^\smallbullet)$ such that $(\bSS,G,\SS)\in\MM$;
let $(\MM,p_\FF,\FF)$ be the functor defined by
\[
  p_\FF\colon(\bSS^\smallbullet,G,\SS^\smallbullet)
  \longmapsto (\bSS,G,\SS).
\]

\begin{definition}{4}
\label{definition:i-4}
  A species of structures dominated by $(p_\FF,\FF)$ is called a \emph{species of morphisms}.
\end{definition}

\begin{longcomm}{26.3}
  Species of morphisms are called ``category of categories'' in \cite{comm28}.
  They are studied in \cite{coll70,coll77,coll122}, alongside the associated opfibrations with a cleavage (constructed by adapting the construction of the cross product of group $A$ and an $A$-module), with a view to applications in non-abelian cohomology.

  General fibrations were introduced by Grothendieck in \cite{comm43} and studied by Gray in \cite{comm38}.
  Their present theory has been developed by looking at a fibration as a family of categories (by Lawvere~\cite{comm65}, Bénabou--Celeyrette~\cite{comm8,comm19}, and Paré--Schumacher~\cite{comm82} who call them ``indexed categories'').
\end{longcomm}

Let $(\CC,p,\Sigma)$ be a species of structures.
Consider the following conditions:
\begin{enumerate}
  \item[(a)]
    $(\CC,p,\Sigma)$ is the species of structures under a species of morphisms $(\CC,F)$.
  \oldpage{355}
  \item[(b)]
    \begin{enumerate}
      \item[(b\textsubscript{1})]
        For all $e\in p(\Sigma_0)$, the class $p^{-1}(e)$ is endowed with the structure of a category $(p^{-1}(e))^\perp$, which we denote by $F(e)$;
      \item[(b\textsubscript{2})]
        Let $f\in p(\Sigma)$, $e=\alpha(f)$, and $e'=\beta(f')$;
        then $(F(e'),\widetilde{f},F(e))$ is a functor $F(f)$.
    \end{enumerate}
  \item[(c)]
    \begin{enumerate}
      \item[(c\textsubscript{1})]
        $(\Sigma_0)^\perp$ is a category;
      \item[(c\textsubscript{2})]
        If $(z',z)\in(\Sigma_0)^\perp\star(\Sigma_0)^\perp$ and $(f,z'\perp z)\in\Sigma$ then
        \[
          (f,z),(f,z')\in\Sigma
          \textand
          f(z'\perp z)=fz'\perp fz;
        \]
      \item[(c\textsubscript{3})]
        If $z_0\in(\Sigma_0)_0^\perp$ and $(f,z_0)\in\Sigma$, then
        \[
          fz_0\in(\Sigma_0)_0^\perp.
        \]
    \end{enumerate}
\end{enumerate}

\begin{proposition}{1}
\label{proposition:i-1}
  Conditions~(a), (b), and (c) above are equivalent (where condition~(a) is interpreted independently from the choice of $\FF$).
\end{proposition}

\begin{proof}
  Conditions~(a) and (b) are equivalent by definition.
  If they are satisfied, then the category $(\Sigma_0)^\perp$ given by the sum of the categories $F(e)$ for $e\in p(\Sigma_0)$ satisfies condition~(c).
  Conversely, suppose that condition~(c) is satisfied.
  Let $z,z'\in\Sigma_0$.
  If $z'\perp z$ is defined, then $p(z'\perp z)$ is defined and, by (c\textsubscript{2}), we have
  \[
    p(z'\perp z)
    = p(z')
    = p(z);
  \]
  in particular,
  \[
    p(\alpha^\perp(z))
    = p(\beta^\perp(z))
    = p(z);
  \]
  thus $p^{-1}(e)$ is a subcategory of $(\Sigma_0)^\perp$ for all $e\in p(\Sigma_0)$.
  Let $f\in p(\Sigma)$ be such that $\alpha(f)=e$;
  conditions~(c\textsubscript{2}) and (c\textsubscript{3}) imply that the map $\widetilde{f}$ is a functor from $p^{-1}(e)$ to $p^{-1}(\beta(f))$.
  Thus (b) is satisfied.
\end{proof}

\begin{corollary}{}
  If we suppose conditions~(c\textsubscript{1}) and (c\textsubscript{2}) to be satisfied, and if $p(\Sigma)$ (resp. $\Sigma_0^\perp$) is a groupoid, then condition~(c\textsubscript{3}) is also satisfied.
\end{corollary}

\begin{proof}
  If $(f,z_0)\in\Sigma$ and $z_0\in(\Sigma_0)_0^\perp$ then
  \[
    fz_0
    = f(z_0\perp z_0)
    =fz_0\perp fz_0.
  \]
  If $(\Sigma_0)^\perp$ is a groupoid, then it follows that $fz_0\in(\Sigma_0)_0^\perp$.
  Suppose that $p(\Sigma)$ is a groupoid;
  from the sequence of equalities
  \[
    \begin{aligned}
      f^{-1}(fz_0)
      &= f^{-1}(fz_0\perp\alpha^\perp(fz_0))
    \\&= (f^{-1}\smallbullet f)z_0\perp f^{-1}(\alpha^\perp(fz_0))
    \\&= f^{-1}(\alpha^\perp(fz_0))
    \end{aligned}
  \]
  we deduce that
  \[
    fz_0
    = \alpha^\perp(fz_0)
    \in(\Sigma_0)_0^\perp
  \]
  and so (c\textsubscript{3}) is satisfied.
\end{proof}

Let $A$ be a class endowed with an order relation $<$;
the class of pairs $(z',z)$ with $z<z'$ is a category under the composition law given by
\[
  (z'',z'_1)\perp(z',z)
  =(z'',z)
  \quad\text{if and only if}\quad
  z'_1=z'.
\]
\oldpage{356}
Conversely, if $\CC$ is a category such that any two elements $f,f'\in\CC$ that have the same set of units in $\CC$ are identical, then the data of $\CC$ defines on $\CC_0$ the order relation given by
\[
  \begin{gathered}
    z<z'
    \qquad\text{if and only if there exists $f\in\CC$ such that}
  \\z=\alpha(f)
    \textand
    z'=\beta(f).
  \end{gathered}
\]
We then say that the category $\CC$ \emph{defines} an \emph{order} on $\CC$.

Let $\Omega_0$ be the class of ordered classes $(A,<)$, where $A\in\MM_0$;
let $\widetilde{\Omega}$ be the category of triples $((A',<),h,(A,<))$, where $(A,<),(A',<)\in\Omega_0$ and where $h$ is a map from $A$ to $A'$ that is compatible with the orders on $A$ and $A'$.
Let $\omega$ be the map
\[
  \big((A',<),h,(A,<)\big)
  \longrightarrow (A',h,A);
\]
then $(\MM,\omega,\widetilde{\Omega})$ is a functor.

\begin{definition}{5}
\label{definition:i-5}
  If a species of structures $(\CC,F)$ is dominated by $(\omega,\widetilde{\Omega})$, then we call it an \emph{ordered species of structures};
  if $\CC$ further defines an order on $\CC_0$, then we say that $(\CC,F)$ is a \emph{bi-ordered species of structures}.
\end{definition}

Let $((\overline{A},<),h,(A,<))\in\widetilde{\Omega}$;
let $\AA$ (resp. $\overline{\AA}$) be the category of pairs defining the order of $A$ (resp. of $\overline{A}$);
let $\overline{h}$ be the map
\[
  (z',z)
  \longmapsto(h(z'),h(z))
  \qquad\text{where $(z',z)\in\AA$;}
\]
then $(\overline{\AA},\overline{h},\AA)$ is a functor, and the map
\[
  \eta\colon\big((\overline{A},<),h,(A,<)\big)
  \longmapsto(\overline{\AA},\overline{h},\AA)
\]
is an equivalence from $\widetilde{\Omega}$ to a full subcategory $\widehat{\Omega}$ of $\FF$ whose units are the categories $\SS$ that define an order on $\SS_0$.
The map
\[
  (\CC,F)
  \longmapsto (\CC,(\FF,\eta,\widetilde{\Omega})F),
\]
where $(\CC,F)$ is an ordered species of structures, is a bijection from the class of ordered species of structures to the class of species of morphisms $(\CC,\widehat{F})$ such that
\[
  \widehat{F}(\alpha(\widehat{F}))
  \subset \widehat{\Omega}
  \subset \FF.
\]



\subsection{Reminder on categories of homomorphisms}
\label{section:i.4}

\begin{definition}{6}
\label{definition:i-6}
  Let $\CC$ and $\HH$ be two categories;
  we say \cite{3a} that $(\CC,p,\HH,\SS)$ is a \emph{category of homomorphisms} if the following conditions are satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $(\CC,p,\HH)$ is a functor;
    \item[\normalfont(2)]
      \oldpage{357}
      $\SS$ is a subcategory of $\HH$ that contains $\HH_0$;
    \item[\normalfont(3)]
      $(\CC,p',\SS)$ is a species of structures, where $p'$ denotes the restriction of $p$ to $\SS$;
    \item[\normalfont(4)]
      If $h,h'\in\HH$, then the relations
      \[
        \begin{aligned}
          \alpha(h)
          &= \alpha(h'),
        \\\beta(h)
          &= \beta(h'),
        \\p(h)
          &= p(h'),
        \end{aligned}
      \]
      imply that $h=h'$.
  \end{enumerate}
\end{definition}

Let $(\CC,p,\HH,\SS)$ be a category of homomorphisms.
An element $h\in\HH$ can be identified, by condition~(4) of \cref{definition:i-6}, with a triple $(S',f,S)$, where
\[
  \begin{aligned}
    S
    &= \alpha(h) \in\HH_0,
  \\S'
    &= \beta(h) \in\HH_0,
  \\f
    &= p(h)\in\CC.
  \end{aligned}
\]
We usually represent an element of $\HH$ by such a triplet.
Note that we thus identify $\HH$ with a subcategory of the induced category $p_0^*(\CC)$ whose elements are the triples $(S',f,S)$ such that $S,S'\in\HH_0$, $f\in\CC$, and
\[
  \alpha(f)=p(S)
  \textand
  \beta(f)=p(S').
\]
Since an element of $\SS$ is entirely determined by the data of $\alpha(h)$ and $p(h)$, we write such elements either in the form $(\beta(h),p(h),\alpha(h))$ or in the form $(p(h),\alpha(h))$.
If $\SS$ is the groupoid of invertible elements of $\HH$, then $\HH$ is a species of structures over $\SS\times\SS$ with the composition law
\[
  \begin{gathered}
    \big((\overline{f}',\overline{f}),h\big)
    \longmapsto\overline{f}'\smallbullet h\smallbullet\overline{f}^{-1}
    \qquad\text{if and only if}
  \\\alpha(\overline{f})=\alpha(h)
    \textand
    \alpha(\overline{f}')=\beta(h)
  \end{gathered}
\]
where $h\in\HH$ and $\overline{f},\overline{f}'\in\SS$.

Let $(\CC,p,\HH,\SS)$ be a category of homomorphisms;
let $\SS_\gamma$ and $\CC_\gamma$ be the groupoids of invertible elements of $\SS$ and $\CC$ (respectively).
If $p(\SS_\gamma)$ is a saturated \cite{3a} subgroupoid of $\CC$, i.e. if
\[
  \big[f\in\CC_\gamma
  \textand
  \alpha(f)\in p(\SS_\gamma)\big]
  \implies
  f\in p(\SS_\gamma),
\]
then we say that $\HH$ is \emph{saturated over $\CC$}.

\begin{longcomm}{29.2}
  \emph{Enlargement Theorem.}

  $(\CC,p,\HH,\SS)$ is a category of homomorphisms if and only if $p\colon\HH\to\CC$ is a faithful (condition~(3)) functor (condition~(1)) whose restriction $\SS\to p(\SS)$ is (condition~(2)) a discrete opfibration.

  We say that a functor is \emph{amnestic} if any isomorphism that is sent to an identity is itself an identity, i.e. if its restriction to isomorphisms is well-faithful in the sense of \cite{coll77,coll122}.
  Then $\HH$ is saturated over $\CC$ if $p$ is a faithful amnestic functor that creates isomorphisms.

  If $\HH$ is a category of homomorphisms with $\SS$ the groupoid of isomorphisms of $\HH$, then $\HH$ is equivalent to a saturated category of homomorphisms.
  Indeed, more generally:

  \begin{theorem*}
    Let $p\colon\HH\to\CC$ be any functor.
    There exists a smallest isomorphism-creating functor $q\colon\widetilde{\HH}\to\CC$ extending $p$, and $\HH$ is equivalent to $\widetilde{\HH}$.
  \end{theorem*}

  We call such $q$ the (maximal) \emph{enlargement of $p$}.
  It is constructed as follows.
  Let $\mathcal{L}$ be the category given by the quadruples $(k,f',f,h)$, with $h\in\HH$, $f$ and $f'$ isomorphisms in $\CC$, and $k\smallbullet f=f'\smallbullet p(h)$ in $\CC$; composition is given by
  \[
    \begin{gathered}
      (k',f'',\hat{f},h')(k,f',f,h)
      = (k'\smallbullet k, f'', f, h'\smallbullet h)
    \\\text{if and only if}\qquad
      \big[f'=\hat{f}
      \textand
      \alpha(h')=\beta(h)\big].
    \end{gathered}
  \]
  \[
    \begin{tikzcd}[sep=huge]
      {}
      &{} \ar[l,swap,"f''"]
    \\{} \ar[u,"k'"]
      &{} \ar[l,swap,"f'"] \ar[u,swap,"p(h')"]
    \\{} \ar[u,"k"]
      &{} \ar[l,"f"] \ar[u,swap,"p(h)"]
    \end{tikzcd}
    \qquad
    \begin{tikzcd}[sep=huge]
      {}
    \\{} \ar[u,swap,"h'"]
    \\{} \ar[u,swap,"h"]
    \end{tikzcd}
  \]
  (This subcategory of the comma category $\CC\downarrow p$ is used in \cite[Section~1]{coll100}).
  Then $\widetilde{\HH}$ is the strict quotient of $\mathcal{L}$ by the equivalence
  \[
    \begin{gathered}
      (k,f',f,h)
      \sim \big(
        k, f'\smallbullet p(g'), f\smallbullet p(g), {g'}^{-1}\smallbullet h\smallbullet g
      \big)
    \\\text{for any isomorphisms $g,g'\in\HH$ such that ${g'}^{-1}\smallbullet h\smallbullet g$ exists.}
    \end{gathered}
  \]
  Then $q$ sends $(k,f',f,h)$ to $k$, and the embedding
  \[
    (h\colon s\to s')
    \longmapsto \big(
      p(h), p(s'), p(s), h
    \big)
  \]
  identifies $\HH$ with a subcategory of $\widetilde{\HH}$ that is equivalent to $\widetilde{\HH}$.

  Furthermore, $q$ is faithful (resp. amnestic) whenever $p$ is, whence the enlargement theorems for species of structures over groupoids and for categories of homomorphisms already obtained in \cite{coll47}.
  In fact, $p$ may be replaced by $q$ whenever categorical properties (i.e. those preserved by isomorphisms) are considered: the constructions are made in $\widetilde{\HH}$, and then transported by isomorphism in $\HH$.

  The above construction is generalised in \cite{coll77,coll122} to obtain extension theorems for functors.
  It is ``internalised'' in \cite{coll89,coll90,coll95,coll96}, giving an ``internal version'' of the Kan extension Theorem (see Comment 25.1).
\end{longcomm}

In particular, let $(\MM,p,\HH,\SS)$ be a category of homomorphisms such that $\MM$ is the category defined in \cref{section:i.2}.\comm{29.3}{If $(\MM,p,\HH,\SS)$ is a category of homomorphisms with $\SS$ the groupoid of all isomorphisms of $\HH$, then $\HH$ is also called a \emph{concrete category}, and $p\colon\HH\to\MM$ a \emph{concrete functor} (and we'll often use these terms). In fact, some authors define a concrete functor as any set-valued amnestic faithful functor (without any ``transport of structures'' property); most of the following results remain valid in this case.}
Let $h\in\HH$;
the element $p(h)$ is, by definition, a map $(p(\beta(h)),g,p(\alpha(h)))$, where $g$ is a surjection.
Since the data of $\alpha(h)$, $\beta(h)$, and $g$ all together entirely determine $p(h)$, we simply represent $h$ by the triple $(\beta(h),g,\alpha(h))$ instead of by $(\beta(h),p(h),\alpha(h))$.
If $h$ is such that
\[
  p(\alpha(h))
  \subset p(\beta(h))
\]
and if $p(h)$ is the canonical injection from $p(\alpha(h))$ to $p(\beta(h))$, then we write $h$ as $(\beta(h),\iota,\alpha(h))$, i.e. $\iota$ denotes the identity map on $p(\alpha(h))$.

\begin{examples}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      \oldpage{358}
      Let $(\MM,p_\FF,\FF)$ be the functor defined in \cref{section:i.2};
      let $\FF_\gamma$ be the groupoid of invertible elements of $\FF$ (equivalences of functors);
      then $(\MM,p_\FF,\FF,\FF_\gamma)$ is a category of homomorphisms.
    \item[\normalfont(2)]
      Let $\TT_0$ be the class of topologies (or ``metatopologies'', in the terminology of \cite{3b}) on the classes $M\in\MM_0$;
      let $\tTT$ be the category of continuous maps $(S',f,S)$ from $S$ to $S'$, where $S$ is a topology on the class $M$, and $S'$ a topology on $M'$.
      Let $\theta$ be the functor
      \[
        (S',f,S)
        \longmapsto(M',f,M).
      \]
      Let $\TT$ be the groupoid of invertible elements of $\tTT$ (homeomorphisms);
      then $(\MM,\theta,\tTT,\TT)$ is a category of homomorphisms.
    \item[\normalfont(3)]
      Let $(\MM,\omega,\widetilde{\Omega})$ be the functor defined in \cref{section:i.2};
      let $\Omega$ be the groupoid of invertible elements of $\widetilde{\Omega}$ (isomorphisms between ordered classes);
      then $(\MM,\omega,\widetilde{\Omega},\Omega)$ is a category of homomorphisms.
    \item[\normalfont(4)]
      Let $\CC$ be any category;
      then $(\CC,\Id_\CC,\CC,\CC)$ is a category of homomorphisms, where $\Id_\CC$ denotes the identity functor on $\CC$.
  \end{enumerate}
\end{examples}



\subsection{Substructures}
\label{section:i.5}

Let $(\CC,p,\HH,\SS)$ be a category of homomorphisms such that $\SS$ contains the groupoid $\Gamma$ of invertible elements of $\HH$.

On $\HH_0$, consider the relation $\relrho$
\[
  s\relrho s'
  \quad\text{if and only if}\quad
  (s',p(s),s)\in\HH.
\]
This relation evidently implies that $p(s)=p(s')$.

\begin{proposition}{2}
\label{proposition:i-2}
  The relation $\relrho$ is an order relation on $\HH_0$, and $(\CC,p,\Gamma)$ is the species of structure under $(\CC,F)$ such that\comm{30.1}{To be precise, one should read $p\iota$ instead of $p$ here. Indeed, in several instances, the restriction of a functor is denoted by the same letter as the functor itself; when the source and target are clearly indicated, this does not lead to any confusion, and so we shall not always mention it.}
  \[
    F(e)
    = (p^{-1}(e),\relrho_e)
    \qquad\text{for all $e\in\alpha(F)_0$}
  \]
  where $\relrho_e$ is the order relation induced by $\relrho$ on $p^{-1}(e)$.
\end{proposition}

\begin{proof}
  If $s\relrho s'$ and $s'\relrho s''$ then
  \[
    (s'',p(s'),s')\smallbullet(s',p(s),s)
    = (s'',p(s),s)
    \in\HH
  \]
  whence $s\relrho s''$.
  Suppose that $s\relrho s'$ and $s'\relrho s$;
  then
  \[
    (s,p(s'),s')\smallbullet(s',p(s),s)
    = (s,p(s),s)
    = s
  \]
  and
  \[
    (s',p(s),s)\smallbullet(s,p(s'),s')
    = s'
  \]
  thus
  \[
    (s',p(s),s)\in\Gamma.
  \]
  \oldpage{359}
  Since $(\CC,p,\Gamma)$ is a species of structures, from the equalities
  \[
    \alpha(s',p(s),s)=s
    \textand
    p(s',p(s),s)=p(s)
  \]
  we deduce that $(s',p(s),s)=s$;
  thus $s'=s$ and $\relrho$ is an order relation;
  the category of pairs that defines $\relrho$ can be identified with the subcategory $\HH_{\relrho}$ consisting of elements $(s',p(s),s)$ by identifying $(s',s)$ with $(s',p(s),s)$.
  If $(s',p(s),s)\in\HH_{\relrho}$ and $f\in p(\Gamma)$, then the equality
  \[
    \alpha(f)=p(s)
  \]
  guarantees the existence of $(\overline{s},f,s),(\overline{s}',f,s')\in\Gamma$;
  then
  \[
    (\overline{s}',f,s')\smallbullet(s',p(s),s)\smallbullet(s,f^{-1},\overline{s})
    = (\overline{s}',f\smallbullet p(s)\smallbullet f^{-1},\overline{s})
    = (\overline{s}',p(\overline{s}),\overline{s})
    \in\HH.
  \]
  Consequently, $p(\Gamma)$ acts on $\HH_{\relrho}$, with the composition law
  \[
    (f,(s',p(s),s))
    \longmapsto (\overline{s}',p(\overline{s}),\overline{s})
    \quad\text{if and only if}\quad
    \alpha(f)=p(s).
  \]
  Then $(p(\Gamma),p,\HH_{\relrho})$ is the species of structures under a species of morphisms, and the proposition follows from the end of \cref{section:i.2}.
\end{proof}

From now on, suppose that $\CC$ is an inductive category (in the sense of \cref{section:ii.6}, which is slightly more general than that of \cite{3c}).
If $g,f\in\CC$, then their pseudo-product in $\CC$, which is always defined (cf. \cref{section:ii}, \cref{proposition:ii-22}), is denoted by $gf$.

\begin{longcomm}{31.1}
  Up to (but not including) \cref{definition:i-9}, the text remains valid without any modification \emph{if the hypothesis that $\CC$ is inductive is replaced by the hypothesis that $\CC$ is a sub-inductive category} (cf. \cite{coll69}), since all the pseudo-products used here still exist.
  This remark is important: some results will be applied to the category $\FF$ of categories, which is sub-inductive for the order ``is a subcategory of'', but not inductive (two subcategories of a category admit a meet, while two categories may not admit a larger common subcategory).
\end{longcomm}

Consider on $\HH_0$ the relation
\[
  \begin{gathered}
    s\relrhobar S
    \qquad\text{if and only if}
  \\\big[p(s)<p(S)
    \textand
    (S,p(S)p(s),s)\in\HH\big];
  \end{gathered}
\]
the relations induced by $\relrhobar$ and $\relrho$ on $p^{-1}(e)$ are identical, for all $e\in p(\HH_0)$.
The relation $p(s)<p(S)$ implies that
\[
  \alpha(p(S)p(s))
  = p(s);
\]
if, further, $(S,p(S)p(s),s)\in\HH$, then we also have that
\[
  \beta(p(S)p(s))
  = p(S).
\]

\begin{proposition}{3}
\label{proposition:i-3}
  The relation $\relrhobar$ is an order relation on $\HH_0$;
  if $s\relrhobar S$, then $s$ is a sub-object \cite{5} of $S$ in $\HH$.
\end{proposition}

\begin{proof}
  Suppose that $s\relrhobar S$.
  If, further, $S\relrhobar s$, then
  \[
    p(S)=p(s)
  \]
  whence $s\relrho S$ and $S\relrho s$, i.e. $s=S$, by \cref{proposition:i-2}.
  Suppose that $s'\relrhobar s$;
  from the relations
  \[
    \begin{gathered}
      k = (p(S)p(s))\smallbullet(p(s)p(s'))
      < p(S)p(s'),
    \\\alpha(k)=p(s')
      \textand
      \beta(k)=p(S),
    \end{gathered}
  \]
  it follows that
  \[
    k=p(S)p(s')
    \textand
    (S,p(S)p(s'),s')\in\HH
  \]
  thus $s'\relrhobar S$.
  \oldpage{360}
  Let $\overline{g}=(s,g,S')$ and $\overline{g}'=(s,g',S')$ be such that
  \[
    (S,p(S)p(s),s)\smallbullet\overline{g}
    = (S,p(S),p(s),s)\smallbullet\overline{g}'.
  \]
  From the relations
  \[
    \begin{gathered}
      (p(S)p(s))\smallbullet g = (p(S)p(s))\smallbullet g',
    \\g < (p(S)p(s))\smallbullet g
      \textand
      g' < (p(S)p(s))\smallbullet g',
    \\\alpha(g)=\alpha(g')
      \textand
      \beta(g)=\beta(g'),
    \end{gathered}
  \]
  we deduce that $g=g'$.
  Thus $\overline{g}=\overline{g}'$, which implies that $s$ is a sub-object of $S$ in $\HH$.
\end{proof}

The notion of \emph{substructure} that we will now define makes precise the notion of sub-object of a category.

\begin{definition}{7}
\label{definition:i-7}
  Let $S\in\HH_0$;
  we say that $s\in\HH_0$ is a \emph{substructure of $S$ in $(\CC,p,\HH,\SS)$}, and we write $s\subs_p S$, if the following conditions are satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $p(s)<p(S)$ and $(S,p(S)p(s),s)\in\HH$;
    \item[\normalfont(2)]
      If $(S,g,S')\in\HH$ is such that
      \[
        \alpha(p(s)g)=\alpha(g)
        \textand
        \beta(p(s)g)=p(s)
      \]
      then
      \[
        (s,p(s)g,S')\in\HH.
      \]
  \end{enumerate}
  If $s\subs_pS$, then we also write
  \[
    (S,p(S)p(s),s)
    = S\sups_p s
  \]
  and we say that $S\sups_p s$ is a \emph{$p$-injection}.
  We write $H_{\subs_p}$ to mean the class of $p$-injections.
\end{definition}

If there is no risk of confusion, then we simply say that $s$ is a substructure of $S$ in $\HH$, and we write $s\subs S$ and $S\sups s$ instead of $s\subs_p S$ and $S\sups_p s$ (respectively).

\begin{longcomm}{32.1}
  Substructures (in the definition of which $\SS$ is not used) were introduced for obtaining a good definition of structured categories.
  Most of the following propositions were devised for use in \cref{section:ii}.

  This definition seems to depend on the order of $\CC$.
  In fact, \cref{proposition:i-4} suggested a more general notion of a $(\CC',p)$-injection (\cite{coll69,coll66}), free from any use of an order on $\CC$.
  The $p$-injections defined here are exactly the $(\CC',p)$-injections in the case where
  \[
    \CC'
    = \{Ee \mid e<E\text{ in }\CC_0\}.
  \]
  Almost all of the results of this part (\cref{section:i}) generalise to this setting; cf. \cite{coll66} and \cite{coll69}, where both notions are compared.
\end{longcomm}

\begin{proposition}{4}
\label{proposition:i-4}
  Let $s,S\in\HH_0$;
  then $s\subs_p S$ if and only if the following conditions are satisfied:
  \begin{enumerate}
    \item[\normalfont(1\textquotesingle)]
      $s\relrhobar S$ in $(\CC,p,\HH,\SS)$;
    \item[\normalfont(2\textquotesingle)]
      If $(S,(p(S)p(s))\smallbullet g',S')\in\HH$ then $(s,g',S')\in\HH$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  Suppose that $s\subs_p S$;
  condition~(1) of \cref{definition:i-7} implies that $s\relrhobar S$ in $(\CC,p,\HH,\SS)$.
  Let
  \[
    (S,p(S)p(s)\smallbullet g',S')\in\HH.
  \]
  We will show that the elements $g'$ and $g'_1=p(s)(p(S)p(s)\smallbullet g')$ are equal.
  We have that $p(s)<p(S)p(s)$, so
  \[
    g'
    = p(s)\smallbullet g'
    < (p(S)p(s))g'
  \]
  whence
  \[
    g'
    = p(s)\smallbullet g'
    < p(s)(p(S)p(s)g');
  \]
  \oldpage{361}
  but also
  \[
    \alpha(g'_1)<\alpha(g')
    \textand
    \beta(g'_1)<p(s)=\beta(g')
  \]
  whence
  \[
    \begin{aligned}
      \alpha(g'_1)
      &= \alpha(g')
      = p(S'),
    \\\beta(g'_1)
      &= \beta(g')
      = p(s).
    \end{aligned}
  \]
  Since $(\CC,<)$ is an inductive category, the relations
  \[
    \begin{aligned}
      g'
      &< g'_1,
    \\\alpha(g')
      &= \alpha(g'_1),
    \\\beta(g')
      &= \beta(g'_1),
    \end{aligned}
  \]
  imply that $g'=g'_1$.
  It then follows from condition~(2) of \cref{definition:i-7} that $(s,g',S')\in\HH$, and so condition~(2\textquotesingle) is satisfied.
  Conversely, suppose that conditions~(1\textquotesingle) and (2\textquotesingle) are satisfied;
  let $(S,g,S')\in\HH$ be such that
  \[
    \alpha(p(s)g)=\alpha(g)
    \textand
    \beta(p(s)g)=p(s).
  \]
  By using the relations
  \[
    \begin{gathered}
      (p(S)p(s))\smallbullet(p(s)g)<g,
    \\\alpha\big((p(S)p(s))\smallbullet(p(s)g)\big)=\alpha(g),
    \\\beta(g)=\beta\big((p(S)p(s))\smallbullet(p(s)g)\big)=p(S)
    \end{gathered}
  \]
  we see that $g=(p(S)p(s))\smallbullet(p(s)g)$.
  From condition~(2\textquotesingle) we thus deduce that
  \[
    (s,p(s)g,S')\in\HH
  \]
  i.e. $s\subs_p S$.
\end{proof}

\begin{examples}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      The sub-structures of $S$ in $(\MM,\theta,\tTT,\TT)$ are the topologies induced by $S$ on the subclasses of $\theta(S)$.
      Let $\widetilde{\TT_u}$ be the subcategory of $\tTT$ consisting of open continuous maps from one topological space to another;
      let $\theta_u$ be the restriction of $\theta$ to $\tTT_u$;
      then $(\MM,\theta_u,\tTT_u,\TT)$ is a category of homomorphisms.
      The sub-structures of $S$ in $(\MM,\theta_u,\tTT_u,\TT)$ are the topologies induced by $S$ on an open of $S$, i.e. the elements that are smaller than $S$ in the order relation considered in \cite{3c} on $\tTT$.
    \item[\normalfont(2)]
      The sub-structures of $\CC^\perp$ in $(\MM,p_\FF,\FF,\FF_\gamma)$ are the subcategories of $\CC^\perp$ (see \cref{proposition:ii-9} in \cref{section:ii}).
    \item[\normalfont(3)]
      The sub-structures of $(A,<)$ in $(\MM,\omega,\widetilde{\Omega},\Omega)$ are the subclasses of $A$ endowed with the order induced by $<$.
    \item[\normalfont(4)]
      In $(\CC,\Id_\CC,\CC,\CC)$, we have
      \[
        s\subs S
        \qquad\text{if and only if}\qquad
        \big[
          \text{$s<S$ in $\CC$}
          \textand
          \beta(Ss)=S.
        \big]
      \]
      If the relations $s<S$ and $s\subs S$ are equivalent, then $\CC$ is a \emph{{completely right regular} category}.
      In this case, the condition $s<\alpha(f)$ implies that $\beta(fs)=\beta(f)$.
    \item[\normalfont(5)]
      If $s\subs_p S$, then $p(s)\subs p(S)$ in $(\CC,\Id_\CC,\CC,\CC)$.
  \end{enumerate}
\end{examples}

\begin{theorem}{1}
\label{theorem:i-1}
  \oldpage{362}
  The relation $s\subs_p S$ is a relation order in $\HH_0$.
  Let $s,s',S\in\HH_0$;
  the conditions
  \[
    \begin{aligned}
      s&\subs_p S;
    \\s'&\subs_p S
      \quad\text{(resp. $s'\relrhobar S$)}\,;
    \\p(s')&\subs p(s)\text{ in }(\CC,\Id_\CC,\CC,\CC)
    \end{aligned}
  \]
  together imply that
  \[
    s'\subs_p s
    \quad\text{(resp. $s'\relrhobar s$)}.
  \]
\end{theorem}

\begin{proof}
  Since $\relrhobar$ is an order relation, if $s\subs S$ and $S\subs s$, then $s=S$.
  Suppose that $s_1\subs s$ and $s\subs S$;
  then $s_1\relrhobar S$.
  We will show that the pair $(S,s_1)$ satisfies condition (2\textquotesingle) of \cref{proposition:i-4}.
  Let
  \[
    \overline{g}
    = (S,p(S)p(s_1)\smallbullet g',S')
    \in\HH.
  \]
  The elements $p(S)p(s_1)$ and $(p(S)p(s))\smallbullet(p(s)p(s_1))$ are equal, since they are both bounded above by $p(S)$ and have the same source and same target ($p(s_1)$ and $p(S)$, respectively);
  thus
  \[
    \overline{g}
    = \big(S,(p(S)p(s))\smallbullet(p(s)p(s_1)\smallbullet g'),S'\big)
    \in\HH
  \]
  and, since $s\subs S$,
  \[
    \overline{g}'
    = (s,(p(s)p(s_1))\smallbullet g', S')
    \in\HH;
  \]
  since $s_1\subs s$, it thus follows that
  \[
    (s_1,g',S')
    \in\HH
  \]
  i.e. $s_1\subs S$.
  Suppose that $s\subs S$, $s'\relrhobar S$, and $p(s')\subs p(s)$ in $(\CC,\Id_\CC,\CC,\CC)$.
  Then
  \[
    j
    = (S,p(S)p(s'),s')
    \in\HH;
  \]
  from the relations
  \[
    p(s') < p(s)
    \textand
    \beta(p(s)p(s')) = p(s)
  \]
  we deduce that the elements $p(S)p(s')$ and $(p(S)p(s))\smallbullet(p(s)p(s'))$ are equal, since they are both bounded above by $p(S)$ and have the same source and same target ($p(s')$ and $p(S)$, respectively).
  Consequently,
  \[
    j
    = \big(S,(p(S)p(s))\smallbullet(p(s)p(s')),s'\big)
  \]
  and, by Proposition~4,
  \[
    (s,p(s)p(s'),s')
    \in\HH
  \]
  whence $s'\relrhobar s$.
  Suppose further that $s'\subs S$;
  let
  \[
    \overline{g}'
    = (s,p(s)p(s')\smallbullet g',S')
    \in\HH.
  \]
  We see that
  \[
    \begin{aligned}
      \overline{g}
      &= (S,p(S)p(s),s)\smallbullet\overline{g}'
    \\&= \big(S,(p(S)p(s))\smallbullet(p(s)p(s'))\smallbullet g',S'\big)
    \\&= (S,(p(S)p(s'))\smallbullet g',S')
    \in\HH.
    \end{aligned}
  \]
  \oldpage{363}
  \cref{proposition:i-4} then implies that
  \[
    (s',g',S')\in\HH
    \textand
    s'\subs S.
    \qedhere
  \]
\end{proof}

\begin{corollary}{1}
  If $s\subs_p S$, $s'\subs_p S$, and $p(s)=p(s')$, then $s=s'$.
\end{corollary}

\begin{proof}
  Indeed, by \cref{theorem:i-1}, these conditions imply that
  \[
    s\subs s'
    \textand
    s'\subs s
  \]
  whence $s=s'$.
\end{proof}

\begin{corollary}{2}
  Let $s\subs_p S$;
  then $s$ is the largest element (with respect to the relation $\relrho$) of the class of structures $s'$ such that
  \[
    s'\relrhobar S
    \textand
    p(s') = p(s).
  \]
\end{corollary}

\begin{definition}{8}
\label{definition:i-8}
  Let $\overline{h},\overline{h}'\in\HH$;
  we say that $\overline{h}'$ is a \emph{sub-homomorphism of $\overline{h}$ in $(\CC,p,\HH,\SS)$}, and we write $\overline{h}'\subs_p\overline{h}$ or $\overline{h}'\subs\overline{h}$, if the following conditions are satisfied:
  \[
    \begin{aligned}
      \alpha(\overline{h}')
      &\subs \alpha(\overline{h}),
    \\\beta(\overline{h}')
      &\subs \beta(\overline{h}),
    \\p(\overline{h}')
      &< p(\overline{h}).
    \end{aligned}
  \]
\end{definition}

\begin{proposition}{5}
\label{proposition:i-5}
  In $\HH$, the relation $\overline{h}'\subs\overline{h}$ is an order relation that satisfies the following conditions:
  \begin{enumerate}
    \item[\normalfont(1)]
      If $\overline{h}'\subs\overline{h}$, and $\alpha(\overline{h}')=\alpha(\overline{h})$ and $\beta(\overline{h}')=\beta(\overline{h})$, then $\overline{h}=\overline{h}'$;
    \item[\normalfont(2)]
      If $\overline{h}'\subs\overline{h}$ then $p(\overline{h}')\subs p(\overline{h})$ in $(\CC,\Id_\CC,\CC,\CC)$;
      if, further, $p(\overline{h})=p(\overline{h}')$, then $\overline{h}=\overline{h}'$;
    \item[\normalfont(3)]
      If $(\overline{h}_1,\overline{h}),(\overline{h}'_1,\overline{h}')\in\HH\star\HH$ and $\overline{h}'\subs\overline{h}$ and $\overline{h}'_1\subs\overline{h}_1$, then $\overline{h}'_1\smallbullet\overline{h}'\subs\overline{h}_1\smallbullet\overline{h}$;
    \item[\normalfont(4)]
      If $\overline{h}'\subs_p\overline{h}$, $\overline{h}''\subs_p\overline{h}$, and $p(\overline{h}'')\subs p(\overline{h}')$ in $(\CC,\Id_\CC,\CC,\CC)$, then $\overline{h}''\subs_p\overline{h}'$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  Conditions~(1) and (3) imply that $(\HH,\subs)$ is an ordered category (see \cref{section:ii}, \cref{definition:ii-18}).
  Condition~(2) implies that $p$ belongs to $\widetilde{\Omega}'$ (see \cref{section:ii.6}), i.e. (§IV) that $(\HH,\subs)$ is an ordered category over $(\CC,<)$.\comm{35.1}{Charles never published §IV, but the results that he intended to put in it are scattered across several papers, e.g. ordered categories over an ordered category are considered in \cite{coll75}.}
\end{proof}

\begin{longcomm}{35.2}
  The following corollary is not correct: $(\HH,\subs)$ is a sub-inductive category, but not an inductive category.
  Indeed, a family of objects bounded by $s$ and $s'$ may have two different joins in the set of elements less than both $s$ and $s'$.
\end{longcomm}

\begin{corollary*}
  If $\CC$ is {completely right regular}, and if, for all $s\in\HH_0$, the class of elements $p(s')$, where $s'\subs_p s$, is an inductive subclass of $\CC_0$, then $(\HH,\subs)$ is an inductive category over $(\CC,<)$.
\end{corollary*}

\begin{proposition}{6}
\label{proposition:i-6}
  Suppose that $\overline{h},\overline{h}'\in\Gamma$, $\alpha(\overline{h}')\subs_p\alpha(\overline{h})$, and $(p(\overline{h}')<p(\overline{h})$;
  then also $\beta(\overline{h}')\subs_p\beta(\overline{h})$, and, consequently, $\overline{h}'\subs_p\overline{h}$.
\end{proposition}

\begin{proof}
  \oldpage{364}
  Let
  \[
    \begin{aligned}
      \overline{h}
      &= (S_1,h,S)\in\Gamma
    \\\overline{h}'
      &= (s_1,h',s)\in\Gamma
    \end{aligned}
  \]
  be such that $h'<h$ and $j=(S,p(S)p(s),s)\in\HH$;
  then
  \[
    \begin{gathered}
      p\big(\overline{h}\smallbullet j\smallbullet \overline{h}'^{-1}\big)
      = h\smallbullet(p(S)p(s))\smallbullet h'^{-1}
      < p(S_1)p(s_1),
    \\\alpha\big(p\big(\overline{h}\smallbullet j\smallbullet\overline{h}'^{-1}\big)\big)
      = p(s_1)
      \textand
      \beta\big(p\big(\overline{h}\smallbullet j\smallbullet\overline{h}'^{-1}\big)\big)
      = p(S_1)
    \end{gathered}
  \]
  \begin{longcomm}{36.1}
    The above inequality (as well as several following ones) relies on the assertion $[h'<h\implies {h'}^{-1}<h^{-1}]$, which has to be proved.

    Suppose that $h'<h$, where $h\colon E\to\hat{E}$ and $h'\colon e\to\hat{e}$.
    Then there exists a pseudo-product $h^{-1}\hat{e}=h^{-1}\smallbullet(\hat{E}\hat{e})\colon\hat{e}\to E$;
    since
    \[
      (h^{-1}\hat{e})\smallbullet h'\colon e\to E
      \textand
      (h^{-1}\hat{e})\smallbullet h'
      < (h^{-1}\hat{e})h
      < h^{-1}h
      = E,
    \]
    we have that $(h^{-1}\hat{e})\smallbullet h'=eE$.
    It thus follows that
    \[
      {h'}^{-1}\smallbullet h'
      = e
      < eE
      = (h^{-1}\hat{e})\smallbullet h'
    \]
    and, composing with ${h'}^{-1}$, we see that
    \[
      {h'}^{-1}
      < h^{-1}\hat{e}
      < h^{-1}
    \]
    as desired.
  \end{longcomm}
  whence
  \[
    p\big(\overline{h}\smallbullet j\smallbullet\overline{h}'^{-1}\big)
    = p(S_1)p(s_1)
    \textand
    (S_1,p(S_1)p(s_1),s_1)
    \in\HH.
  \]
  Suppose, further, that $s\subs S$;
  let
  \[
    \overline{g}
    = (S_1,(p(S_1)p(s_1))\smallbullet g',S')
    \in\HH.
  \]
  The elements $h^{-1}\smallbullet(p(S_1)p(s_1))$ and $(p(S)p(s))\smallbullet h'^{-1}$ are equal, since they are both bounded above by $h^{-1}$ and have the same source and same target ($p(s_1)$ and $p(S)$, respectively).
  Thus
  \[
    \overline{h}^{-1}\smallbullet\overline{g}
    = \big(S,(p(S)p(s))\smallbullet\big( h'^{-1}\smallbullet g'\big),S'\big)
    \in\HH
  \]
  and it follows from Proposition~4 that
  \[
    \overline{g}'
    = (s,h'^{-1}\smallbullet g',S')
    \in\HH;
  \]
  consequently,
  \[
    \overline{h}'\smallbullet\overline{g}'
    = (s_1,g',S')
    \in\HH
    \textand
    s_1\subs S_1.
    \qedhere
  \]
\end{proof}

\begin{proposition}{7}
\label{proposition:i-7}
  Let
  \[
    \overline{h}
    = (s_1,h,s)
    \in\HH
  \]
  such that $s'\subs_p s$ and $s'_1\subs_p s_1$.
  If there exists $h'\in\CC$ such that
  \[
    \begin{gathered}
      h'<h,
    \\\alpha(h')=p(s')
      \textand
      \beta(h')=p(s'_1)
    \end{gathered}
  \]
  then
  \[
    \overline{h}'
    =(s'_1,h',s')
    \in\HH
    \textand
    \overline{h}'\subs_p\overline{h}.
  \]
  If, further, $\overline{h}$ and $h'$ are invertible, then $\overline{h}'\in\Gamma$.
\end{proposition}

\begin{proof}
  We have that
  \[
    \overline{h}\smallbullet(s\subs_p s')
    = (s_1,h\smallbullet(p(s)p(s')),s')
    \in\HH;
  \]
  the elements $h\smallbullet(p(s)p(s'))$ and $p(s_1)p(s'_1)\smallbullet h'$ are equal, since they are bounded above by $h$ and have the same source and same target ($p(s')$ and $p(s_1)$, respectively);
  thus
  \[
    \overline{h}\smallbullet(s\subs_p s')
    = (s_1,(p(s_1)p(s'_1))\smallbullet h',s')
    \in\HH
  \]
  and, by \cref{proposition:i-4}, we see that
  \[
    \overline{h}'
    = (s'_1,h',s')
    \in\HH.
  \]
  \oldpage{365}
  If, further, $\overline{h}\in\Gamma$ and $h'$ is invertible, then also $(s',h'^{-1},s'_1)\in\HH$, whence $\overline{h}'\in\Gamma$.
\end{proof}

Let $\vsq\CC$ be the longitudinal category of quartets of $\CC$ (see \cref{section:ii.5}), i.e. the class of quadruples $(g_1,f_1,f,g)\in\CC^4$ such that $g_1\smallbullet f=f_1\smallbullet g$, endowed with the multiplication
\[
  (g'_1,f'_1,f',g')\vmult(g_1,f_1,f,g)
  = (g'_1,f'_1\smallbullet f_1,f'\smallbullet f,g)
  \quad\text{if and only if}\quad
  g'=g_1.
\]

\begin{longcomm}{37.1}
  A quartet of $\CC$ is (less poetically) called a (\emph{commutative}) \emph{square}, and the longitudinal and lateral compositions are more geometrically called the \emph{horizontal} and \emph{vertical} compositions (following Gray).
  \[
    \begin{tikzcd}
      {}
      &{} \ar[l]
      &{} \ar[l]
    \\{} \ar[u]
      &{} \ar[l] \ar[u]
      &{} \ar[l] \ar[u]
    \end{tikzcd}
    \qquad
    \begin{tikzcd}
      {}
      & \ar[l]
    \\{} \ar[u]
      & \ar[l] \ar[u]
    \\{} \ar[u]
      & \ar[l] \ar[u]
    \end{tikzcd}
  \]

  The category $\vsq\CC$ is also called the \emph{category of arrows of $\CC$} (i.e. by the name of its objects), and denoted by $\mathsf{Fl}\CC$ or $\mathsf{Ar}\CC$.
\end{longcomm}

\begin{proposition}{8}
\label{proposition:i-8}
  Let $h,h'\in\CC$, and let
  \[
    \begin{array}{ll}
      \alpha(h)
      = s,
      &\alpha(h')
      = s',
    \\\beta(h)
      = s_1,
      &\beta(h')
      = s'_1.
    \end{array}
  \]
  Then the following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(1)]
      $h'\subs h$ in $(\CC,\Id_\CC,\CC,\CC)$;
    \item[\normalfont(2)]
      $h'<h$ in $\CC$, and $\beta(ss')=s$ and $\beta(s_1s'_1)=s_1$;
    \item[\normalfont(3)]
      $s'<s$, $s'_1<s_1$, and $(h,s_1s'_1,ss',h')\in\sq\CC$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  Indeed, conditions~(1) and (2) are equivalent by the above.
  If (2) is satisfied, then the elements $h\smallbullet ss'$ and $s_1s'_1\smallbullet h'$ are equal, since they are both bounded above by $h$, and have the same source and same target ($s'$ and $s_1$, respectively);
  thus (3) is satisfied.
  If condition~(3) is satisfied, then
  \[
    s'\subs s
    \textand
    s'_1\subs s_1
  \]
  since $\beta(ss')=s$ and $\beta(s_1s'_1)=s_1$.
  Further,
  \[
    s'_1<s_1s'_1
    \textand
    ss'<s
  \]
  whence
  \[
    h'
    < s_1s'_1\smallbullet h'
    = h\smallbullet ss'
    < h.
    \qedhere
  \]
\end{proof}

If $h'\subs h$ in $(\CC,\Id_\CC,\CC,\CC)$, then we denote by $h\sqsubs h'$ the quartet
\[
  (h,\beta(h)\beta(h'),\alpha(h)\alpha(h'),h').
\]
The class $\UU$ of quartets $h\sqsubs h'$ is a subcategory of $\vsq\CC$.
Let $\UU'$ be the subcategory of $\UU$ given by the quartets $h\sqsubs h'$ such that $h'$ and $h$ are invertible.

Let $\vsq\HH$ be the longitudinal category of quartets of $\HH$, and $\sq p$ the functor
\[
  (g_1,f_1,f,g)
  \longmapsto (p(g_1),p(f_1),p(f),p(g))
\]
from $\vsq\HH$ to $\vsq\CC$.
Then $(\vsq\CC,\sq p,\vsq\HH,\overline{\Gamma}')$ is a category of homomorphisms, where $\overline{\Gamma}'$ is the groupoid of invertible elements of $\vsq\HH$.\comm{37.2}{This is easy to prove (cf. \cite[Chapter~II]{coll122}).}
For a quadruple $\overline{G}=(\overline{g}_1,\overline{f}_1,\overline{f},\overline{g})$ to belong to $\vsq\HH$, it is necessary and sufficient that
\[
  \begin{array}{ll}
    \alpha(\overline{f})=\alpha(\overline{g}),
    & \beta(\overline{f})=\alpha(\overline{g}_1),
  \\\alpha(\overline{f}_1)=\alpha(\overline{g}),
    & \beta(\overline{f}_1)=\alpha(\overline{g}_1)
  \end{array}
\]
and that $\sq p(\overline{G})$ is a quartet;
indeed, the elements $\overline{g}_1\cdot\overline{f}$ and $\overline{f}_1\cdot\overline{g}$ are then equal, since they have the same image under $p$, and have the same source and same target.

\oldpage{366}
Let $\overline{\UU}$ be the subcategory of $\vsq\HH$ consisting of the quartets
\[
  \overline{\rHH}
  = (\overline{h}, s_1\subs_p s'_1, s\subs_p s', \overline{h}')
\]
such that $s'\subs_p s$ and $s'_1\subs_p s_1$.
Let $\overline{\UU}'$ be the subcategory of $\UU$ consisting of the quartets in $\UU$ such that $\overline{h},\overline{h}'\in\Gamma$.

\begin{proposition}{9}
\label{proposition:i-9}
  We have $\overline{h}'\subs\overline{h}$ in $(\CC,p,\HH,\SS)$ if and only if there exists
  \[
    \overline{\rHH}
    = \left(
      \overline{h},
      \beta(\overline{h})\subs_p\beta(\overline{h}'),
      \alpha(\overline{h})\subs_p\alpha(\overline{h}'),
      \overline{h}'
    \right) \in \UU;
  \]
  in this case, $\sq p(\overline{\rHH})\in\UU$.
\end{proposition}

\begin{proof}
  If $\overline{h}'\subs_p\overline{h}$, then
  \[
    \begin{gathered}
      p(\overline{h}')<p(\overline{h}),
    \\\alpha(\overline{h}')\subs_p\alpha(\overline{h})
      \textand
      \beta(\overline{h}')\subs_p\beta(\overline{h})
    \end{gathered}
  \]
  and thus $\sq p(\overline{\rHH}$ is a quartet and $\overline{\rHH}\in\overline{\UU}$.
  Conversely, if $\overline{\rHH}\in\overline{\UU}$, then we find that $\sq p(\overline{\rHH})\in\UU$ by condition~(3) of \cref{proposition:i-8};
  it thus follows that $p(\overline{h}')<p(\overline{h})$, and so $\overline{h}'\subs\overline{h}$ in $(\CC,p,\HH,\SS)$.
\end{proof}

If $\overline{h}'\subs\overline{h}$ in $(\CC,p,\HH,\SS)$, then the corresponding quartet $\overline{\rHH}$ will be denoted $\overline{h}\sqsubs\overline{h}'$.
In $\HH$ (resp. in $\CC$), we say that a triple $(g_1,f_1,f)$  is \emph{included in a quartet} if there exists a quartet $(g_1,f_1,f,g)$.
\cref{proposition:i-7} is equivalent to:

\begin{proposition}{7~\emph{bis}}
\label{proposition:i-7bis}
  For a triplet
  \[
    \mathrm{T}
    = (\overline{h},s_1\subs_p s'_1, s\subs_p s'),
  \]
  where $\overline{h}\in\HH$, to be included in a quartet $\overline{\rHH}$, it is necessary and sufficient that
  \[
    s=\alpha(\overline{h})
    \quad\text{and}
    s_1=\beta(\overline{h})
  \]
  and that
  \[
    p^3(T)
    = \big(
      p(\overline{h}), p(s_1)p(s'_1), p(s)p(s')
    \big)
  \]
  be included in a quartet $\rHH$;
  in this case, we have that $\overline{\rHH}\in\overline{\UU}$ and $\rHH\in\UU$.
  If, further, $H\in\UU'$ and $\overline{h}\in\Gamma$, then $\overline{\rHH}\in\overline{\UU}'$.
\end{proposition}

If $\mathrm{T}=(\overline{h},s_1\subs_p s'_1,s\subs_p s')$ is included in a quartet, then the quartets $\overline{\rHH}$ and $\rHH$ in which $\mathrm{T}$ and $p^3(\mathrm{T})$ are included are unique;
consequently, we have that
\[
  \rHH = p(\overline{h})\sqsubs h'
  \textand
  \overline{\rHH} = \overline{h}\sqsubs_p \overline{h}',
\]
\oldpage{367}
where $h'$ and $\overline{h}'$ are determined by $\mathrm{T}$.
The element $\overline{h}'$ can be thought of as the composite of $\overline{h}$ with $(s'_1,s')$;
this composite will be denoted $\overline{h}\vdash_p(s'_1,s')$ and called the \emph{$p$-restriction} of $\overline{h}$ to $(s'_1,s')$.

Note that the composite $\overline{h}'$ is also determined by the data of the triple $(\overline{h},(p(s'_1),p(s')))$.

In particular,

\begin{itemize}
  \item if $s'_1=\beta(\overline{h})$ and $s'\subs\alpha(\overline{h})$, then there exists a $p$-restriction $\overline{h}\vdash_p(s'_1,s')$ and
    \[
      \overline{h}\vdash_p(s'_1,s')
      = \overline{h}\smallbullet(s\subs_p s')
    \]
  \item if $s'_1=\beta(\overline{h})$ and $s'=\alpha(\overline{h})$, then there exists a $p$-restriction $\overline{h}\vdash_p(s'_1,s')$ if and only if
    \[
      \begin{aligned}
        \alpha(p(s'_1)p(\overline{h}))
        &= p(s')
      \\\beta(p(s'_1)p(\overline{h}))
        &= p(s'_1).
      \end{aligned}
    \]
    In this case,
    \[
      \overline{h}\vdash_p(s'_1,s')
      = \big(
        s'_1, p(s'_1)p(\overline{h}), s'
      \big).
    \]
\end{itemize}

Let $\HH'$ be a subcategory of $\HH$ that contains $\HH_0$;
let $p'$ be the restriction of $p$ to $\HH'$.
Suppose that $(\CC,p',\HH',\HH'\cap\Gamma)$ is a category of homomorphisms.

\begin{proposition}{10}
\label{proposition:i-10}
  The following conditions are equivalent:

  \begin{enumerate}
    \item[\normalfont($\sigma$)] $s\subs_p S$ in $(\CC,p,\HH,\SS)$ implies that $s\subs_{p'}S$ in $(\CC,p',\HH',\HH'\cap\Gamma)$;

    \item[\normalfont($\sigma_1$)] $\HH'\vdash_p(\HH_0\times\HH_0)\in\HH'$, i.e. if $\overline{h}'\in\HH'$, then every $p$-restriction of $\overline{h}'$ belongs to $\HH'$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  If ($\sigma$) is satisfied, then the category of $p'$-injections contains $\HH_{\subs_p}$, and ($\sigma_1$) is satisfied.
  Conversely, suppose that ($\sigma_1$) is satisfied, and let $s\subs S$ in $(\CC,p,\HH,\SS)$.
  The relations $S\in\HH'$ and $s\subs_p S$ imply that
  \[
    S\vdash_p(S,s)
    = \big(
      S,p(S)p(s),s
    \big) \in \HH'.
  \]
  Let $(S,p,S')\in\HH'$ be such that
  \[
    \alpha(p(s)g) = \alpha(g)
    \textand
    \beta(p(s)g) = p(s);
  \]
  then the composite $(S,g,S')\vdash_p(s,S')=(s,p(s)g,S')$, being defined, belongs to $\HH'$.
  Thus $s\subs_{p'}S$ in $(\CC,p',\HH',\HH'\cap\Gamma)$.
\end{proof}

We will later see (\cref{section:ii}, \cref{theorem:ii-16}) that $\vsq\CC$ is an inductive category for the order relation
\[
  (g'_1,f'_1,f',g')
  < (g_1,f_1,f,g)
\]
\oldpage{368}
if and only if
\[
  \begin{array}{ll}
    g'<g,
    & g'_1<g_1,
  \\f'_1<f_1,
    & f'<f.
  \end{array}
\]
In the following theorem, we set
\[
  [\overline{h}]
  = (\overline{h},\beta(\overline{h}),\alpha(\overline{h}),\overline{h})
  \in (\vsq\HH)_0
\]
for all $\overline{h}\in\HH$, and
\[
  [h]
  = (h,\beta(h),\alpha(h),h)
  \in (\vsq\CC)_0
\]
for all $h\in\CC$.

\begin{theorem}{2}
\label{theorem:i-2}
  The following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(1)] $[\overline{h}']\subs_{\sq p}[\overline{h}]$ and $[\beta(\overline{h}')]\subs_{\sq p}[\beta(\overline{h})]$ in $(\vsq\CC,\sq p,\vsq\HH,\overline{\Gamma}')$;
    \item[\normalfont(2)] $\overline{h}'$ is a sub-homomorphism of $\overline{h}$ in $(\CC,p,\HH,\SS)$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  Let
  \[
    \overline{h}=(s_1,h,s)\in\HH
    \textand
    \overline{h}'=(s'_1,h',s')\in\HH.
  \]
  Suppose that $\overline{h}'\subs_p\overline{h}$;
  by \cref{proposition:i-5}, it follows that $h'\subs h$ in $(\CC,\Id_\CC,\CC,\CC)$, whence
  \[
    \big(h,\beta(h)\beta(h'),\alpha(h)\alpha(h'),h'\big)\in\UU;
  \]
  furthermore, this quartet is the pseudo-product $[h][h']$ in $\vsq\CC$.
  Since the quadruple $(\overline{h},s_1\subs_p s'_1,s\subs_p s',\overline{h}')$ is a quartet of $\HH$ and admits $[h][h']$ as its image under $\sq p$, we thus deduce that $[\overline{h}']\relrhobar[\overline{h}]$ in $(\vsq\CC,\sq p,\vsq\HH,\overline{\Gamma}')$.
  Let $\overline{\mathrm{G}}=(\overline{h},\overline{f}_1,\overline{f},\overline{k})\in\sq\HH$ be such that
  \[
    \begin{aligned}
      \alpha\big(
        [p(\overline{h}')]\sq p(\overline{\mathrm{G}})
        \big)
        &= [p(\overline{k})]
    \\\beta\big(
        [p(\overline{h}')]\sq p(\overline{\mathrm{G}})
        \big)
        &= [p(\overline{h}')]
        = [h'];
    \end{aligned}
  \]
  then
  \[
    \begin{aligned}
      \sq p([\overline{h}'])
      &= [p(\overline{h}')]
    \\{}[p(\overline{h}')]\sq p(\overline{\mathrm{G}})
      &= \big(
        h', p(s'_1)p(\overline{f}_1), p(s')p(\overline{f}), p(\overline{k})
      \big),
    \end{aligned}
  \]
  whence
  \[
    \begin{aligned}
      \alpha\big(p(s')p(\overline{f})\big)
      &= \alpha(p(\overline{f}))
    \\\beta\big(p(s')p(\overline{f})\big)
      &= p(s').
    \end{aligned}
  \]
  It thus follows that
  \[
    \overline{f}'
    = \big(
      s', p(s')p(\overline{f}), \alpha(\overline{f})
    \big)
    \in\HH
  \]
  and, similarly,
  \[
    \overline{f}'_1
    = \big(
      s'_1, p(s'_1)p(\overline{f}_1), \alpha(\overline{f}_1)
    \big)
    \in\HH.
  \]
  Let $\overline{\mathrm{G}}'=(\overline{h}',\overline{f}'_1,\overline{f}',k)$;
  since the projection under $\sq p$ of $\overline{\mathrm{G}}'$ is the quartet $[p(\overline{h}')]\sq p(\overline{\mathrm{G}})$, we have that $\overline{\mathrm{G}}'\in\sq\HH$.
  Thus $[\overline{h}']\subs_{\sq p}[\overline{h}]$.
  Furthermore, $s'_1\subs_p s_1$ similarly implies that $[s'_1]\subs_{\sq p}[s_1]$, and so condition~(1) is satisfied.

  Conversely, suppose that $[\overline{h}']\subs[\overline{h}]$ in $(\vsq\CC,\sq p,\vsq\HH,\overline{\Gamma}')$.
  Then
  \[
    h'<h
    \textand
    [h][h'] = \big(
      h, \beta(h)\beta(h'), \alpha(h)\alpha(h'), h'
    \big)
  \]
  \oldpage{369}
  and we thus deduce that
  \[
    \big( s, p(s)p(s'), s' \big)\in\HH
    \textand
    \big( s_1, p(s_1)p(s'_1), s'_1 \big)\in\HH.
  \]
  Let
  \[
    \overline{g}
    = (s,g,S')\in\HH
  \]
  where $g=(p(s)p(s'))\smallbullet g'$.
  Then
  \[
    \overline{\mathrm{G}}
    = (\overline{h},\overline{h}\smallbullet\overline{g},\overline{g},S')
    \in\vsq\HH
  \]
  and
  \[
    \begin{aligned}
      \sq p(\overline{\mathrm{G}})
      &= (h,h\smallbullet g,g,p(S'))
    \\&= [h][h']\smallbullet(h',h'\smallbullet g',g',p(S'));
    \end{aligned}
  \]
  it thus follows that
  \[
    (\overline{h}',\overline{h}'\smallbullet\overline{g}',\overline{g}',S')\in\overline{\UU}
  \]
  i.e. that $\overline{g}'=(s',g',S')\in\HH$.
  This proves that $s'$ is a substructure of $s$ in $(\CC,p,\HH,\SS)$.
  If, further, $[s'_1]\subs_{\sq p}[s_1]$, then we similarly have that $s'_1\subs_p s_1$, and so $\overline{h}'\subs\overline{h}$ in $(\CC,p,\HH,\SS)$.
\end{proof}

\begin{corollary}{1}
  Let $\overline{h},\overline{h}'\in\Gamma$.
  Then $\overline{h}'\subs_p\overline{h}$ if and only if $[\overline{h}']\subs_{\sq p}[\overline{h}]$.
\end{corollary}

\begin{proof}
  Indeed, if $[\overline{h}']\subs_{\sq p}[\overline{h}]$ then the proof of \cref{theorem:i-2} shows that we have $\alpha(\overline{h}')\subs_p\alpha(\overline{h})$, and it follows from \cref{proposition:i-6} that $\overline{h}'\subs_p\overline{h}$.
\end{proof}

\begin{corollary}{2}
  $\overline{\UU}$ is a subcategory of the category of $\sq p$-injections.
\end{corollary}

\begin{definition}{9}
\label{definition:i-9}
  We say that $(\CC,p,\HH,\SS)$ is a \emph{right-solving category of homomorphisms} if the following axiom is satisfied:
  \begin{enumerate}
    \item[\normalfont(R)] Let $h,h'\in\HH$ be such that
      \[
        \alpha(h)=\alpha(h')
        \textand
        \beta(h)=\beta(h').
      \]
      Then there exists $s\subs_p\alpha(h)$ such that
      \[
        p(s)
        = \alpha\big(
          p(h)\cap p(h')
        \big).
      \]
      The substructure $s$ of $\alpha(h)$ is called the \emph{$p$-kernel} of $(h,h')$.
  \end{enumerate}
\end{definition}

We similarly define the notion of a \emph{left-solving} category of homomorphisms $(\CC,p,\HH,\SS)$ by replacing $\alpha$ with $\beta$ in the definition above.

\begin{longcomm}{41.2}
  This definition, given for inductive $\CC$, is also valid as soon as any two parallel morphisms (i.e. morphisms with the same source and same target) have a meet in $\CC$;
  for instance, such is the case when $\CC$ is the category of categories (though this condition may not be satisfied in some sub-inductive categories).

  In usual cases (in particular, if $\CC$ is the category of sets), $p(s)$ is an equaliser of $(p(h),p(h'))$;
  then, since $p$ is faithful, $s$ is a $p$-kernel of $(h,h')$ if and only if it is an equaliser of $(h,h')$ in $\HH$ (cf. \cite[Proposition~3.1]{coll109});
  so axiom~(R) of \cref{definition:i-9} means that $p$ creates equalisers defined by meets (cf. Comment~221.2 on \cite{coll100}).
  This justifies the name ``$p$-kernel'' (an equaliser is also called a \emph{difference kernel}, or even just a \emph{kernel}).
\end{longcomm}

\begin{examples}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      $(\MM,p_\FF,\FF,\FF_\gamma)$ is right solving.

    \item[\normalfont(2)]
      If, for all $e,E\in\CC_0$ such that $e<E$, we have that $\beta(Ee)=E$, then $(\CC,\Id_\CC,\CC,\CC)$ is left and right solving.

    \item[\normalfont(3)]
      If, for all $S\in\HH_0$ and all $e<p(S)$, there exists $s\subs_p S$ such that $p(s)=e$, then $(\CC,p,\HH,\SS)$ is right and left solving.
      This is also the case in particular for $(\MM,\omega,\widetilde{\Omega},\Omega)$ and $(\MM,\theta,\tTT,\TT)$.

    \item[\normalfont(4)]
      \oldpage{370}
      $(\MM,\theta,\tTT_u,\TT)$ is not right solving.
  \end{enumerate}
\end{examples}

\begin{proposition}{11}
\label{proposition:i-11}
  If $(\CC,p,\HH,\SS)$ is a right-solving category of homomorphisms, and if $\beta(Ee)=E$ for all $e<E$ in $\CC_0$, then the conditions
  \[
    \begin{gathered}
      h,h'\in\HH,
    \\\alpha(h)=\alpha(h')
      \textand
      \beta(h)=\beta(h')
    \end{gathered}
  \]
  imply that
  \[
    h\vdash_p(\beta(h),s)
    = h'\vdash_p(\beta(h),s),
  \]
  where $s$ is the $p$-kernel of $(h,h')$.
\end{proposition}

\begin{proof}
  Set
  \[
    \begin{gathered}
      p(h)\cap p(h')=f,
    \\e=\beta(f)
      \textand
      E=\beta(p(h)).
    \end{gathered}
  \]
  Then
  \[
    Ee\smallbullet f<p(h)
    \textand
    Ee\smallbullet f<p(h')
  \]
  whence
  \[
    p(h)\cap p(h')
    = f
    < Ee\smallbullet f
    < p(h)\cap p(h').
  \]
  It thus follows that $f=Ee\smallbullet f$ and $E=e$.
  The elements $f$ and
  \[
    p(h)p(s)
    = p(h)p\big(
      \alpha(h)\sups_p s
    \big)
  \]
  are equal, since they are bounded above by $p(h)$ and have the same source and same target ($p(s)$ and $E$, respectively).
  Thus $f=p(h)p(s)$.
  Similarly, $f=p(h')p(s)$.
  Since
  \[
    h\vdash_p(\beta(h),s)
    = \big(
      \beta(h), p(h)p(s), s
    \big)
    = (\beta(h),f,s)
  \]
  and
  \[
    h'\vdash_p(\beta(h),s)
    = (\beta(h),f,s)
  \]
  we have that
  \[
    h\vdash_p(\beta(h),s)
    = h'\vdash_p(\beta(h),s).
  \]
\end{proof}

In what follows, we further suppose that $\HH$ is endowed with an order relation $<$ such that $(\HH,<)$ is an inductive category, and such that $p$ is a strict inductive map from $(\HH,<)$ to $(\CC,<)$, i.e. such that $(\HH,<)$ is an inductive category over $(\CC,<)$ with respect to $p$ (see \cref{section:ii.3.iv}).\comm{42.1}{This notion (of an inductive category over $(\CC,<)$ with respect to $p$) is considered in \cite{coll53}. The definition of a \emph{strict inductive map} is given in \cref{section:ii.6}.}

\begin{theorem}{3}
\label{theorem:i-3}
  The following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(c)]
      $(\CC,p,\HH,\SS)$ is right solved, and $h'\subs_p h$ in $(\CC,p,\HH,\SS)$ if and only if $h'<h$ in $\HH$.

    \item[\normalfont(c\textquotesingle)]
      Let $s,s'\in\HH_0$;
      then $s'\subs_p s$ in $(\CC,p,\HH,\SS)$ if and only if $s'<s$ in $\HH$;
      in this case, $\beta(ss')=s$.
      Furthermore, the conditions
      \[
        \begin{gathered}
          h,h'\in\HH
        \\\alpha(h)=\alpha(h')
          \textand
          \beta(h)=\beta(h')
        \end{gathered}
      \]
      \oldpage{371}
      imply that
      \[
        p(h\cap h')
        = p(h)\cap p(h').
      \]
  \end{enumerate}
\end{theorem}

\begin{proof}
  Suppose that condition~(c) is satisfied;
  then
  \[
    s'\subs s\text{ in }(\CC,p,\HH,\SS)
    \quad\text{if and only if}\quad
    s'<s;
  \]
  in this case, $(s,p(s)p(s'),s')$ is a sub-homomorphism of $s$, and so
  \[
    \big(
      s, p(s)p(s'), s'
    \big)
    = s\sups_p s'
    = ss'
    \textand
    \beta(ss')=s.
  \]
  We thus deduce that the following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(a)]
      $h'<h$ in $\HH$;
    \item[\normalfont(b)]
      $\alpha(h')<\alpha(h)$, $\beta(h')<\beta(h)$, and $p(h)<p(h')$;
    \item[\normalfont(c)]
      $h'\subs h$ in $(\HH,\Id_\HH,\HH,\HH)$.
  \end{enumerate}
  Let $h,h'\in\HH$ be such that
  \[
    \alpha(h) = \alpha(h')
    \textand
    \beta(h) = \beta(h');
  \]
  since the category of homomorphisms $(\HH,\Id_\HH,\HH,\HH)$ is right solved, and since $\alpha(h\cap h')$ is the $\Id_\HH$-kernel of $(h,h')$, we have that
  \[
    \beta(h\cap h')
    = \beta(h)
  \]
  by \cref{proposition:i-11};
  consequently, we also have that
  \[
    \beta(p(h)\cap p(h'))
    = p(\beta(h)).
  \]
  Let $s$ be the $p$-kernel of $(h,h')$;
  the elements $p(h)\cap p(h')$ and $p(h)p(s)$ are equal, since they are both bounded above by $p(h)$ and have the same source and same target ($p(s)$ and $\beta(p(h))$, respectively);
  similarly,
  \[
    p(h)\cap p(h')
    = p(h')p(s).
  \]
  Then
  \[
    \begin{aligned}
      h\vdash_p(\beta(h),s)
      &= \big(
        \beta(h), p(h)p(s), s
      \big)
    \\&= \big(
        \beta(h), p(h)\cap p(h'), s
      \big)
    \\&= h'\vdash_p(\beta(h),s)
    \end{aligned}
  \]
  and
  \[
    h\vdash_p(\beta(h),s)
    < h\cap h'.
  \]
  The relations
  \[
    \begin{gathered}
      p(\alpha(h\cap h'))
      = \alpha(p(h)\cap p(h'))
      = p(s),
    \\\alpha(h\cap h') < \alpha(h)
      \textand
      s < \alpha(h)
    \end{gathered}
  \]
  imply that\comm{43.1}{Since $p$ is strict, we have immediately that $s=\alpha(h\cap h')$.}
  \[
    \alpha(h\cap h')
    < s.
  \]
  Thus
  \[
    s = \alpha(h\cap h')
    \textand
    h\cap h' = h\vdash_p(\beta(h),s)
  \]
  and so
  \[
    p(h\cap h')
    = p(h)\cap p(h').
  \]

  \oldpage{372}
  Conversely, suppose that condition~(c') is satisfied;
  if $h'<h$ then
  \[
    \begin{gathered}
      p(h')<p(h),
    \\\alpha(h')\subs\alpha(h)
      \textand
      \beta(h')\subs\beta(h)
    \end{gathered}
  \]
  whence $h'\subs_p h$.
  Let $h$ and $h'$ be such that
  \[
    \alpha(h) = \alpha(h')
    \textand
    \beta(h) = \beta(h');
  \]
  since
  \[
    \alpha(h\cap h')
    < \alpha(h)
  \]
  and
  \[
    p(\alpha(h\cap h'))
    = \alpha(p(h\cap h'))
    = \alpha(p(h)\cap p(h')),
  \]
  the category of homomorphisms $(\CC,p,\HH,\SS)$ is right solved.
  Suppose that $h'\subs_p h$;
  set
  \[
    \begin{array}{ll}
      \alpha(h)
      = s,
      &\alpha(h')
      = s',
    \\\beta(h)
      = s_1,
      &\beta(h')
      = s'_1.
    \end{array}
  \]
  Since $s'\subs s$ and $s'_1\subs s_1$, the elements
  \[
    hs'=h\smallbullet ss'
    \textand
    s_1h'=s_1s'_1\smallbullet h'
  \]
  have the same source and same target ($s'$ and $s_1$, respectively).
  We will show that they are equal;
  indeed,
  \[
    p(hs')=p(h)\smallbullet p(ss')
    \textand
    p(s_1h')=p(s_1s'_1)\smallbullet p(h')
  \]
  are bounded above by $p(h)$, and have the same source and same target ($p(s')$ and $p(s_1)$, respectively), and so $p(h's)=p(s_1h')$.
  We thus deduce that $hs'=s_1h'$, whence
  \[
      h'
      = s'_1\smallbullet h < (s_1s'_1)\smallbullet h'
    = hs'
    < h.
  \]
  Thus condition~(c) is satisfied.
\end{proof}

\begin{remark}
  \cref{theorem:i-3} still holds true (without any modifications to the proof) if we replace the hypothesis ``$(\HH,<)$ is an inductive category'' by the hypothesis ``$(\HH,<)$ is an ordered category in which any two elements have an intersection'' (\cref{section:ii.6}).\comm{44.1}{It suffices that \emph{any two parallel morphisms admit a meet} (this remark allows us to apply the result when $\CC$ is the category $\FF$).}
\end{remark}

\begin{example}
  Let $(\CC,p,\HH,\SS)$ be a right-solved category of homomorphisms such that $\HH_0$ is an inductive class \cite{3a} for the relation $\subs$;
  if we endow $\HH$ with the relation $\subs$, then $\HH$ becomes an inductive category, and condition~(c) of \cref{theorem:i-3} is then satisfied.

  \begin{longcomm}{44.2}
    We have to suppose that either \emph{$\CC$ is completely right regular}, or that \emph{$p_0$ from $\HH_0$ to $\CC_0$ preserves joins}.

    Indeed, let $h_i\colon s_i\to s'_i$ be morphisms in $\HH$ such that $h_i<h$;
    then there exist joins $s=\bigcup s_i$ and $s'=\bigcup s'_i$ in $(\HH,\subs)$;
    the above hypothesis implies that, if $k$ is the pseudo-product $p(s')(p(h)p(s))$, then there exists a commutative square in $\CC$ of the form
    \[
      \begin{tikzcd}
        p(s')
          \ar[d,swap,"p(S')p(s')"]
        & p(s)
          \ar[l,swap,"k"]
          \ar[d,"p(S)p(s)"]
      \\p(S')
        & p(S)
          \ar[l,"p(h)"]
      \end{tikzcd}
    \]
    hence $h$ has a sub-morphism $h'\colon s\to s'$, and $h'=\bigcup h_i$.
  \end{longcomm}

  It is also the case for the categories of homomorphisms $(\MM,p_\FF,\FF,\FF_\gamma)$ and $(\MM,\theta_u,\tTT_u,\TT)$ when $\FF$ and $\tTT_u$ are endowed with their usual order relations.

  \begin{longcomm}{44.3}
    This assertion is not correct: $\FF$ satisfies condition~(c), but $(\FF_0,\subs)$ is not an inductive class; $\tTT_u$ is not right solving.
  \end{longcomm}

  However, $(\MM,\theta,\tTT,\TT)$ does not satisfy condition~(c).
\end{example}

Let $(\HH,\overline{p},\bHH,\bSS)$ be a category of homomorphisms such that $\bSS$ contains the groupoid $\overline{\Gamma}$ of invertible elements of $\bHH$, and such that $(\HH,\overline{p},\bSS)$ is a species of superstructures \cite{3a} over $(\CC,p,\SS)$.
\oldpage{373}
These conditions imply that $(\CC,p\overline{p},\bHH,\bSS)$ is a category of homomorphisms.
An element $\overline{h}$ of $\bHH$ will be denoted either by the triple $(\beta(\overline{h}),\overline{p}(\overline{h}),\alpha(\overline{h}))$ or by the triple $(\beta(\overline{h}),p\overline{p}(\overline{h}),\alpha(\overline{h}))$.

Note that the conditions
\[
  s,S,\in\bHH_0
  \textand
  s\subs_{p\overline{p}} S
\]
imply that $\overline{p}(s)\relrhobar\overline{p}(S)$ in $(\CC,p,\HH,\SS)$, but, in general, they do not imply that $\overline{p}(s)\subs_p\overline{p}(S)$.

\begin{proposition}{12}
\label{proposition:i-12}
  Let $s,S\in\bHH_0$.
  The conditions
  \[
    \begin{gathered}
      s\subs_{p\overline{p}}S,
    \\\overline{p}(s)<\overline{p}(S)
      \textand
      \beta\big(\overline{p}(S)\overline{p}(s)\big) = \overline{p}(S)
    \end{gathered}
  \]
  imply that $s\subs_{\overline{p}}S$.
\end{proposition}

\begin{proof}
  Let
  \[
    \overline{j}
    = \big(
      S, p\overline{p}(S)p\overline{p}(s), s
    \big) \in \bHH;
  \]
  then
  \[
    p\overline{p}(\overline{j})
    = p\big(
      \overline{p}(S)\overline{p}(s)
    \big)
    = p\overline{p}(S)p\overline{p}(s),
  \]
  since
  \[
    \begin{gathered}
      p\big(
        \overline{p}(S)\overline{p}(s)
      \big) < p\overline{p}(S)p\overline{p}(s),
    \\\alpha\big(
        \overline{p}(S)\overline{p}(s)
      \big) = \overline{p}(s)
      \textand
      \beta\big(
        \overline{p}(S)\overline{p}(s)
      \big) = \overline{p}(S).
    \end{gathered}
  \]
  Thus
  \[
    \overline{p}(\overline{j})
    = \big(
      \overline{p}(S), p\overline{p}(S)p\overline{p}(s), \overline{p}(s)
    \big)
    = \overline{p}(S)\overline{p}(s)
  \]
  and
  \[
    \overline{j}
    =\big(
      S, \overline{p}(S)\overline{p}(s), s
    \big).
  \]
  Let
  \[
    \overline{g}
    = \big(
      S, \overline{p}(S)\overline{p}(s)\smallbullet g', S'
    \big) \in\bHH
  \]
  where $g'\in\HH$.
  We have that
  \[
    \begin{aligned}
      \overline{p}(\overline{g})
      &= \big(
        \overline{p}(S),
        p\big(\overline{p}(S)\overline{p}(s)\big)\smallbullet p(g'),
        \overline{p}(S')
      \big)
    \\&= \big(
        \overline{p}(S),
        \big(p\overline{p}(S)p\overline{p}(s)\big)\smallbullet p(g'),
        \overline{p}(S')
      \big)
    \end{aligned}
  \]
  whence
  \[
    \overline{g}
    = \big(
      S, p\overline{p}(S)p\overline{p}(s)\smallbullet p(g'), S'
    \big).
  \]
  From the condition that $s\subs_{\overline{p}}S$, and by \cref{proposition:i-4}, it follows that
  \[
    \overline{g}'
    = (s, p(g'), S')
    \in\bHH.
  \]
  Since $g'=(\overline{p}(s),p(g'),\overline{p}(S'))$, we thus deduce that
  \[
    \overline{p}(\overline{g}') = g'
    \textand
    \overline{g}' = (s,g',S') \in \bHH.
  \]
  Thus $s\subs_{\overline{p}}S$, by \cref{proposition:i-4}.
\end{proof}

\begin{corollary}{1}
  \oldpage{374}
  The conditions
  \[
    \begin{gathered}
      h,h'\in\bHH,
    \\h'\subs_{p\overline{p}}h,
      \quad \overline{p}(h') < \overline{p}(h),
    \\\beta\big(
        \overline{p}\big(\alpha(h)\alpha(h')\big)
      \big) = \overline{p}(\alpha(h))
      \textand
      \beta\big(
        \overline{p}\big(\beta(h)\beta(h')\big)
      \big) = \overline{p}(\beta(h))
    \end{gathered}
  \]
  imply that $h'\subs_{\overline{p}}h$.
\end{corollary}

\begin{corollary}{2}
  Suppose that $p$ further satisfies the condition
  \[
    p(hs)
    = p(h)p(s)
  \]
  whenever $s<\alpha(h)$.
  Then the conditions
  \[
    s\subs_{p\overline{p}}S
    \textand
    \overline{p}(s) < \overline{p}(S)
  \]
  imply that $s\subs_{\overline{p}}S$.
\end{corollary}

\begin{proof}
  Indeed, from these conditions it follows that
  \[
    \begin{aligned}
      p\big(
        \overline{p}(S)\overline{p}(s)
      \big)
      &= p\overline{p}(S)p\overline{p}(s),
    \\\alpha\big(
        p\overline{p}(S)p\overline{p}(s)
      \big)
      &= p\overline{p}(s),
    \\\beta\big(
        p\overline{p}(S)p\overline{p}(s)
      \big)
      &= p\overline{p}(S),
    \end{aligned}
  \]
  whence
  \[
    \overline{p}(S)
    = \beta\big(
      \overline{p}(S)\overline{p}(s)
    \big)
  \]
  since
  \[
    \beta\big(
      \overline{p}(S)\overline{p}(s)
    \big) < \overline{p}(S)
    \textand
    p\big(
      \beta\big(
        \overline{p}(S)\overline{p}(s)
      \big)
    \big) = p\overline{p}(S).
  \]
  We are thus reduced to the hypotheses of \cref{proposition:i-12}.
\end{proof}

From now on, we will further suppose that the conditions
\[
  \begin{gathered}
    h\in\HH,
    \quad s\in\HH_0
  \\s < \beta(h)
  \end{gathered}
\]
imply that $p(sh)=p(s)p(h)$.

\begin{proposition}{13}
\label{proposition:i-13}
  Let $s,S\in\bHH_0$.
  Then the relation $s\subs_{\overline{p}}S$ in $(\HH,\overline{p},\bHH,\bSS)$ imply that $s\subs_{p\overline{p}}(S)$ in $(\CC,p\overline{p},\bHH,\bSS)$.
\end{proposition}

\begin{proof}
  Set $\overline{j}=(S,\overline{p}(S)\overline{p}(s),s)\in\bHH$;
  we have that
  \[
    \overline{j}
    = \big(
      S, p\overline{p}(S)p\overline{p}(s), s
    \big)
  \]
  since we obtain the equality $p\overline{p}(\overline{j})=p\overline{p}(S)p\overline{p}(s)$ by using the relations
  \[
    \begin{gathered}
      p\overline{p}(\overline{j})
      = p\big(
        \overline{p}(S)\overline{p}(s)
      \big)
      < p\overline{p}(S)p\overline{p}(s),
    \\p\overline{p}(s)
      = \alpha\big(
        p\overline{p}(\overline{j})
      \big)
      < \alpha\big(
        p\overline{p}(S)p\overline{p}(s)
      \big)
      < p\overline{p}(s),
    \\p\overline{p}(S)
      = \beta\big(
        p\overline{p}(\overline{j})
      \big)
      < \beta\big(
        p\overline{p}(S)p\overline{p}(s)
      \big)
      < p\overline{p}(S).
    \end{gathered}
  \]
  Let $\overline{g}=(S,g,S')\in\overline{H}$, where $g\in\CC$, be such that
  \[
    \alpha\big(
      p\overline{p}(s)g
    \big) = \alpha(g)
    \textand
    \beta\big(
      p\overline{p}(s)g
    \big) = \beta(g).
  \]
  We will show that
  \[
    \big(
      s, p\overline{p}(s)g, S'
    \big)
    \in\overline{H}.
  \]
  \oldpage{375}
  Indeed, since $\overline{p}(s)<\overline{p}(\beta(\overline{g}))$, we have that
  \[
    p\big(
      \overline{p}(s)\overline{p}(\overline{g})
    \big)
    = p\overline{p}(s)p\overline{p}(\overline{g})
    = p\overline{p}(s)g;
  \]
  from the relations
  \[
    \begin{aligned}
      \alpha\big(
        \overline{p}(s)\overline{p}(\overline{g})
      \big)
      &< \overline{p}(S'),
    \\\beta\big(
        \overline{p}(s)\overline{p}(\overline{g})
      \big)
      &< \overline{p}(s),
    \\p\big(
        \alpha\big(
          \overline{p}(s)\overline{p}(\overline{g})
        \big)
      \big)
      &= p\big(
        \overline{p}(S')
      \big),
    \\p\big(
        \beta\big(
          \overline{p}(s)\overline{p}(\overline{g})
        \big)
      \big)
      &= p\big(
        \overline{p}(s)
      \big),
    \end{aligned}
  \]
  it follows that
  \[
    \alpha\big(
      \overline{p}(s)\overline{p}(\overline{g})
    \big)
    = \overline{p}(S')
    \textand
    \beta\big(
      \overline{p}(s)\overline{p}(\overline{g})
    \big)
    = \overline{p}(s).
  \]
  Since $s\subs S$ in $(\HH,\overline{p},\bHH,\bSS)$, we thus deduce that
  \[
    \big(
      s, \overline{p}(s)\overline{p}(\overline{g}), S'
    \big)
    = \big(
      s, p\overline{p}(s)g, S'
    \big)
    \in\HH.
  \]
  This proves that we have $s\subs_{p\overline{p}}S$ in $(\CC,p\overline{p},\bHH,\bSS)$.
\end{proof}

\begin{corollary}{1}
  The conditions $h,h'\in\bHH$ and $h'\subs_{\overline{p}}h$ imply that $h'\subs_{p\overline{p}}h$.
\end{corollary}

\begin{corollary}{2}
  If, for all $s,S\in\HH_0$ such that $s<S$, we have $\beta(Ss)=S$, then $s<S$ implies that $s\subs S$ in $(\CC,p,\HH,\SS)$.
\end{corollary}

\begin{proof}
  These conditions imply that we have $s\subs S$ in $(\HH,\Id_\HH,\HH,\HH)$, and the Corollary then follows from the Proposition.
\end{proof}

\begin{corollary}{3}
  If $(\HH,\overline{p},\bHH,\bSS)$ is right solving, and if the following condition is satisfied:
  \begin{quote}
    For $h,h'\in\HH$ such that
    \[
      \alpha(h)=\alpha(h')
      \textand
      \beta(h)=\beta(h')
    \]
    we have that
    \[
      p(h\cap h')
      = p(h)\cap p(h')
    \]
  \end{quote}
  then $(\CC,p\overline{p},\bHH,\bSS)$ is right solving.
\end{corollary}

\begin{proof}
  Let $\overline{h},\overline{h}'\in\bHH$ be such that $\alpha(\overline{h})=\alpha(\overline{h}')$ and $\beta(\overline{h})=\beta(\overline{h}')$;
  let $s$ be the $\overline{p}$-kernel of $(\overline{h},\overline{h}')$;
  by the Proposition, we have that $s\subs S$ in $(\CC,p\overline{p},\bHH,\bSS)$.
  The relations
  \[
    \begin{aligned}
      \overline{p}(s)
      &= \alpha\big(\overline{p}(\overline{h})\cap\overline{p}(\overline{h}')\big)
    \\p\big(\overline{p}(\overline{h})\cap\overline{p}(\overline{h}')\big)
      &= p\overline{p}(\overline{h})\cap p\overline{p}(\overline{h}')
    \end{aligned}
  \]
  imply that $p\overline{p}(s)=\alpha(p\overline{p}(\overline{h})\cap p\overline{p}(\overline{h}'))$, and so $(\overline{h},\overline{h}')$ admits $s$ as a $p\overline{p}$-kernel, and $(\CC,p\overline{p},\bHH,\bSS)$ is right solving.
\end{proof}

\begin{corollary}{4}
  Suppose that $s\relrhobar S$ in $(\CC,p,\HH,\SS)$ implies both that $s<S$ in $\HH_0$ and that $\beta(Ss)=S$;
  then the statement that $\overline{s}\subs_{p\overline{p}}\overline{S}$ in $(\CC,p\overline{p},\bHH,\bSS)$ is equivalent to $\overline{s}\subs_{\overline{p}}\overline{S}$ in $(\HH,\overline{p},\bHH,\bSS)$.
\end{corollary}

\oldpage{376}
\begin{proof}
  Indeed, $\overline{s}\subs_{\overline{p}}\overline{S}$ implies that $\overline{s}\subs_{p\overline{p}}\overline{S}$ by \cref{proposition:i-13}.
  Suppose that $\overline{s}\subs_{p\overline{p}}\overline{S}$;
  since
  \[
    \overline{j}
    = \big(
      \overline{S}, p\overline{p}(\overline{S})p\overline{p}(\overline{s}), \overline{s}
    \big)
    \in \bHH
  \]
  we have that
  \[
    \begin{aligned}
      \overline{p}(\overline{j})
      &= \big(
        \overline{p}(\overline{S}), p\overline{p}(\overline{S})p\overline{p}(\overline{s}), \overline{p}(\overline{s})
      \big)
      \in\HH
    \\p\overline{p}(\overline{s})
      &< p\overline{p}(\overline{S}),
    \end{aligned}
  \]
  whence $\overline{p}(\overline{s})\relrhobar\overline{p}(\overline{S})$.
  Then $\overline{p}(\overline{s})<\overline{p}(\overline{S})$ in $\HH$, and
  \[
    \beta\big(
      \overline{p}(\overline{S})\overline{p}(\overline{s})
    \big)
    = \overline{p}(\overline{S}).
  \]
  \cref{proposition:i-12} then implies that $\overline{s}\subs_{\overline{p}}\overline{S}$.
\end{proof}

\begin{proposition}{14}
\label{proposition:i-14}
  Suppose that $(\CC,p,\HH,\SS)$ satisfies Condition~(c) of \cref{theorem:i-3}, and that $s\relrhobar S$ in $(\CC,p,\HH,\SS)$ implies that $s<S$ in $\HH$;
  then $(\HH,\overline{p},\bHH,\bSS)$ is right solving if and only if $(\CC,p\overline{p},\bHH,\bSS)$ is right solving.
\end{proposition}

\begin{proof}
  If $(\HH,\overline{p},\bHH,\bSS)$ is right solving, then $(\CC,p\overline{p},\bHH,\bSS)$ is right solving, by Corollary~3 of \cref{proposition:i-13}.
  Conversely, suppose that $(\CC,p\overline{p},\bHH,\bSS)$ is right solving;
  let $\overline{h},\overline{h}'\in\bHH$ be such that
  \[
    \alpha(\overline{h})=\alpha(\overline{h}')
    \textand
    \beta(\overline{h})=\beta(\overline{h}');
  \]
  let $\overline{s}$ be the $p\overline{p}$-kernel of $(\overline{h},\overline{h}')$.
  By axiom~(c), $s<S$ in $\HH$ implies that $s\subs S$ in $(\CC,p,\HH,\SS)$, and so $\beta(Ss=S)$;
  by Corollary~4 of \cref{proposition:i-13}, it follows that $\overline{s}\subs_{\overline{p}}\alpha(\overline{h})$.
  Furthermore, the relations
  \[
    \begin{gathered}
      \overline{p}(\overline{s})
      < \alpha\big(
        \overline{p}(\overline{h})\cap\overline{p}(\overline{h}')
      \big)
    \\p\big(
        \overline{p}(\overline{h})\cap\overline{p}(\overline{h}')
      \big)
      = p\overline{p}(\overline{h})\cap p\overline{p}(\overline{h}')
    \\p\overline{p}(\overline{s})
      = \alpha\big(
        p\overline{p}(\overline{h})\cap p\overline{p}(\overline{h}')
      \big)
      = p\big(
        \alpha\big(
          \overline{p}(\overline{h})\cap\overline{p}(\overline{h}')
        \big)
      \big)
    \end{gathered}
  \]
  imply that $\overline{p}(\overline{s})=\alpha(\overline{p}(\overline{h})\cap\overline{p}(\overline{h}'))$.
  Thus $\overline{s}$ is the $\overline{p}$-kernel of $(\overline{h},\overline{h}')$, and $(\HH,\overline{p},\bHH,\bSS)$ is right solving.
\end{proof}

\begin{theorem}{4}
\label{theorem:i-4}
  Suppose that the following conditions are satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $(\CC,<)$ is a completely right regular $(\II,\II',\II'')$-structured category (see \cref{section:ii.6}), and that the groupoid $\CC_\gamma$ of invertible elements of $\CC$ is an inductive groupoid (\cref{section:ii.6}).

    \item[\normalfont(2)]
      $(\HH,<)$ is completely right regular.

    \item[\normalfont(3)]
      $\HH$ is saturated over $\CC$, and, for $h,h'\in\Gamma$, the conditions
      \[
        \alpha(h')<\alpha(h)
        \textand
        p(h')<p(h)
      \]
      imply that $h'<h$.
  \end{enumerate}

  \oldpage{377}
  Then there exists a subcategory $\HH_u$ of $\HH$ containing $\Gamma$ such that $s'<s$ in $\HH_0$ if and only if $s'\subs_{p_u}s$ in $(\CC,p_u,\HH_u,\Gamma)$, where $p_u$ is the restriction of $p$ to $\HH_u$.
\end{theorem}

\begin{proof}
  Let $\HH_u$ be the class of all elements $h\in\HH$ that satisfy the following condition:
  \begin{quote}
    \itshape
    Let $s\in\HH_0$ with $s<\alpha(h)$;
    let $p(h)^>\smallbullet p(s)$ be the class of all elements $g\in\CC$ such that $g<p(h)$ and $\alpha(g)=p(s)$.
    Set
    \[
      p(h)|p(s)
      = \bigcap\big(p(h)^>\smallbullet p(s)\big).
    \]
    Then there exists $h|s\in\HH$ such that\comm{49.1}{It is useful to notice that $h|s$ is unique. Indeed, its target is the unique $s'$ such that $s'<\beta(h)$ and $p(s')=\beta(p(h)|p(s))$ (because $p$ is strict), and its source $s$ and image $p(h)|p(s)$ are given.}
    \[
      \begin{aligned}
        h|s
        &< h,
      \\\alpha(h|s)
        &= s,
      \\p(h|s)
        &= p(h)|p(s).
      \end{aligned}
    \]
  \end{quote}
  We will show that $\HH_u$ contains $\Gamma$.
  Indeed, suppose that $h\in\Gamma$ and $s<\alpha(h)$.
  Let $g\in\CC_\gamma$ be the invertible element induced by $p(h)\in\CC_\gamma$ {over} $p(s)$, whose existence is ensured by the fact that $\CC_\gamma$ is an inductive groupoid.
  We will show that $g=p(h)|p(s)$.
  We have
  \[
    p(h)|p(s) < g.
  \]
  Let $g'\in p(h)^>\smallbullet p(s)$ be such that $g'<g$.
  Since $g'\smallbullet g^{-1}<\beta(g)$, and since $\CC$ is completely right regular, we have
  \[
    \begin{aligned}
      \big(
        \beta(g)\beta(g')
      \big)\smallbullet (g'\smallbullet g^{-1})
      &= \beta(g),
    \\(g'\smallbullet g^{-1})\big(
        \beta(g)\beta(g')
      \big)
      &= \beta(g'),
    \end{aligned}
  \]
  whence $g'\smallbullet g^{-1}\in\CC_\gamma$.
  Since $\CC_\gamma$ is an inductive groupoid, it thus follows that $g'\smallbullet g^{-1}\in\CC_0$, i.e. that
  \[
    \beta(g)=\beta(g');
  \]
  taking into account the relations $g'<g$ and $\alpha(g)=\alpha(g')$, we find that $g=g'$.

  \begin{longcomm}{49.2}
    The proof is not complete;
    it remains to show that $g$ is less than any $f$ in $p(h)^>\smallbullet p(s)$.
    Indeed, the relations
    \[
      \begin{gathered}
        f\cap g
        < p(h),
      \\\alpha(f\cap g)
        = \alpha(f)\cap\alpha(g)
        = s
      \end{gathered}
    \]
    mean that $f\cap g$ is in $p(h)^>\smallbullet p(s)$.
    Since $f\cap g<g$, the given proof implies that $f\cap g=g$, whence
    \[
      g<f
      \textand
      g < p(h)|p(s).
    \]
    Finally, $g=p(h)|p(s)$.
  \end{longcomm}
  Thus $p(h)|p(s)=g$ and, by condition~(3), there exists
  \[
    (s_1,g,s)\in\Gamma
    \quad\text{such that}\quad
    (s_1,g,s) < h.
  \]
  Thus
  \[
    h|s
    = (s_1,g,s)
    \in\HH
    \textand
    h\in\HH_u.
  \]
  Now we show that $\HH_u$ is a subcategory of $\HH$.
  Let $h,h_1\in\HH_u$ be such that
  \[
    \alpha(h_1)
    = \beta(h).
  \]
  Let $s<\alpha(h)$ and $s_1=\beta(h|s)$;
  we will prove the equality
  \[
    (h_1\smallbullet h)|s
    = (h_1|s_1)\smallbullet(h|s);
  \]
  indeed, if $k<p(h_1\smallbullet h)$ and $\alpha(k)=p(s)$, then we have that
  \[
    k = g'_1\smallbullet g'
  \]
  where $g'_1<p(h_1)$ and $g'<p(h)$, since $(\CC,<)$ is $(\II,\II',\II'')$-structured.
  \oldpage{378}
  Since $\alpha(g')=p(s)$, we have that $p(h)|p(s)<g'$, whence
  \[
    p(s_1)<\alpha(g'_1);
  \]
  consequently,
  \[
    p(h_1)|p(s_1)
    < g'_1\smallbullet\big(\alpha(g'_1)p(s_1\big)
  \]
  and
  \[\big(p(h_1)|p(s_1)\big)\smallbullet\big(p(h)|p(s)\big)
    < k
  \]
  which proves that
  \[
    \big(p(h_1)|p(s_1)\big)\smallbullet\big(p(h)|p(s)\big)
    = \bigcap \big(
      p(h_1\smallbullet h)^>\smallbullet p(s)
    \big).
  \]
  We thus deduce that
  \[
    (h_1\smallbullet h)|s
    = (h_1|s_1)\smallbullet(h|s)
  \]
  and, finally, that
  \[
    h_1\smallbullet h\in\HH_u.
  \]
  Furthermore, $\HH_u$ is saturated under induction in $\HH$, since the relations
  \[
    \begin{gathered}
      h\in\HH_u
    \\h'<h,
      \textand
      s'<\alpha(h')
    \end{gathered}
  \]
  imply that
  \[
    s'<\alpha(h)
    \textand
    p(h|s') < p\big(h'\smallbullet(\alpha(h')s')\big),
  \]
  i.e.
  \[
    h|s'
    < h'\smallbullet(\alpha(h')s')
    < h'
  \]
  whence
  \[
    h|s'
    = h'|s'
    \textand
    h'\in\HH_u.
  \]
  \begin{longcomm}{50.1}
    \emph{The proof has to be completed as follows.}
    Now, $p(h|s')\in p(h')^>\smallbullet p(s')$ implies that $p(h'|s')<p(h|s')$.
    Conversely, $p(h')^>\smallbullet p(s')\subset p(h)^>\smallbullet p(s')$ implies that $p(h|s')<p(h'|s')$;
    hence $p(h|s')=p(h'|s')$.
    From the unicity of $h'|s'$ (cf. Comment~49.1), we deduce that $h|s'=h'|s'$, since both have the same image under $p$ and the same source $s'$.
  \end{longcomm}
  It thus follows that, if $h\in\HH_u$ and $s'_1<\beta(h)$, then $s'_1h\in\HH_u$, and so
  \[
    p_u(s'_1h)
    = p(s'_1h)
    = p_u(s'_1)p_u(h).
  \]
  Then we can apply Corollary~2 of \cref{proposition:i-13}, and we have that $s'<s$ in $\HH_u$ implies that $s'\subs_{p_u}s$ in $(\CC,p_u,\HH_u,\Gamma)$.

  Conversely, let us show that if $s'\subs_{p_u}s$ then $s'<s$ in $\HH_0$.
  Set
  \[
    j
    = (s, p(s)p(s'), s')
    \in \HH_u;
  \]
  we have that $p(s')\in p(j)^>\smallbullet p(s')$;
  let $g\in p(j)^>\smallbullet p(s')$ be such that
  \[
    g<p(s').
  \]
  By using the relations
  \[
    \begin{aligned}
      \alpha(g)
      &= p(s'),
    \\\big( p(s')\beta(g) \big)\smallbullet g
      &= p(s'),
    \\g\smallbullet\big( p(s')\beta(g) \big)
      &= \beta(g),
    \end{aligned}
  \]
  we obtain that $g=(p(s')\beta(g))^{-1}$ and, since $\CC_\gamma$ is an inductive groupoid, $g=p(s')$.
  \begin{longcomm}{50.2}
    \emph{The proof has to be completed as follows.}
    To conclude that $p(s')=p(j)|p(s')$, we have to prove that $p(s')<f$ for each $f\in p(j)^>\smallbullet p(s')$.
    Indeed, the relations
    \[
      f\cap p(s')
      \in p(j)^>\smallbullet p(s')
      \textand
      f\cap p(s')
      < p(s')
    \]
    imply that $p(s')=f\cap p(s')$, whence $p(s')<f$.
  \end{longcomm}
  Consequently, $p(s')=p(j)|p(s')$ and there exists
  \[
    j|s'
    = (s_1,p(s'),s')
    \in\HH
  \]
  such that
  \[
    s_1<s
    \textand
    p(s_1)=p(s').
  \]
  By the above, we thus have that $s_1\subs_{p_u}s$, and so $s'=s_1<s$ by Corollary~1 of \cref{theorem:i-1}.
\end{proof}

\begin{longcomm}{50.3}
  The results of this Part~I may be strengthened by replacing the hypotheses ``$\CC$ is inductive'' or ``$\HH$ is inductive'' as follows:
  \begin{itemize}
    \item In \cref{proposition:i-11}:
      $\CC$ is sub-inductive and
      \begin{quote}
        (*)\textsubscript{$\CC$}
        Any two parallel morphisms admit a meet in $\CC$;
      \end{quote}

    \item In \cref{theorem:i-3}, Corollary~3 (of \cref{proposition:i-13}), and \cref{proposition:i-13} and \cref{proposition:i-14}:
      Conditions (*)\textsubscript{$\CC$} and (*)\textsubscript{$\HH$};

    \item In \cref{proposition:i-13} and \cref{proposition:i-12} and their Corollaries:
      $\CC$ and $\HH$ are sub-inductive.
  \end{itemize}

  Finally, in \cref{theorem:i-4}, ``$(\CC,<)$ is $(\II,\II',\II'')$-structured'' could be replaced by ``$(\CC,<)$ is $(\II^\mathcal{s},\II'{}^\mathcal{s},\II''{}^\mathcal{s})$-structured'', where $\II^\mathcal{s}$ is the category of sub-inductive maps, and $\II'{}^\mathcal{s}$ and $\II''{}^\mathcal{s}$ its intersections with $\widetilde{\Omega}'$ and $\widetilde{\Omega}''$ (respectively) (\cite{coll69}).
\end{longcomm}

\begin{definition}{10}
\label{definition:i-10}
  \oldpage{379}
  With the notation of \cref{theorem:i-4}, an element of $\HH_u$ is called a \emph{$p$-open homomorphism}.
\end{definition}

\begin{examples}
  \begin{enumerate}
    \item
      In the category of homomorphisms $(\MM,\theta,\tTT,\TT)$, a $\theta$-open homomorphism is an open continuous map.

    \item
      In $(\MM,p_\FF,\FF,\FF_\gamma)$, a functor $F$ is $p_\FF$-open if and only if $F(\CC)$ is a subcategory of $\beta(F)$ for every subcategory $\CC$ of $\alpha(F)$.
      In particular, every functor $F$ such that $F_0$ is an injection is $p_\FF$-open.
      Using the canonical decomposition of a functor (see \cite{3a}), every functor is thus the composite of an open functor and a faithful functor.
      \begin{longcomm}{51.1}
        This factorisation of $F\colon A\to B$ is $A\xrightarrow{q}F_0^*(B)\xrightarrow{\pi}B$, where
        \[
          \begin{tikzcd}
            B \ar[d,swap,"{[\beta,\alpha]}"]
            & F_0^*(B) \ar[l,swap,"\pi"] \ar[d]
          \\B_0\times B_0
            & A_0\times A_0 \ar[l,"F_0\times F_0"]
          \end{tikzcd}
        \]
        is a pullback.
      \end{longcomm}
      Note that the subcategory $\FF_u$ of $\FF$ satisfies condition~($\sigma$) of \cref{proposition:i-10}.
  \end{enumerate}
\end{examples}

\begin{particular}
  In what follows, more often than not, we concern ourselves with the case of a category of homomorphisms $(\MM,p,\HH,\Gamma)$, where $\MM$ is the category of maps constructed in \cref{section:i.5} and where $\Gamma$ is the groupoid of invertible elements of $\HH$.
  We suppose $\MM$ to be endowed with the order relation
  \[
    \begin{gathered}
      (E',f,E) < (E'_1,f_1,E_1)
      \qquad\text{if and only if}
    \\\text{$E\subset E_1$, $E'\subset E'_1$, and $f$ is a restriction of $f_1$.}
    \end{gathered}
  \]

  Then $\MM$ is an inductive category such that $\beta(Ee)=E$ for all $e,E\in\MM_0$ with $e<E$;
  consequently, the relations
  \[
    \big[\text{$e<E$ in $\MM_0$}\big]
    \textand
    \big[\text{$e\subs E$ in $(\MM,\Id_\MM,\MM,\MM)$}\big]
  \]
  are equivalent.

  In $(\MM,p,\HH,\Gamma)$, we have that $s\relrhobar S$ if and only if
  \[
    p(s)\subset p(S)
    \textand
    (S,\iota,s)\in\HH.
  \]

  For $s$ to be a substructure of $S$ in $(\MM,p,\HH,\Gamma)$, it is necessary and sufficient that the following conditions be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $p(s)\subset P(S)$ and $(S,\iota,s)\in\HH$;
    \item[\normalfont(2)]
      the conditions $(S,g,S')\in\HH$ and $g(p(S'))\subset p(S)$ imply that
      \[
        (s,g,S')\in\HH.
      \]
  \end{enumerate}
\end{particular}

\begin{proposition}{15}
\label{proposition:i-15}
  If $\HH$ is saturated over $\MM$, then $(p(\Gamma),p\beta,\HH_\alpha)$ is a species of structures, where $\HH_\alpha$ denotes the class of $p$-injections.
\end{proposition}

\begin{proof}
  Let $s\subs S$ and $g\in p(\Gamma)$ be such that
  \[
    \alpha(g)
    = p(S);
  \]
  since $p(\Gamma)$ is saturated in $\HH$, we have that $g'\in p(\Gamma)$, where $g'$ is the bijection induced by $g$ on $p(s)$;
  the relations $g'<g$ and $\alpha(g',s)=s\subs\alpha(g,S)$ imply that $(g',s)\subs(g,S)$ by \cref{proposition:i-6}, and so
  \[
    \beta(g',s)
    \subs_p \beta(g,S).
  \]
  \oldpage{380}
  From the definitions, it follows that $p(\Gamma)$ acts on $\HH_\alpha$ with the composition law
  \[
    \big(
      g, S\sups_p s
    \big)
    \longmapsto
    \big(
      \beta(g,S) \sups_p \beta(g',s)
    \big)w
    \quad\text{if and only if}\quad
    \alpha(g)=p(S).
    \qedhere
  \]
\end{proof}

Let
\[
  \overline{h} = (S_1,h,S)\in\HH
  \textand
  \overline{h}' = (S_1,h',S)\in\HH;
\]
for a substructure $s$ of $S$ to be the $p$-kernel of $(h,h')$, it is necessary and sufficient that $p(s)$ be the class consisting of the $x$ such that $h(x)=h'(x)$.

\begin{proposition}{16}
\label{proposition:i-16}
  If $(\MM,p,\HH,\Gamma)$ is right solving, then $\Gamma$ acts on the class $\HH_n$ of $p$-injections $S\sups_p s$ such that $s$ is the $p$-kernel of a pair $(h,h')$, where $\alpha(h)=S$.
\end{proposition}

\begin{proof}
  Let $(S_1,g,S)=\overline{g}\in\Gamma$, and let $s$ be the $p$-kernel of $(h,h')$, where $\alpha(h)=S$.
  By axiom~(R) of \cref{definition:i-9}, the pair $(h\smallbullet g^{-1},h'\smallbullet g^{-1})$ admits a $p$-kernel $s_1\in S_1$;
  since $p(s_1)=g(p(s))$, it follows from \cref{proposition:i-7} that we have
  \[
    \overline{g}' = (s_1,g\iota,s)
    \in\Gamma.
  \]
  Thus $\Gamma$ acts on $\HH_n$ with the composition law
  \[
    (\overline{g},S\sups s)
    \longmapsto S_1\sups s_1
    \quad\text{if and only if}\quad
    S=\alpha(\overline{g}).
    \qedhere
  \]
\end{proof}

We endow $\FF$ with the order relation:
\begin{quote}
  $(G_1^\perp,F,G^\perp)<(\overline{G}_1^\perp,\overline{F},\overline{G}^\perp)$
  \qquad if and only if\quad
  $G^\perp$ (resp. $G_1^\perp$) is a subcategory of $\overline{G}^\perp$ (resp. of $\overline{G}_1^\perp$) and $F$ is a restriction of $\overline{F}$.
\end{quote}

Then $\FF$ is an inductive category that is supraregular over $\MM$ with respect to $p_\FF$, in the sense of \cite{3c}.
\begin{longcomm}{52.2}
  $\FF$ is only a \emph{sub}-inductive category, but the previous results may still be applied to it (cf. Comments~31.1 and 50.3).
\end{longcomm}
Furthermore, $(\MM,p_\FF,\FF,\FF)$ satisfies condition~(c) of \cref{theorem:i-3}.
The three conditions
\[
  G^\perp\relrhobar\overline{G}^\perp,
  \quad G^\perp\subs\overline{G}^\perp,
  \textand G^\perp<\overline{G}^\perp
\]
are equivalent (see \cref{section:ii}, \cref{proposition:ii-9}).
Let $(\FF,\overline{p},\bHH,\overline{\Gamma})$ be a category of homomorphisms such that $\overline{\Gamma}$ is the groupoid of invertible elements of $\bHH$.
From Corollary~2 of \cref{proposition:i-12} and from \cref{proposition:i-14}, it follows that:

\begin{proposition}{17}
\label{proposition:i-17}
  The conditions $s\subs S$ in $(\FF,\overline{p},\bHH,\overline{\Gamma})$ and $s\subs S$ in $(\MM,p_\FF\overline{p},\bHH,\overline{\Gamma})$ are equivalent;
  $(\FF,\overline{p},\bHH,\overline{\Gamma})$ is right solving if and only if $(\MM,p_\FF\overline{p},\bHH,\overline{\Gamma})$ is right solving.
\end{proposition}

\begin{remark}
  Let $(\MM,p,\HH,\Gamma)$ be a category of homomorphisms.
  For $(S,\iota,s)$ to be a strict monomorphism \cite{2} of $\HH$, it suffices that $s$ be a substructure of $S$ and that there exist a family of elements $(S',h_i,S)$, with $i\in I$, such that $p(s)$ is the class of the $x$ for which $h_i(x)=h_j(x)$ for all $i,j\in I$.
  Let $h,h'\in\HH$;
  \oldpage{381}
  if $(h,h')$ admits a $p$-kernel $s$, then $s$ is a kernel of $(h,h')$ in $\HH$ \cite{2}.
  If $\HH$ is saturated over $\MM$, then, for every strict monomorphism $(S,g,S')$ in $\HH$ such that $g$ is injective, there exists a substructure $s$ of $S$ such that $(s,\gamma,S')\in\Gamma$;
  but a kernel of a pair $(h,h')$ is not always isomorphism to a $p$-kernel of $(h,h')$.\comm{53.1}{A kernel (or equaliser) $k\colon e\to e'$ of $(h,h')$ is always a $p$-injection, since $p$ is faithful; it is a $p$-kernel if $p(k)$ is an equaliser in $\CC$ of $(p(h),p(h'))$ (cf. Comment~41.2).}
\end{remark}



\section{Structured categories}
\label{section:ii}

\subsection{Categories of homomorphisms with finite products}
\label{section:ii.1}

Let $\MM_0$ a class of classes such that if it contains $X$ then it also contains all the subsets of $X$, and such that if it contains $X$ and $Y$ then it contains their product $X\times Y$.
Let $\MM$ be the category of all maps from $M$ to $M'$ in $\MM_0$.

\begin{definition}{1}
\label{definition:ii-1}
  We say that $(\MM,p,\HH,\Gamma)$ is a category of homomorphisms \emph{with finite products} if $(\MM,p,\HH,\Gamma)$ is a category of homomorphisms such that $\Gamma$ is the groupoid of invertible elements of $\HH$ and if, for every pair $(s_1,s_2)\in\HH_0\times\HH_0$, there exists a unit $s_1\times s_2$ of $\HH$ that satisfies the following conditions:

  \begin{enumerate}
    \item[\normalfont(1)]
      $p(s_1\times s_2)=p(s_1)\times p(s_2)$.

    \item[\normalfont(2)]
      Let $p_i$ be the canonical projection from $p(s_1\times s_2)$ to $p(s_i)$, for $i=1,2$, i.e.
      \[
        p_i(x_1,x_2) = x_i
      \]
      for all $(x_1,x_2)\in p(s_1)\times p(s_2)$.
      Then
      \[
        \overline{p}_i
        = (s_i,p_i,s_1\times s_2)
        \in\HH.
      \]

    \item[\normalfont(3)]
      The relations $(s_i,h_i,s)\in\HH$ for $i=1,2$ imply that
      \[
        (s_1\times s_2,[h_1,h_2],s)
        \in\HH,
      \]
      where $[h_1,h_2](z)=(h_1(z),h_2(z))$ for all $z\in p(s)$.
  \end{enumerate}
\end{definition}

These conditions imply that the pair $(s_1,s_2)$ admits $(s_1\times s_2,\overline{p}_1,\overline{p}_2)$ as a product \cite{4} in $\HH$.

\begin{proposition}{1}
\label{proposition:ii-1}
  The product $s_1\times s_2$ is completely determined by the conditions of \cref{definition:ii-1}.
\end{proposition}

\begin{proof}
  Indeed, if $S$ is another product of $(s_1,s_2)$ satisfying conditions~(1), (2), and (3), then
  \[
    (S,p(s_1)\times p(s_2),s_1\times s_2)
    \in\Gamma
  \]
  whence $S=s_1\times s_2$, since $(\CC,p,\Gamma)$ is a species of structures.
\end{proof}

From now on, we take $(\MM,p,\HH,\Gamma)$ to be a category of homomorphisms with finite products.

\begin{proposition}{2}
\label{proposition:ii-2}
  Let $\overline{f}_i=(s'_i,f_i,s_i)\in\HH$, with $i=1,2$.
  Then
  \[
    (s'_1\times s'_2, f_1\times f_2, s_1\times s_2)
    \in\HH
  \]
  \oldpage{382}
  where
  \[
    (f_1\times f_2)(x_1\times x_2)
    = (f_1(x_1),f_2(x_2))
  \]
  for all $(x_1,x_2)\in p(s_1)\times p(s_2)$.
\end{proposition}

With the notation of \cref{proposition:ii-2}, we set
\[
  \overline{f}_1\times\overline{f}_2
  = (s'_1\times s'_2, f_1\times f_2, s_1\times s_2).
\]

\begin{proposition}{3}
\label{proposition:ii-3}
  For $s_i,s'_i\in\HH_0$, the relations
  \[
    s'_1\subs s_1
    \textand
    s'_2\subs s_2
  \]
  imply that
  \[
    s'_1\times s'_2
    \subs s_1\times s_2.
  \]
\end{proposition}

\begin{proof}
  Indeed,
  \[
    (s_1\times s_2, \iota\times\iota, s'_1\times s'_2)
    \in\HH;
  \]
  let $(s_1\times s_2,g,S)\in\HH$ be such that $g(p(S))\subset p(s'_1)\times p(s'_2)$.
  Since $(s_i,p_ig,S)\in\HH$ and $p_ig(p(S))\subset p(s'_i)$, where $i=1,2$, we also have that $(s'_i,p_ig,S)\in\HH$, whence
  \[
    (s'_1\times s'_2, [p_1g,p_2g], S)
    = (s'_1\times s'_2,g,S)
    \in\HH.
  \]
  Thus
  \[
    s'_1\times s'_2
    \subs s_1\times s_2.
    \qedhere
  \]
\end{proof}

\begin{proposition}{4}
\label{proposition:ii-4}
  The maps
  \[
    \begin{aligned}
      (\overline{f}_1,\overline{f}_2)
      &\longmapsto \overline{f}_1\times\overline{f}_2
    \\(\overline{f}_1,\overline{f}_2)
      &\longmapsto \overline{f}_2\times\overline{f}_1
    \end{aligned}
  \]
  are equivalent as functors from $\HH\times\HH$ to $\HH$.
  The maps
  \[
    \begin{aligned}
      (\overline{f}_1,\overline{f}_2,\overline{f}_3)
      &\longmapsto (\overline{f}_1\times\overline{f}_2)\times\overline{f}_3
    \\(\overline{f}_1,\overline{f}_2,\overline{f}_3)
      &\longmapsto \overline{f}_1\times(\overline{f}_2\times\overline{f}_3)
    \end{aligned}
  \]
  are equivalent as functors from $\HH\times\HH\times\HH$ to $\HH$.
\end{proposition}

\begin{proof}
  This follows from the properties of the functor-product \cite{3d}
  \[
    (f_1,f_2)
    \longmapsto f_1\times f_2
  \]
  in $\MM$.

  The first equivalence associates to $(s_1,s_2)\in\HH_0\times\HH_0$ the triple $(s_2\times s_1,\gamma,s_1\times s_2)$, where $\gamma(x_1,x_2)=(x_2,x_1)$.
  The second equivalence associates to $(s_1,s_2,s_3)$ the triple $(s_1\times(s_2\times s_3),\gamma',(s_1\times s_2)\times s_3)$, where $\gamma'((x_1,x_2),x_3)=(x_1,(x_2,x_3))$ for $x_i\in p(s_i)$.
\end{proof}

\begin{longcomm}{54.1}
  \cref{definition:i-1} means that $p$ creates canonical products;
  \cref{proposition:i-1}, \cref{proposition:i-2}, and \cref{proposition:i-4} are well-known properties of products;
  \cref{proposition:i-3} is a particular commutation between initial lifts (since products and $p$-injections are initial lifts, cf. Comment~146.1 on \cite{coll66}).
\end{longcomm}

\begin{definition}{2}
\label{definition:ii-2}
  We say that a subcategory $\HH'$ of $\HH$ is \emph{stable under products} if, for all $\overline{f}_i\in\HH'$, for $i=1,2$, we have that
  \[
    \overline{f}_1\times\overline{f}_2
    \in\HH'.
  \]
\end{definition}

Note that, even if $\Gamma$ is contained in $\HH'$, this definition does not imply that $(\MM,p,\HH',\Gamma)$ is a category of homomorphisms with finite products.

\oldpage{383}
\begin{example}
  $\Gamma$ is a subcategory of $\HH$ that is stable under products, with the inverse of $f_1\times f_2$, where $f_1,f_2\in\Gamma$, being $(f_1^{-1}\times f_2^{-1})$.
\end{example}



\subsection{Definition of structured categories and groupoids}
\label{section:ii.2}

We again denote by $(\MM,p_\FF,\FF,\FF_\gamma)$ the category of homomorphisms (\cref{section:i.3}) in which $\FF$ is the category of functors $(\overline{\CC}^\perp,F,\CC^\perp)$ such that $(\overline{C},F,\CC)\in\MM$, and $p_\FF$ is the functor
\[
  (\overline{\CC}^\perp,F,\CC^\perp)
  \longmapsto (\overline{\CC},F,\CC).
\]

We denote by $\HH'$ and $\HH''$ two subcategories of $\HH$ that contain $\Gamma$.

\begin{definition}{3}
\label{definition:ii-3}
  We define an \emph{$\HH(\HH',\HH'')$-structured category} (resp. \emph{$\HH((\HH',\HH'),\HH'')$-structured category}) to be a pair $(\CC^\smallbullet,s)$, where $\CC^\smallbullet\in\FF_0$, $s\in\HH_0$, and $p(s)=\CC$, that satisfies the following conditions:
  \begin{enumerate}
    \item[\normalfont(1)]
      There exists $s_0\in\HH_0$ such that $p(s_0)=\CC_0^\smallbullet$, $(s,\iota,s_0)\in\HH$, and $(s_0\times s_0,[\beta,\alpha],s)\in\HH'$ (resp. and $(s_0\alpha,s),(s_0,\beta,s)\in\HH'$).

    \item[\normalfont(2)]
      Let $C^\smallbullet\star\CC^\smallbullet$ be the class of pairs $(f',f)\in\CC\times\CC$ such that $f'\smallbullet f$ is defined, and let $\chi^\smallbullet$ be the map $(f',f)\mapsto f'\smallbullet f$, where $(f',f)\in\CC^\smallbullet\star\CC^\smallbullet$.
      Then there exists $s'\subs_p s\times s$ such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$ and
      \[
        (s,\chi^\smallbullet,s')
        \in\HH''.
      \]
  \end{enumerate}

  In particular, we refer to an $\HH(\HH,\HH)$-structured category as an \emph{$\HH$-structured category}.
\end{definition}

\begin{longcomm}{55.2}
  \emph{Structured categories and internal categories.}

  First remark that the notion given here is stricter than the one defined in \cite{coll57}, and it motivated the introduction of substructures.

  Let $(\CC^\smallbullet,s)$ be an $\HH$-structured category (more precisely called a \emph{$p$-structured category} later on).
  Then $s'$ is a substructure of $s\times s$ mapped by $p$ to the pullback of $(\alpha,\beta)$, so that (cf. \cite[Proposition~2.1]{coll109}) we have the pullback
  \[
    \begin{tikzcd}
      s \ar[d,swap,"\beta"]
      & s' \ar[l] \ar[d]
    \\s_0
      & s \ar[l,"\alpha"]
    \end{tikzcd}
  \]
  in $\HH$.
  It follows that $(\CC^\smallbullet,s)$ determines an internal category in $\HH$ (in the usual sense), with $s$ as its objects of morphisms and $s_0$ as its object of objects:
  \[
    \begin{tikzcd}
      s_0 \ar[r]
      & s \ar[l,bend left=30,"\alpha"] \ar[l,bend right=30,swap,"\beta"]
      & s' \ar[l,swap,"\kappa"]
    \end{tikzcd}
  \]
  Indeed, since $\CC^\smallbullet$ is a category and $p$ is faithful, the identity and associativity axioms are satisfied.
  Conversely, let
  \[
    \begin{tikzcd}
      S_0 \ar[r]
      & S \ar[l,bend left=30,"a"] \ar[l,bend right=30,swap,"b"]
      & S_2 \ar[l,swap,"k"]
    \end{tikzcd}
  \]
  be an internal category in $\HH$;
  then it "is" a $p$-structured category if and only if its image under $p$ is a usual category, i.e. if and only if $p(k)$ is the composition of a category on $p(S)$ with $p(a)$ and $p(b)$ as its source and target;
  such an internal category is called a \emph{concrete internal category}.

  Hence the category of $p$-structured categories may be identified with the category of concrete internal categories in $\HH$;
  if $p$ creates canonical pullbacks, it is equivalent (\cite{coll104}) to the category of all internal categories in $\HH$.

  Charles was motivated to introduce structured categories by the numerous examples (cf. Sections~5 to 6) he had already met: topological and differentiable categories or groupoids in \cite{coll28,coll50} in relation with differential geometry, ordered and local categories at the base of local structures theory \cite{coll47,coll53,coll55};
  double categories such as the double category of quartets \cite{coll55} and the 2-category of natural transformations \cite{coll52}.
  General theorems on structured categories are given here and in \cite{coll66,coll100};
  they are strengthened in \cite{coll109} where the 2-category of structured categories is studied, as well as its enrichments.
  Completion theorems for structured categories may be found in \cite{coll102}.

  In 1966 (cf. \cite{coll104,coll93}), Charles considered non-concrete internal categories, which he named \emph{generalised structured categories}.
  He defines them as models of the \emph{sketch of categories $\sigma_{\mathrm{Cat}}$}, which is the full subcategory of the opposite of its simplicial category $\Delta$ with objects $0$, $1$, $2$, $3$:
  \[
    \begin{tikzcd}[sep=huge]
      0
        \ar[r]
      & 1
        \ar[l,bend left=30,"\alpha"]
        \ar[l,bend right=30,swap,"\beta"]
        \ar[r,bend left=40,swap,"\gamma_\beta"]
        \ar[r,bend right=40,"\gamma_\alpha"]
      & 2
        \ar[l,near start,swap,"k"description]
        \ar[l,bend left=60,"\nu"]
        \ar[l,bend right=60,swap,"\nu'"]
      & 3
        \ar[l,bend left=30,swap,"\mu'"]
        \ar[l,bend right=30,"\mu"]
        \ar[l,bend left=50,"\kappa'"]
        \ar[l,bend right=50,swap,"\kappa"]
    \end{tikzcd}
  \]
  equipped with the cones
  \[
    \begin{tikzcd}
      {} \ar[d,swap,"\alpha"]
      & {} \ar[l,swap,"\nu'"] \ar[d,"\nu"]
    \\{}
      & {} \ar[l,"\beta"]
    \end{tikzcd}
    \textand
    \begin{tikzcd}
      {} \ar[d,swap,"\nu'"]
      & {} \ar[l,swap,"\mu"] \ar[d,"\mu'"]
    \\{}
      & {} \ar[l,"\nu"]
    \end{tikzcd}
  \]
  to be transformed into pullbacks.
  In \cite{coll113,coll115}, the results of \cite{109} on concrete internal categories are adapted to the general case.
  In fact, this theory led Charles to the notion of sketched structures developed from \cite{coll106} onwards.

  Bénabou used internal categories in the late sixties (unpublished) and certainly helped to propagate them.
  Several theses and papers written near us are wholly or partially devoted to structured or internal categories, e.g. Bourn~\cite{comm13}, Conduché~\cite{comm22}, Kempf~\cite{comm60}, Langbaum~\cite{comm63}, Lellahi~\cite{comm69}, and Vaugelade~\cite{comm97} (without mentioning those on examples).

  However, internal categories, so universally used today, seem to be really of interest to other schools only in the seventies (Gray~\cite{comm39}, Diaconescu~\cite{comm26}, \ldots).
  Though Grothendieck mentions the simplicial object associated to a category in \cite{comm42}, he prefers to work with the associated fibration (called a \emph{category object}) for avoiding pullbacks.
\end{longcomm}

\begin{proposition}{5}
\label{proposition:ii-5}
  For $(\CC^\smallbullet,s)$ to be an $\HH(\HH,\HH'')$ structured category, it is necessary and sufficient that $(\CC^\smallbullet,s)$ be an $\HH((\HH,\HH),\HH'')$-structured category.
\end{proposition}

\begin{proof}
  If $(\CC^\smallbullet,s)$ is $\HH((\HH,\HH),\HH'')$-structured, then
  \[
    (s_0\times s_0,[\beta,\alpha],s)
    \in\HH
  \]
  by definition of the product in $\HH$.
  Conversely, the relation
  \[
    (s_0\times s_0,[\beta,\alpha],s)
    \in\HH
  \]
  implies that
  \[
    (s_0,p_1[\beta,\alpha],s)
    = (s_0,\alpha,s)\in\HH
    \textand
    (s_0,\beta,s)
    \in\HH.
    \qedhere
  \]
\end{proof}

An $\HH(\HH',\HH'')$-structured category (resp. $\HH((\HH',\HH'),\HH'')$-structured category) is also an $\HH$-structured category.

\begin{proposition}{6}
\label{proposition:ii-6}
  Let $(\CC^\smallbullet,s)$ be an $\HH(\HH',\HH'')$-structured category (resp. $\HH((\HH',\HH'),\HH'')$-structured category).
  Then the element $s_0$ defined by condition~(1) of \cref{definition:ii-3} is a substructure of $s$; thus $s_0$ is also unique.
\end{proposition}

\begin{proof}
  \oldpage{384}
  Let $s_0$ be an element satisfying condition~(1) of \cref{definition:ii-3}, and let $(s,g,S)\in\HH$ be such that $g(p(s))\subset\CC_0^\smallbullet$.
  Then
  \[
    (s_0,\alpha,s)\smallbullet(s,g,S)
    = (s_0,\alpha g,S)\in\HH
  \]
  and also
  \[
    \alpha g(x)
    = g(x)
  \]
  for all $x\in p(S)$.
  Thus
  \[
    (s_0,g,S)\in\HH
    \textand
    s_0\subs_p s.
  \]
  It follows from the Corollary of \cref{theorem:i-1}~(\cref{section:i}) that $s_0$ is unique.
\end{proof}

\begin{definition}{4}
\label{definition:ii-4}
  We define an \emph{$\HH(\HH',\HH'')$-structured groupoid} (resp. \emph{$\HH((\HH',\HH'),\HH'')$-structured groupoid}) to be a pair $(G^\smallbullet,s)$ that satisfies the following conditions:
  \begin{enumerate}
    \item[\normalfont(1)]
      $G^\smallbullet$ is a groupoid.

    \item[\normalfont(2)]
      $(G^\smallbullet,s)$ is an $\HH(\HH',\HH'')$-structured category (resp. an $\HH((\HH',\HH'),\HH'')$-structured category).

    \item[\normalfont(3)]
      $(s,j,s)\in\HH$, where $j(g)=g^{-1}$ for all $g\in G$.
  \end{enumerate}
\end{definition}

From condition~(3) above it follows that $(s,j,s)\in\Gamma$.

\begin{definition}{5}
\label{definition:ii-5}
  We define an \emph{$\HH(\HH',\HH'')$-structured functor} (resp. $\HH((\HH',\HH'),\HH'')$-structured functor) to be a triple $((\CC_1^\smallbullet,s_1),F,(\CC^\smallbullet,s))$ that satisfies the following conditions:
  \begin{enumerate}
    \item[\normalfont(1)]
      $(C^\smallbullet,s)$ and $(\CC_1^\smallbullet,s_1)$ are $\HH(\HH',\HH'')$-structured categories (resp. $\HH((\HH',\HH'),\HH'')$-structured categories).

    \item[\normalfont(2)]
      $(C_1^\smallbullet,F,\CC^\smallbullet)\in\FF$ and $(s_1,F,s)\in\HH$.
  \end{enumerate}
\end{definition}

Let $\bHH(\HH',\HH'')_0$ be the class of all $\HH(\HH',\HH'')$-structured categories, and $\overline{\GG}(\HH',\HH'')_0$ the class of all $\HH(\HH',\HH'')$-structured groupoids.
Let $\bHH(\HH',\HH'')$ be the category of all $\HH(\HH',\HH'')$-structured functors, whose class of units is identified with $\bHH(\HH',\HH'')_0$.
We denote by:
\begin{itemize}
  \item[]
    $\overline{p}$ the map $((\CC_1^\smallbullet,s_1),F,(\CC^\smallbullet,s))\mapsto(\CC_1^\smallbullet,F,\CC^\smallbullet)$ from $\bHH(\HH',\HH'')$ to $\FF$;

  \item[]
    $\overline{p}_\HH$ the map $((\CC_1^\smallbullet,s_1),F,(\CC^\smallbullet,s))\mapsto(s_1,F,s)$ from $\bHH(\HH',\HH'')$ to $\HH$.
\end{itemize}

Let $\overline{\Gamma}$ be the groupoid of invertible elements of $\bHH(\HH',\HH'')$.
We define $\overline{\GG}(\HH',\HH'')$ (resp. $\overline{\Gamma}_\GG$) to be the full subcategory of $\bHH(\HH',\HH'')$ (resp. of $\overline{\Gamma}$) that has $\overline{\GG}(\HH',\HH'')_0$ as its class of units.

We define in an analogous way $\bHH((\HH',\HH'),\HH'')$ (resp. $\overline{\GG}((\HH',\HH'),\HH'')$) whose groupoid of invertible elements is denoted by $\overline{\Gamma}'$ (resp. $\overline{\Gamma}'_\GG$).

In particular, we write
\[
  \bHH(\HH,\HH)
  = \bHH
  = \bHH((\HH,\HH),\HH).
\]

\oldpage{385}
\begin{remark}
  The two functors $p$ and $p_\FF$ determine the induced category $p^*(\FF,p_\FF)$, equivalent to $p_\FF^*(\HH,p)$, whose elements (see \cite{3a}) are the pairs $(\overline{F},\overline{h})\in\FF\times\HH$ such that $p_\FF(\overline{F})=p(\overline{h})$.
  We can identify $\bHH(\HH',\HH'')$ with the full subcategory of $p^*(\FF,p_\FF)$ that has the $\bHH(\HH',\HH'')$-structured categories as its unite.
  We will show that $ $ is a subcategory of homomorphisms of the category of homomorphisms $p^*(\FF,p_\FF)$ over $\FF$.
  An arbitrary element of $p^*(\FF,p_\FF)$ might be referred to as a structured functor to $\HH$, in the vague sense.
\end{remark}

\begin{theorem}{1}
  \label{theorem:ii-1}
  $(\FF,\overline{p},\bHH(\HH',\HH''),\overline{\Gamma})$ is a category of homomorphisms, of which $(\FF,\overline{p}_\iota,\overline{\GG}(\HH',\HH''),\overline{\Gamma}_\GG)$ is a subcategory of homomorphisms.
\end{theorem}

\begin{longcomm}{57.1}
  For internal categories in a category admitting pullbacks, the corresponding result is:
  \begin{quote}
    \itshape
    Any isomorphism from the object of morphisms of an internal category extends into an isomorphism of internal categories.
  \end{quote}
\end{longcomm}

\begin{proof}
  The only thing to prove is that the conditions
  \[
    \overline{F}
    = \big((\CC_1^\smallbullet,s_1),F,(\CC^\smallbullet,s)\big)
    \in\overline{\Gamma}
    \textand
    (\CC^\smallbullet,\overline{s})
    \in\bHH(\HH',\HH'')_0
  \]
  imply the existence of $(\CC_1^\smallbullet,\overline{s}_1)\in\bHH(\HH',\HH'')_0$ such that $(\overline{s}_1,F,\overline{s})\in\HH$.
  Since $(\MM,p,\Gamma)$ is a species of structures, there exists $(\overline{s}_1,F,\overline{s})\in\Gamma$.
  We now show that $(\CC_1^\smallbullet,\overline{s}_1)\in\bHH(\HH',\HH'')_0$.
  Let $s_0\subs s$ and $s_0^1\subs s_1$ be such that $p(s_0)=\CC_0^\smallbullet$ and $p(s_0^1)=(\CC_1^\smallbullet)_0$.
  By \cref{proposition:i-6} in \cref{section:i}, we have that
  \[
    (s_0^1,F\iota,s_0)
    \in\Gamma
    \textand
    (s_0^1\times s_0^1,(F\times F)\iota,s_0\times s_0)
    \in\Gamma.
  \]
  It thus follows that there exists $\overline{s}_0^1\in\HH_0$ such that
  \[
    p(\overline{s}_0^1)
    = (\CC_1^\smallbullet)_0
    \textand
    (\overline{s}_0^1,F\iota,\overline{s}_0)
    \in\Gamma
  \]
  where $\overline{s}_0\subs\overline{s}$ and $p(\overline{s}_0)=\CC_0^\smallbullet$.
  Then $(\overline{s}_0^1\times\overline{s}_0^1,(F\times F)\iota,\overline{s}_0\times\overline{s}_0)\in\Gamma$ and, by \cref{proposition:i-6} in \cref{section:i}, $\overline{s}_0^1\subs\overline{s}_1$.
  Since $\HH'\supset\Gamma$, we thus deduce that
  \[
    (\overline{s}_0^1\times\overline{s}_0^1,[\beta,\alpha],\overline{s}_1)
    = \big(
      \overline{s}_0^1\times\overline{s}_0^1, (F\times F)\iota, \overline{s}_0\times\overline{s}_0
    \big)
    \smallbullet \big(
      \overline{s}_0\times\overline{s}_0, [\beta,\alpha], \overline{s}
    \big)
    \smallbullet \big(
      \overline{s}, F^{-1}, \overline{s}_1
    \big)
    \in \HH'.
  \]
  Let $s'\subs s\times s$ be such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$, and $s'_1\subs s_1\times s_1$ be such that $p(s'_1)=\CC_1^\smallbullet\star\CC_1^\smallbullet$;
  by \cref{proposition:i-7} in \cref{section:i}, we have that
  \[
    (s'_1,(F\times F)\iota,s')
    \in\Gamma.
  \]
  Let $\overline{s}'\subs\overline{s}\times\overline{s}$ be such that $p(\overline{s}')=p(s')$;
  there exists
  \[
    (\overline{s}'_1,(F\times F)\iota,\overline{s}')
    \in\Gamma
  \]
  such that
  \[
    p(\overline{s}'_1)
    = p(s'_1)
  \]
  and, by \cref{proposition:i-6} in \cref{section:i}, $\overline{s}'_1\subs\overline{s}_1\times\overline{s}_1$.
  Since $\HH''$ contains $\Gamma$,
  \[
    (\overline{s}_1,\chi_1^\smallbullet,\overline{s}'_1)
    = (\overline{s}_1,F,\overline{s})
    \smallbullet (\overline{s},\chi^\smallbullet,\overline{s}')
    \smallbullet(\overline{s}'_1,(F\times F)\iota,\overline{s}')^{-1}
    \in\HH''.
  \]
  Thus
  \[
    (\CC_1^\smallbullet,\overline{s}_1)
    \in\bHH(\HH',\HH'')_0
    \textand
    \big(
      (C_1^\smallbullet,\overline{s}_1), F, (\CC^\smallbullet,\overline{s})
    \big)
    \in\overline{\Gamma}.
    \qedhere
  \]
\end{proof}

\oldpage{386}

\begin{theorem}{2}
\label{theorem:ii-2}
  $(\FF,\overline{p},\bHH((\HH',\HH'),\HH''),\Gamma')$ is a category of homomorphisms.
\end{theorem}

\begin{proof}
  The proof is analogous to that of \cref{theorem:ii-1}.
\end{proof}

\begin{theorem}{3}
\label{theorem:ii-3}
  If $\HH$ is saturated over $\MM$, then $(\FF,\overline{p},\bHH((\HH',\HH'),\HH''),\Gamma')$, $(\MM,p_\FF\overline{p},\bHH(\HH',\HH''),\overline{\Gamma})$, and $(\HH,\overline{p}_\HH,\bHH(\HH',\HH''),\overline{\Gamma})$ are categories of homomorphisms.
\end{theorem}

\begin{definition}{6}
\label{definition:ii-6}
  We define an \emph{$\HH(\HH',\HH'')$-structured subcategory} (resp. \emph{$\HH(\HH',\HH'')$-structured subgroupoid}) of $(\CC^\smallbullet,s)\in\bHH(\HH',\HH'')_0$ to be a substructure of $(\CC^\smallbullet,s)$ in $(\FF,\overline{p},\bHH(\HH',\HH''),\overline{\Gamma})$ (resp. in $(\FF,\overline{p},\overline{\GG}(\HH',\HH''),\overline{\Gamma}_\GG)$).
  We similarly define an \emph{$\HH((\HH',\HH'),\HH'')$-structured subcategory} (resp. \emph{$\HH((\HH',\HH'),\HH'')$-structured subgroupoid}).
\end{definition}

Before studying the properties of structured categories and structured groupoids, we first give some examples.


\subsection{First examples}
\label{section:ii.3}

\subsubsection*{Example I}
\label{section:ii.3.i}

Let $(\MM,\theta,\tTT,\TT)$ be the category of homomorphisms defined in \cref{section:i.3}.

\begin{definition}{7}
\label{definition:ii-7}
  A $\tTT$-structured category (resp. $\tTT$-structured groupoid) is called a \emph{topological category} (resp. \emph{topological groupoid}).
\end{definition}

This definition agrees with that of \cite{3b}.
Indeed, if $(\CC^\smallbullet,s)$ is a topological category in the sense of \cite{3b}, then condition~(1) of the definition of a $\tTT$-structured category is satisfied by taking $s_0$ to be the topology on $\CC_0^\smallbullet$ induced by the given topology on $\CC$.
Furthermore, condition~(2) is satisfied, with $s'$ the topology on $\CC^\smallbullet\star\CC^\smallbullet$ induced by $s\times s$.
Thus the definition of a topological category can also be expressed as:

\begin{enumerate}
  \item[\normalfont(1)]
    The maps $\alpha$ and $\beta$ are continuous maps from $s$ to $s$.
  \item[\normalfont(2)]
    The map $\chi^\smallbullet$ is a continuous map from $s'$ to $s$, where $s'$ is the topology on $\CC^\smallbullet\star\CC^\smallbullet$ induced by $s\times s$.
\end{enumerate}

\begin{longcomm}{58.1}
  \emph{Topological categories} are formally introduced in \cite{coll50}, along with the more refined locally trivial categories (cf. Comment~25.1);
  in particular, conditions are given there which ensure that the groupoid of all morphisms be open.
  Their general theory is developed in \cite{coll92};
  \emph{microtransitive categories} (those where the map $f\mapsto(\beta(f),\alpha(f))$ is open) are characterised and equipped with a quasi-uniform structure (generalising the uniformities of a topological group);
  prolongations of topological and quasi-topological categories are also considered.

  Germs of topological categories and species of structures are studied in \cite{comm29} and in Bednarz~\cite{comm3}, with a view to applications in control theory.
\end{longcomm}

We will later see that the definition of an $\HH$-structured category can always be thus simplified in the case where $(\MM,p,\HH,\Gamma)$ is right solving.


\subsubsection*{Example II}
\label{section:ii.3.ii}

Let $\tCC^r$ (resp. $\CC_1^r$) be the category of $r$-differentiable maps (resp. of $r$-differentiable maps of locally constant rank) between $r$-differentiable manifolds;
$\tCC^r$ will be thought of as a category of homomorphisms over $\MM$.

\oldpage{387}

\begin{definition}{8}
\label{definition:ii-8}
  A $\tCC^r((\CC_1^1,\CC_1^r),\tCC^r)$-structured category (resp. $\tCC^r((\CC_1^1,\CC_1^r),\tCC^r)$-structured groupoid) is called an \emph{$r$-differentiable category} (resp. \emph{$r$-differentiable groupoid}).
\end{definition}

This definition agrees with that of \cite{3b}.

\begin{longcomm}{59.2}
  \emph{Differentiable categories} are formally defined in \cite{coll50}, where the groupoid of all isomorphisms is proved to be open.

  In a series of short (alas!) papers, Charles outlined modern foundations for differential geometry, based on differentiable categories and, in particular, on the differentiable category of jets and on its actions \cite{coll46,coll78,coll101,coll103,coll105,coll116}.
  Prolongations of manifolds and of differentiable actions, higher-order connections and their curvature and torsion, geometrical objects, Lie derivatives (cf. also the theory of Lie for differentiable groupoids done by Pradines~\cite{comm85a,comm85b,comm85c,comm85d}) are easily described in this elegant setting.

  It is not possible to mention here all the papers written on this subject (cf. Volume~I-2 of the collected works, in the same series as \cite{coll}).

  Recently, synthetic differential geometry has thrown a new light on Charles' conceptions, since they are well suited for generalisations to topoi (cf. Kock~\cite{comm61}, where jets become "maps").
  For instance, the requirement on the source and target of a differentiable category to be submersions finds it justification: it means that the category "is" an internal category in the Dubuc topos \cite{comm27}.

  Note that $\alpha$ and $\beta$ were asked to be submersions in order to ensure the existence of their pullback (and examples proved this condition to be meaningful).
  Ngo Van Qué gave a more general definition \cite{comm80}, which amounts to replacing the category of differentiable maps by its pullback completion over the category of sets;
  I mention it here since one of the motivations for \cite{coll107} came from thinking over his definition.
\end{longcomm}


\subsubsection*{Example III}
\label{section:ii.3.iii}

Let $\DD_0$ be the class of semigroups $D^\perp$ (i.e. $D$ is a class that we suppose to belong to $\MM_0$, endowed with an associative composition $\perp$).
Let $\DD$ be the class of homomorphisms $(D_1^\perp,f,D^\perp)$ between semigroups, i.e. where $f$ is a map from $D$ to $D_1$ such that
\[
  f(z'\perp z)
  = f(z')\perp f(z)
  \quad\text{for all $z,z'\in D$.}
\]
Then $\DD$ is a category of homomorphisms over $\MM$ with the projection $(D_1^\perp,f,D^\perp)\mapsto(D_1,f,D)$.

Note that $(D_1^\perp,\iota,D^\perp)\in\DD$ if and only if $D^\perp$ is a sub-semigroup of $D_1^\perp$ endowed with the composition law induced by $\perp$.

\begin{proposition}{7}
\label{proposition:ii-7}
  For $(\CC^\smallbullet,\perp)$ to be a $\DD$-structured category it is necessary and sufficient that $\perp$ be an everywhere-defined associated composition law on $\CC$, and that the map
  \[
    (g,f)
    \longmapsto g\perp f
  \]
  (where $g,f\in\CC$) be a functor from $\CC^\smallbullet\times\CC^\smallbullet$ to $\CC^\smallbullet$.
\end{proposition}

\begin{proof}
  Let $(\CC^\smallbullet,\perp)$ be a $\DD$-structured category;
  by the previous remark, $\CC_0^\smallbullet$ is a sub-semigroup of $\CC^\perp$, and so
  \[
    e\perp e'
    \in\CC_0^\smallbullet
  \]
  for $e,e'\in\CC_0^\smallbullet$.
  By the same remark, the conditions $(g,f),(g',f')\in\CC^\smallbullet\star\CC^\smallbullet$ imply that
  \[
    (g'\perp g,f'\perp f)
    = \big(
      (g',f')\perp(g,f)
    \big)
    \in\CC^\smallbullet\star\CC^\smallbullet;
  \]
  furthermore, since $\chi^\smallbullet$ is a homomorphism from the semigroup $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ to $\CC^\perp$, we have that
  \[
    (g'\perp g)\smallbullet(f'\perp f)
    = (g'\smallbullet f')\perp(g\smallbullet f)
  \]
  and the conditions of the proposition are satisfied.
  Conversely, suppose that the conditions are satisfied;
  since $(g,f)\mapsto g\perp f$ is a functor, we have that
  \[
    \alpha(g\perp f)
    =\alpha(g)\perp\alpha(f)
    \textand
    \beta(g\perp f)
    =\beta(g)\perp\beta(f);
  \]
  the conditions $(g,f),(g',f')\in\CC^\smallbullet\star\CC^\smallbullet$ imply that
  \[
    (g'\smallbullet f')\perp(g\smallbullet f)
    = (g'\perp g)\smallbullet(f'\perp f).
  \]
  Thus $(\CC^\smallbullet,\perp)$ is $\DD$-structured.
\end{proof}


\subsubsection*{Example IV}
\label{section:ii.3.iv}

\oldpage{388}
In \hyperref[section:ii.3.iii]{Example~III}, we can replace $\DD$ by the subcategory $\DD'$ (resp. $\DD''$) consisting of triples $(D_1^\perp,f,D^\perp)$ such that $D^\perp$ and $D_1^\perp$ are semigroups that admit a unit $1$ (resp. that admit an element $0$ such that $z\perp0=0\perp z=0$ for all $z\in D$), and such that we have $f(1)=1$ (resp. $f(0)=0$).

For $(\CC^\smallbullet,\perp)$ to be $\DD'$-structured (resp. $\DD''$-structured), it is necessary and sufficient that $(\CC^\smallbullet,\perp)$ be a $\DD$-structured category and that $1\in\CC_0^\smallbullet$ (resp. $0\in\CC_0^\smallbullet$).

A $\DD'$-structured category is a category with strictly associative multiplication, in the sense of Bénabou~\cite{comm1}

\begin{longcomm}{60.1}
  A $\DD'$-structured category is also called a \emph{strictly monoidal category}: the main example is the simplicial category, equipped with the ordinal sum.
  \emph{Monoidal categories} (MacLane~\cite{comm71}, Eilenberg–MacLane~\cite{comm32}) or \emph{multiplicative categories} (Bénabou~\cite{comm4}) are obtained by a "laxification" process: more precisely, they correspond to lax functors from the sketch of monoids
  \[
    \begin{tikzcd}[sep=huge]
      0
        \ar[r,"i"]
      & 1
        \ar[r,bend left=30,"i\times1"]
        \ar[r,bend right=30,swap,"1\times i"]
      & 2
        \ar[l,"k"description]
      & 3
        \ar[l,bend left=30,"1\times k"]
        \ar[l,bend right=30,swap,"k\times1"]
    \end{tikzcd}
  \]
  considered as a discrete 2-category to the 2-category of categories (cf. \cite{coll117}).
  Similar "laxifications" lead from 2-categories to bicategories, and from double categories to non-associative double categories (Bénabou~\cite{comm6}, Chamaillard~\cite{comm20}, Moreau~\cite{comm78}).
\end{longcomm}


\subsubsection*{Example V}
\label{section:ii.3.v}

Let $G$ be a semigroup.
Let $[G]$ be the category defined in the following way.\comm{60.2}{This $[G]$ is the \emph{category of $G$-spaces}.}

A unit of $[G]$ is a pair $(Z,\chi)$, where $Z\in\MM_0$ and $\chi$ is a map from $G\times Z$ to $Z$, i.e. an external composition law on $Z$, with the composite $\chi(\gamma,z)$, where $\gamma\in G$ and $z\in Z$, being denoted $\gamma\chi z$.
We suppose that the following axiom is satisfied:

\begin{enumerate}
  \item[\normalfont(1)]
    $(\gamma'\gamma)\chi z=\gamma'\chi(\gamma\chi z)$, where $\gamma,\gamma'\in G$ and $z\in Z$.
\end{enumerate}

A morphism of $[G]$ is a triple $((Z',\chi'),T,(Z,\chi))$, where $(Z,\chi),(Z',\chi')\in[G]_0$ and $(Z',T,Z)\in\MM$, and
\[
  \gamma\chi T(z)
  = T(\gamma\chi z)
\]
for all $z\in Z$ and $g\in G$.

Then $[G]$ is a category of homomorphisms over $\MM$ with the projection
\[
  \big(
    (Z',\chi'), T, (Z,\chi)
  \big)
  \longmapsto (Z',T,Z).
\]

Let $[G,0]$ be the full subcategory of $[G]$ whose units are the pairs $(Z,\chi)$ that further satisfy the following axiom:

\begin{enumerate}
  \item[\normalfont(2)]
    There exists $0\in Z$ such that $\gamma\chi0=0$ for all $\gamma\in G$.
\end{enumerate}

If $G$ admits a unit $1$, let $[G,1]$ be the full subcategory of $[G]$ whose units are the pairs $(Z,\chi)$ that satisfy the following axiom:

\begin{enumerate}
  \item[\normalfont(2\textquotesingle)]
    $1\chi z=z$ for all $z\in Z$.
\end{enumerate}

\begin{proposition}{8}
\label{proposition:ii-8}
  \comm{N.B.}{This proposition was incorrectly numbered ``Proposition 3'' in the original.}
  Let $\CC^\smallbullet$ be a category.
  For $(\CC^\smallbullet,\chi)$ to be a $[G]$-structured category (resp. a $[G,0]$-structured category, resp. a $[G,1]$-structured category), it is necessary and sufficient that the following conditions be satisfied:

  \begin{enumerate}
    \item[\normalfont(1)]
      $(C^\smallbullet,\chi)\in[G]_0$ (resp. $(C^\smallbullet,\chi)\in[G,0]_0$, resp. $(C^\smallbullet,\chi)\in[G,1]_0$).
    \item[\normalfont(2)]
      $(\gamma\chi\CC_0^\smallbullet)\subset\CC_0^\smallbullet$ for all $\gamma\in G$.
    \item[\normalfont(3)]
      If $(g,f)\in\CC^\smallbullet\star\CC^\smallbullet$, then
      \[
        (\gamma\chi g,\gamma\chi f)
        \in\CC^\smallbullet\star\CC^\smallbullet
      \]
      for all $\gamma\in G$, and
      \[
        (\gamma\chi g)\smallbullet(\gamma\chi f)
        = \gamma\chi(g\smallbullet f).
      \]
  \end{enumerate}
\end{proposition}

\oldpage{389}

\begin{definition}{9}
\label{definition:ii-9}
  A $[G]$-structured category is called a \emph{category with operator semigroup $G$}.
  If $G$ is a group, a $[G,1]$-structured category is called a \emph{category with operator group $G$}.
\end{definition}

\begin{examples}
  \begin{enumerate}
    \item[\normalfont(1)]
      Let $(\CC^+,\chi)$ be a category with operator semigroup $G$.
      If $\CC^+$ is an abelian group and $\CC^\smallbullet=G$ is commutative, then $(\CC^+,\chi)$ is a commutative ring.
    \item[\normalfont(2)]
      Let $E$ be a topological space and $G$ a group of operators on $E$ such that, for all $\gamma\in G$, the map
      \[
        \widetilde{\gamma}\colon x
        \longmapsto \gamma x
      \]
      (where $x\in E$) is a homeomorphism of $E$.
      The category of local jets of continuous maps from $E$ to $E$ is then a category with operator group $G$, with the composition $\gamma j_x^\lambda f$ being $(j_{x'}^\lambda\widetilde{\gamma})(j_x^\lambda f)(j_{x'}^\lambda\widetilde{\gamma})^{-1}$, where $x'=f(x)$.
  \end{enumerate}
\end{examples}


\subsection{Double categories}
\label{section:ii.4}

Let $(\MM,p_\FF,\FF,\FF_\gamma)$ be the category of homomorphisms defined in \cref{section:i}.

\begin{definition}{10}
\label{definition:ii-10}
  An $\FF$-structured category is called a \emph{double category}.
\end{definition}

\begin{proposition}{9}
\label{proposition:ii-9}
  Let $\CC^\smallbullet$ be a category, and $\CC_1$ a subclass of $\CC$.
  The relation $(\CC^\smallbullet,\iota,\CC_1^\perp)\in\FF$ implies that $\CC_1^\perp$ is a subcategory of $\CC^\smallbullet$, endowed with the composition law induced by that of $\CC^\smallbullet$.
\end{proposition}

\begin{proof}
  Let $f,f'\in\CC_1$;
  we have that $\alpha^\perp(f)=\alpha^\smallbullet(f)$ and, if $f'\perp f$ is defined, that $f'\perp f=f'\smallbullet f$ since $\iota$ is a functor.
  Then, if $f'\smallbullet f$ is defined, we have that
  \[
    \alpha^\perp(f')
    = \alpha^\smallbullet(f')
    = \beta^\smallbullet(f')
    = \beta^\perp(f)
  \]
  whence $f'\perp f$ is defined, and
  \[
    f'\perp f
    = f'\smallbullet f
    \in\CC_1.
  \]
\end{proof}

\begin{corollary}
  For $(\CC^\smallbullet,\CC^\perp)$ to be a double category. it is necessary and sufficient that the following conditions be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $\CC^\perp$ is a category of which $\CC_0^\smallbullet$ is a subcategory $(\CC_0^\smallbullet)^\perp$.
    \item[\normalfont(2)]
      $\alpha^\smallbullet$ and $\beta^\smallbullet$ are functors from $\CC^\perp$ to $(\CC_0^\smallbullet)^\perp$.
    \item[\normalfont(3)]
      $\CC^\smallbullet\star\CC^\smallbullet$ is a subcategory $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ of $\CC^\perp\times\CC^\perp$, and $\chi^\smallbullet$ is a functor from $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ to $\CC^\perp$.
  \end{enumerate}
\end{corollary}

Recall that the composition law in the product category $\CC^\perp\times\CC^\perp$ is defined by
\[
  \big(
    (g',g), (f',f)
  \big)
  \longmapsto (g'\perp f',g\perp f)
\]
if and only if $g\perp f$ and $g'\perp f'$ are defined in $\CC^\perp$.
In $\CC^\perp\times\CC^\perp$, we have
\[
  \alpha^\perp(g',g)
  =\big(
    \alpha^\perp(g'), \alpha^\perp(g)
  \big)
  \textand
  \beta^\perp(g',g)
  =\big(
    \beta^\perp(g'), \beta^\perp(g)
  \big).
\]

\oldpage{390}

\begin{theorem}{4}
\label{theorem:ii-4}
  Let $(\CC^\smallbullet,\CC^\perp)$ be a double category.
  Then $(\CC^\perp,\CC^\smallbullet)$ is also a double category.
\end{theorem}

\begin{proof}
  Let $z^\perp,z'^\perp\in\CC_0^\perp$ be such that $(z'^\perp,z^\perp)\in\CC^\smallbullet\star\CC^\smallbullet$.
  Since $(z'^\perp,z^\perp)$ is a unit of $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$, and since $\chi^\smallbullet$ is a functor from $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ to $\CC^\perp$, we have that $z'^{\perp}\smallbullet z^\perp\in\CC_0^\perp$.
  Since $\alpha^\smallbullet$ is a functor from $\CC^\perp$ to $(\CC_0^\smallbullet)^\perp$, we have that $\alpha^\smallbullet(z^\perp)\in\CC_0^\perp$;
  similarly, $\beta^\smallbullet(z^\perp)\in\CC_0^\perp$.
  Thus $\CC_0^\perp$ is a subcategory $(\CC_0^\perp)^\smallbullet$ of $\CC^\smallbullet$.
  Let $(f',f)\in\CC^\smallbullet\star\CC^\smallbullet$;
  then $(\alpha^\perp(f'),\alpha^\perp(f))\in\CC^\smallbullet\star\CC^\smallbullet$, since $\CC^\smallbullet\star\CC^\smallbullet$ is a subcategory of $\CC^\perp\times\CC^\perp$ and, since $\chi^\smallbullet$ is a functor, we have that
  \[
    \begin{aligned}
      \alpha^\perp(f')\smallbullet\alpha^\perp(f)
      &= \chi^\smallbullet\big(
        \alpha^\perp(f'), \alpha^\perp(f)
      \big)
    \\&= \chi\big(
        \alpha^\perp(f',f)
      \big)
    \\&= \alpha^\perp(\chi^\smallbullet(f',f))
    \\&= \alpha^\perp(f'\smallbullet f).
    \end{aligned}
  \]
  Suppose that $(g,f),(g',f')\in\CC^\perp\star\CC^\perp$ and $(g',g),(f',f)\in\CC^\smallbullet\star\CC^\smallbullet$.
  By condition~(3) of the Corollary to \cref{proposition:ii-9}, we have that
  \[
    (g',g)\perp(f',f)
    = (g'\perp f',g\perp f)
    \in\CC^\smallbullet\star\CC^\smallbullet
  \]
  and
  \[
    (g'\perp f')\smallbullet(g\perp f)
    = (g'\smallbullet g\perp f'\smallbullet f).
  \]
  We thus deduce that $\CC^\perp\star\CC^\perp$ is a subcategory of $\CC^\smallbullet\times\CC^\smallbullet$, and that the map $(g,f)\mapsto g\perp f$, where $(g,f)\in\CC^\perp\star\CC^\perp$, is a functor from $(\CC^\perp\star\CC^\perp)^\smallbullet$ to $\CC^\smallbullet$.
  This proves that $(\CC^\perp,\CC^\smallbullet)$ is a double category.
\end{proof}

\begin{proposition}{10}
\label{proposition:ii-10}
  If $(\CC^\smallbullet,\CC^\perp)$ is a double category, then
  \[
    \CC_0^\smallbullet\cap\CC_0^\perp
    = (\CC_0^\smallbullet)_0^\perp
    = (\CC_0^\perp)_0^\smallbullet.
  \]
\end{proposition}

\begin{proof}
  Let $f\in\CC$;
  since $\alpha^\smallbullet$ and $\beta^\smallbullet$ are functors from $\CC^\perp$ to $\CC^\perp$, we have the equations
  \[
    \begin{array}{cc}
      \alpha^\smallbullet(\alpha^\perp(f))
      = \alpha^\perp(\alpha^\smallbullet(f));
      & \alpha^\smallbullet(\beta^\perp(f))
      = \beta^\perp(\alpha^\smallbullet(f));
    \\\beta^\smallbullet(\alpha^\perp(f))
      = \alpha^\perp(\beta^\smallbullet(f));
      & \beta^\smallbullet(\beta^\perp(f))
      = \beta^\perp(\beta^\smallbullet(f)).
    \end{array}
  \]
  Thus $(\CC_0^\smallbullet)_0^\perp=(\CC_0^\perp)_0^\smallbullet$.
  If $z\in\CC_0^\perp\cap\CC_0^\smallbullet$, then we see that
  \[
    z
    = \alpha^\smallbullet(z)
    = \alpha^\perp(\alpha^\smallbullet(z))
    \in (\CC_0^\smallbullet)_0^\perp.
  \]
\end{proof}

\begin{definition}{11}
\label{definition:ii-11}
  The class $(\CC_0^\smallbullet)_0^\perp$ is called the \emph{class of vertices} of the double category $(\CC^\smallbullet,\CC^\perp)$, and denoted by $\CC_{00}$.
\end{definition}

\begin{longcomm}{62.3}
  \emph{2-categories} are those double categories $(\CC^\smallbullet,\CC^\perp)$ for which the objects of $\CC^\perp$ are also the objects of $\CC^\smallbullet$, so that $\CC_{00}=\CC_0^\perp$.
  They are alternatively defined as categories enriched in the cartesian category of categories (by the general result of \cite[Appendix]{coll120}).
  The main example is the 2-category of natural transformations \cite{coll52}, from which all double categories may be constructed (cf. \cite[Comment~105.1]{coll64}).
\end{longcomm}

\oldpage{391}

From the above, if $(\CC^\smallbullet,\CC^\perp)$ is a double category, then the following conditions are satisfied:
\begin{enumerate}
  \item[\normalfont(a)]
    $\CC^\smallbullet$ is a category.
  \item[\normalfont(b)]
    $\CC^\perp$ is a category.
  \item[\normalfont(c)]
    $\alpha^\smallbullet$ and $\beta^\smallbullet$ (resp. $\alpha^\perp$ and $\beta^\perp$) are functors from $\CC^\perp$ to $\CC^\perp$ (resp. from $\CC^\smallbullet$ to $\CC^\smallbullet$).
  \item[\normalfont(d)]
    \emph{Axiom of permutability.}
    If the composites $(g'\smallbullet g)\perp(f'\smallbullet f)$ and $(g'\perp f')\smallbullet(g\perp f)$ are defined, then
    \[
      (g'\smallbullet g)\perp(f'\smallbullet f)
      = (g'\perp f')\smallbullet(g\perp f).
    \]
  \item[\normalfont(e)]
    $\CC^\perp\star\CC^\perp$ is a subcategory $(\CC^\perp\star\CC^\perp)^\smallbullet$ of $\CC^\smallbullet\times\CC^\smallbullet$, and the map $\chi^\perp$ is a functor from $(\CC^\perp\star\CC^\perp)^\smallbullet$ to $\CC^\smallbullet$.
  \item[\normalfont(f)]
    $\CC^\smallbullet\star\CC^\smallbullet$ is a subcategory $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ of $\CC^\perp\times\CC^\perp$, and the map $\chi^\smallbullet$ is a functor from $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ to $\CC^\perp$.
  \item[\normalfont(g)]
    $\CC_0^\smallbullet$ (resp. $\CC_0^\perp$) is stable under $\perp$ (resp. under $\smallbullet$).
  \item[\normalfont(h)]
    If the composites $g'\smallbullet g$, $f'\smallbullet f$, $g'\perp f'$, and $g\perp f$ are defined, then
    \[
      (g'\smallbullet g)\perp(f'\smallbullet f)
      \textand
      (g'\perp f')\smallbullet(g\perp f)
    \]
    are defined and are equal to one another.
  \item[\normalfont(i)]
    For all $f\in\CC$, we have
    \[
      \begin{array}{cc}
        \alpha^\smallbullet(\alpha^\perp(f))
        = \alpha^\perp(\alpha^\smallbullet(f));
        & \alpha^\smallbullet(\beta^\perp(f))
        = \beta^\perp(\alpha^\smallbullet(f));
      \\\beta^\smallbullet(\alpha^\perp(f))
        = \alpha^\perp(\beta^\smallbullet(f));
        & \beta^\smallbullet(\beta^\perp(f))
        = \beta^\perp(\beta^\smallbullet(f)).
      \end{array}
    \]
\end{enumerate}

\begin{theorem}{5}
\label{theorem:ii-5}
  Let $\CC$ be a class endowed with two compositions laws, $\smallbullet$ and $\perp$;
  for $(\CC^\smallbullet,\CC^\perp)$ to be a double category, it is necessary and sufficient that one of the three systems of above axioms be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      (a), (b), (c), (d).
    \item[\normalfont(2)]
      (a), (b), (e), (f), (i).
    \item[\normalfont(3)]
      (a), (b), (g), (h), (i).
  \end{enumerate}
\end{theorem}

\begin{proof}
  We first show that the system of axioms (1) implies that $(\CC^\smallbullet,\CC^perp)$ is a double category.
  Let $z^\smallbullet,z'^\smallbullet\in\CC_0^\smallbullet$;
  if $z'^\smallbullet\perp z^\smallbullet$ is defined, then, since $\alpha^\smallbullet$ is a functor,
  \[
    \begin{aligned}
      \alpha^\smallbullet(z'^\smallbullet\perp z^\smallbullet)
      &= \alpha^\smallbullet(z'^\smallbullet)\perp\alpha^\smallbullet(z^\smallbullet)
    \\&= z'^\smallbullet\perp z^\smallbullet
    \in \CC_0^\smallbullet;
    \end{aligned}
  \]
  since $\alpha^\perp$ and $\beta^\perp$ are functors, we have that $\alpha^\perp(z^\smallbullet)\in\CC_0^\smallbullet$ and $\beta^\perp(z^\smallbullet)\in\CC_0^\smallbullet$;
  consequently, $\CC_0^\smallbullet$ is a subcategory of $\CC^\perp$.
  For all $f\in\CC$, we have that
  \[
    \alpha^\smallbullet(\alpha^\perp(f))=\alpha^\perp(\alpha^\smallbullet(f))
  \]
  since $\alpha^\smallbullet$ is a functor;
  similarly, the other equations in axiom~(i) are also consequences of axiom~(c).
  Let $(f',f)\in\CC^\smallbullet\star\CC^\smallbullet$;
  from (i), it follows that
  \[
    \begin{aligned}
      \alpha^\smallbullet(\alpha^\perp(f'))
      &= \alpha^\perp(\alpha^\smallbullet(f'))
    \\&= \alpha^\perp(\beta^\smallbullet(f))
    \\&= \beta^\smallbullet(\alpha^\perp(f))
    \end{aligned}
  \]
  \oldpage{392}
  and so
  \[
    (\alpha^\perp(f'),\alpha^\perp(f))\in\CC^\smallbullet\star\CC^\smallbullet;
  \]
  in a similar way, we find that
  \[
    (\beta^\perp(f'),\beta^\perp(f))\in\CC^\smallbullet\star\CC^\smallbullet.
  \]
  Let $(g',g)\in\CC^\smallbullet\star\CC^\smallbullet$ be such that $(g',f'),(g,f)\in\CC^\perp\star\CC^\perp$;
  by (c),
  \[
    \begin{aligned}
      \alpha^\smallbullet(g'\perp f')
      &= \alpha^\smallbullet(g')\perp\alpha^\smallbullet(f')
    \\&= \beta^\smallbullet(g)\perp\beta^\smallbullet(f)
    \\&= \beta^\smallbullet(g\perp f)
    \end{aligned}
  \]
  and so $(g'\perp f',g\perp f)\in\CC^\smallbullet\star\CC^\smallbullet$.
  We thus deduce that $\CC^\smallbullet\star\CC^\smallbullet$ is a subcategory of $\CC^\perp\times\CC^\perp$.
  Also
  \[
    \begin{aligned}
      \alpha^\perp(g'\smallbullet g)
      &= \alpha^\perp(g')\smallbullet\alpha^\perp(g)
    \\&= \beta^\perp(f')\smallbullet\beta^\perp(f)
    \\&= \beta^\perp(f'\smallbullet f)
    \end{aligned}
  \]
  implies that $(g'\smallbullet g,f'\smallbullet f)\in\CC^\perp\star\CC^\perp$ and, by (d), that $\chi^\smallbullet$ is a functor from $(\CC^\smallbullet\star\CC^\smallbullet)^\perp$ to $\CC^\perp$.
  Thus $(\CC^\smallbullet,\CC^\perp)$ is a double category.

  Now suppose that the system of axioms (2) is satisfied;
  if $z^\smallbullet\in\CC_0^\smallbullet$ then
  \[
    \alpha^\perp(z^\smallbullet)
    =\alpha^\smallbullet(\alpha^\perp(z^\smallbullet))
    \in\CC_0^\smallbullet;
  \]
  if $z'^\smallbullet\in\CC_0^\smallbullet$ and $(z'^\smallbullet,z^\smallbullet)\in\CC^\perp\star\CC^\perp$, then the functor $\chi^\perp$ sends the unit $(z'^\smallbullet,z^\smallbullet)$ of $(\CC^\perp\star\CC^\perp)^\smallbullet$ to $(z'^\smallbullet\perp z^\smallbullet)\in\CC^\perp\star\CC^\perp$;
  thus $\CC_0^\smallbullet$ is a subcategory of $\CC^\perp$.
  If $z^\perp\in\CC_0^\perp$, then
  \[
    \alpha^\smallbullet(z^\perp)
    = \alpha^\perp(\alpha^\smallbullet(z^\perp))
    \in \CC_0^\perp.
  \]
  Let $(g,f)\in\CC^\perp\star\CC^\perp$;
  by (e), we have that $(\alpha^\smallbullet(g),\alpha^\smallbullet(f))\in\CC^\perp\star\CC^\perp$, and
  \[
    \begin{aligned}
      \alpha^\smallbullet(g\perp f)
      &= \alpha^\smallbullet(\chi^\perp(g,f))
    \\&= \chi^\perp(\alpha^\smallbullet(g),\alpha^\smallbullet(f))
    \\&= \alpha^\smallbullet(g)\perp\alpha^\smallbullet(f),
    \end{aligned}
  \]
  i.e. $\alpha^\smallbullet$ (and, for the same reason, $\beta^\smallbullet$) is a functor from $\CC^\perp$ to $(\CC_0^\smallbullet)^\perp$.
  Taking (f) into account, this shows that $(\CC^\smallbullet,\CC^\perp)$ is a double category.

  Finally, suppose that the system of axioms (3) is satisfied.
  Let $(g,f)\in\CC^\perp\star\CC^\perp$;
  as above, we can prove that (i) implies that $(\alpha^\smallbullet(g),\alpha^\smallbullet(f))\in\CC^\perp\star\CC^\perp$;
  by (h), the composite $(g\perp f)\smallbullet(\alpha^\smallbullet(g)\perp\alpha^\smallbullet(f))$ is defined, and, since $\CC_0^\smallbullet$ is stable under $\perp$, we see that
  \[
    \alpha^\smallbullet(g)\perp\alpha^\smallbullet(f)
    = \alpha^\smallbullet(g\perp f).
  \]
  We thus deduce that (c) is satisfied;
  furthermore, (h) implies (d);
  thus the system of axioms (1) is satisfied, and $(\CC^\smallbullet,\CC^\perp)$ is a double category, by the first part of this proof.
\end{proof}

\begin{remarks}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      If all the elements of the form $z_2^\smallbullet\perp z_1^\smallbullet$ with $z_i^\smallbullet\in\CC_0^\smallbullet$ (resp. of the form $z_2^\perp\smallbullet z_1^\perp$ with $z_i^\perp\in\CC_0^\perp$) are regular \cite{3a} in $\CC^\smallbullet$ (resp. in $\CC^\perp$), then the axioms (a), (b), (h), and (i) suffice to imply that $(\CC^\smallbullet,\CC^\perp)$ is a double category.
      Indeed, from (h) and (i) it follows that
      \[
        (z_2^\smallbullet\perp z_1^\smallbullet)\smallbullet(z_2^\smallbullet\perp z_1^\smallbullet)
        = z_2^\smallbullet\perp z_1^\smallbullet
      \]
      whence
      \[
        \alpha^\smallbullet(z_2^\smallbullet\perp z_1^\smallbullet)
        = z_2^\smallbullet\perp z_1^\smallbullet
        \in\CC_0^\smallbullet
      \]
      which proves that (g) is satisfied.

    \item[\normalfont(2)]
      \oldpage{393}
      Even though the composition laws $\smallbullet$ and $\perp$ have properties of symmetry, it is simpler to suppose that the data of the double category $(\CC^\smallbullet,\CC^\perp)$ also includes the order in which we consider the composition laws;
      thus $(\CC^\smallbullet,\CC^\perp)$ means that $\CC^\smallbullet$ is the category that is structured in $\FF$ by $\CC^\perp$.
  \end{enumerate}
\end{remarks}

A \emph{double subcategory} of the double category $(\CC^\smallbullet,\CC^\perp)$ is a subclass $\CC_1$ of $\CC$ that is a subcategory of both $\CC^\smallbullet$ and $\CC^\perp$;
then $(\CC_1^\smallbullet,\CC_1^\perp)$ is a double category.

An $\FF$-structured functor is called a \emph{double functor}.
By definition, a double functor $\overline{F}=((\CC_1^\smallbullet,\CC_1^\perp),F,(\CC^\smallbullet,\CC^\perp))$ is defined by a map $F$ from $\CC$ to $\CC_1$ such that $(\CC_1^\smallbullet,F,\CC^\smallbullet)$ and $(\CC_1^\perp,F,\CC^\perp)$ are functors.
By \cref{theorem:ii-1}, double functors form a category of homomorphisms $(\FF,\overline{p_\FF},\overline{\FF},\overline{\FF}_\gamma)$, where
\[
  \overline{p_\FF}(\overline{F})
  = (\CC_1^\smallbullet,F,\CC^\smallbullet);
\]
by \cref{theorem:ii-2}, they also form a category of homomorphisms $(\FF,\overline{p_\FF}',\overline{\FF},\overline{\FF}_\gamma)$, where
\[
  \overline{p_\FF}'(F)
  = (\overline{p_\FF})_\FF(\overline{F})
  = (\CC_1^\perp,F,\CC^\perp).
\]

\emph{Double categories of quadruples. ---}
Let $\CC_1$ and $\CC_2$ be categories with the same class $\Delta$ of units.
Let $\sq(\CC_2,\CC_1)$ be the class of quadruples $(f'_2,f'_1,f_1,f_2)$, with $f'_i,f_i\in\CC_i$, such that
\[
  \begin{array}{ll}
    \alpha(f_1)=\alpha(f_2),
    & \alpha(f'_1)=\beta(f_2),
  \\\beta(f_1)=\alpha(f'_2),
    & \beta(f'_1)=\beta(f'_2).
  \end{array}
\]

On $\sq(\CC_2,\CC_1)$, we define two composition laws:
\[
  \begin{cases}
    (\overline{f}'_2,\overline{f}'_1,\overline{f}_1,\overline{f}_2)
    \vmult (f'_2,f'_1,f_1,f_2)
    = (\overline{f}'_2,\overline{f}'_1\smallbullet f'_1,\overline{f}_1\smallbullet f_1,f_2)
    &\mbox{if and only if $\overline{f}_2=f'_2$}
  \\(\overline{f}'_2,\overline{f}'_1,\overline{f}_1,\overline{f}_2)
    \hmult (f'_2,f'_1,f_1,f_2)
    = (\overline{f}'_2\smallbullet f'_2,\overline{f}'_1,f_1,\overline{f}_2\smallbullet f_2)
    &\mbox{if and only if $\overline{f}_1=f'_1$.}
  \end{cases}
\]

\begin{definition}{12}
\label{definition:ii-12}
  The composition law $\vmult$ on $\sq(\CC_2,\CC_1)$ defined above is called \emph{longitudinal multiplication}, and $\hmult$ is called \emph{lateral multiplication}.
\end{definition}

\begin{proposition}{11}
\label{proposition:ii-11}
  $\sq(\CC_2,\CC_1)$, endowed with longitudinal and lateral multiplication, is a double category.\comm{65.1}{This category is already considered in \cite[Appendix]{coll55}, but here again it is more intuitive to speak of the horizontal and vertical compositions.}
\end{proposition}

The longitudinal category is denoted $\vsq(\CC_2,\CC_1)$, and the lateral category $\hsq(\CC_2,\CC_1)$;
the source and target maps for the longitudinal category are denoted $\alpha^\vsqbox$ and $\beta^\vsqbox$, and for the lateral category $\alpha^\hsqbox$ and $\beta^\hsqbox$, respectively.
The class of vertices of the double category $\sq(\CC_2,\CC_1)$ can be identified with $\Delta$.

\begin{definition}{13}
\label{definition:ii-13}
  \oldpage{394}
  Given double categories $(\CC^\smallbullet,\CC^\perp)$ and $(\CC_1^\smallbullet,\CC_1^\perp)$, we say that $(\CC_1^\smallbullet,\CC_1^\perp)$ is a \emph{quotient double category of $(\CC^\smallbullet,\CC^\perp)$} if there exists an equivalence relation $\rho$ on $\CC$ such that $\CC_1^\smallbullet$ (resp. $\CC_1^\perp$) is identified with the quotient\comm{66.1}{In agreement with the theory of quotients \cite{coll66}, ``quotient category'' should be replaced by ``strict quotient category''. Quotient double categories are constructed in \cite[Corollary, Theorem~21-II]{coll66}, and more general quasi-quotient double categories are described in \cite[Section~8]{coll100}.} category \cite{3e} of $\CC^\smallbullet$ (resp. of $\CC^\perp$) by $\rho$.
\end{definition}

In particular, a theorem in \cite{3a} implies the following.
Let $\pi$ be a double functor from a double category $(\CC^\smallbullet,\CC^\perp)$ to a double category $(\CC_1^\smallbullet,\CC_1^\perp)$.
Let $\rho_\pi$ be the equivalence relation on $\CC$ defined by
\[
  f\sim f'
  \quad\text{if and only if}\quad
  \pi(f)=\pi(f').
\]

For $(\CC_1^\smallbullet,\CC_1^\perp)$ to be identified with the quotient double category of $(\CC^\smallbullet,\CC^\perp)$ by $\rho_\pi$, it is necessary and sufficient that $\pi$ satisfy the following conditions:
\begin{enumerate}
  \item[\normalfont(1)]
    If $g_1\smallbullet f_1$ is defined in $\CC_1^\smallbullet$, then there exist $g,f\in\CC$ such that $g\smallbullet f$ is defined, and $g_1=\pi(g)$ and $f_1=\pi(f)$.
  \item[\normalfont(2)]
    If $g_1\perp f_1$ is defined in $\CC_1^\perp$, then there exist $g,f\in\CC$ such that $g\perp f$ is defined, and $g_1=\pi(g)$ and $f_1=\pi(f)$.
\end{enumerate}

\begin{theorem}{6}
\label{theorem:ii-6}
  A double category $(\CC^\smallbullet,\CC^\perp)$ admits a subcategory of the double category $\sq(\CC_0^\smallbullet,\CC_0^\perp)$ as a quotient, where $\CC_0^\smallbullet$ (resp. $\CC_0^\perp$) is endowed with its structure as a subcategory of $\CC^\perp$ (resp. $\CC^\smallbullet$).
\end{theorem}

\begin{proof}
  The map
  \[
    c\colon f
    \longmapsto \big(
      \beta^\smallbullet(f), \beta^\perp(f), \alpha^\perp(f), \alpha^\smallbullet(f)
    \big)
  \]
  is a double functor from $\CC$ to $\sq(\CC_0^\smallbullet,\CC_0^\perp)$ that satisfies the conditions above.
\end{proof}

\begin{definition}{14}
\label{definition:ii-14}
  With the above notation, the element $c(f)$ is called the \emph{square of $f$ in $\CC$}.
\end{definition}

Let $\CC$ be a category.
Recall \cite{3a} that a \emph{quartet} of $\CC$ is a quadruple $(f'_2,f'_1,f_1,f_2)\in\sq(\CC,\CC)$ such that
\[
  f'_2\smallbullet f_1
  = f'_1\smallbullet f_2.
\]

Let $\sq\CC$ be the subclass of $\sq(\CC,\CC)$ consisting of quartets of $\CC$.

\begin{proposition}{12}
\label{proposition:ii-12}
  $\sq\CC$ is a double subcategory of $\sq(\CC,\CC)$.
\end{proposition}

Let $\overline{F}=(\CC_1,F,\CC)\in\FF$;
this functor extends to a double functor
\[
  \sq\overline{F}
  = \big(
    (\vsq\CC_1,\hsq\CC_1), \sq F, (\vsq\CC,\hsq\CC)
  \big)
\]
where $\sq F$ is the map defined by
\[
  \sq F(f'_2,f'_1,f_1,f_2)
  = \big(
    F(f'_2), F(f'_1), F(f_1), F(f_2)
  \big).
\]

\oldpage{395}
The map $\sq\colon\overline{F}\mapsto\sq\overline{F}$ is a functor from $\FF$ to $\overline{\FF}$.
We denote by $\hsq$ (resp. $\vsq$) the functor from $\FF$ to $\FF$ given by
\[
  \begin{aligned}
    \overline{p_\FF}\smallbullet\sq
    &\colon \overline{F}
    \longmapsto (\vsq\CC_1,\sq F,\vsq\CC)
    = \vsq\overline{F}
  \\(\text{resp.}\quad \overline{p_\FF}'\smallbullet\sq
    &\colon \overline{F}
    \longmapsto (\hsq\CC_1,\sq F,\hsq\CC)
    = \hsq\overline{F})
  \end{aligned}
\]
where $(\CC_1,F,\CC)\in\FF$.
For all $\CC\in\FF_0$, let $\varepsilon(\CC)$ be the isomorphism from $\vsq\CC$ to $\hsq\CC$ defined by
\[
  (f'_2,f'_1,f_1,f_2)
  \longmapsto (f'_1,f'_2,f_2,f_1).
\]

We denote by $\varepsilon$ the map $\CC\mapsto\varepsilon(\CC)$.

\begin{proposition}{13}
\label{proposition:ii-13}
  With the above notation, $(\hsq,\varepsilon,\vsq)$ is an equivalence, natural in $\FF$.
\end{proposition}

In the above construction, we can replace $\sq\CC$ by the double category $\sq(\CC,\CC)$ and \cref{proposition:ii-13} still holds true.

Let $\CC_1^\smallbullet$ be a category and $(\CC^\smallbullet,\CC^\perp)$ a double category;
let $\FF(\CC^\smallbullet,\CC_1^\smallbullet)$ be the class of functors from $\CC_1^\smallbullet$ to $\CC^\smallbullet$.

\begin{proposition}{14}
\label{proposition:ii-14}
  $\FF(\CC^\smallbullet,\CC_1^\smallbullet)$ is a category for the composition law $(\Phi',\Phi)\mapsto\Phi'\perp\Phi$, where $(\Phi'\perp\Phi)(f)=\Phi'(f)\perp\Phi(f)$, if and only if $\Phi'(f)\perp\Phi(f)$ is defined for all $f\in\CC_1$.
\end{proposition}

This proposition follows from the Axiom of permutability (condition~(2) of \cref{theorem:ii-8});
the right unit of $\Phi$ is the functor $\alpha^\perp\Phi$, and its left unit is the functor $\beta^\perp\Phi$.

\begin{remark}
  If $\Phi$ is a double functor from $(\CC_1^\smallbullet,\CC_1^\perp)$ to $(\CC^\smallbullet,\CC^\perp)$, then $\alpha^\perp\Phi$ is no longer a functor from $\CC_1^\perp$ to $\CC^\perp$, and so the class of double functors from $(\CC_1^\smallbullet,\CC_1^\perp)$ to $(\CC^\smallbullet,\CC^\perp)$ is not identified with a subcategory of $\FF(\CC^\smallbullet,\CC_1^\smallbullet)$, contrary to what was stated in a corollary in \cite{3e}.
\end{remark}

The definition of a natural transformation $(\varphi',\tau,\varphi)$ from a functor $\varphi$ to a functor $\varphi'$ immediately leads to the following theorem (for the notation, see \cite{3d}).

\begin{theorem}{7}
\label{theorem:ii-7}
  Let $\CC$ and $\CC'$ be categories;
  the longitudinal category $\NN(\CC',\CC)$ of natural transformations between functors from $\CC$ to $\CC'$ can be identified with the category $\FF(\hsq\CC',\CC)$, by identifying the natural transformation $(\varphi',\tau,\varphi)$ with the functor $\Phi\in\FF(\hsq\CC',\CC)$, where
  \[
    \Phi(f)
    = \big(
      \varphi'(f), \tau(\beta(f)), \tau(\alpha(f)), \varphi(f)
    \big)
  \]
  for all $f\in\CC$;
  \oldpage{396}
  conversely, $\Phi\in\FF(\hsq\CC',\CC)$ is identified with the natural transformation $(\varphi',\tau,\varphi)$, where
  \[
    \varphi=\alpha^\vsqbox\Phi
    \textand
    \varphi'=\beta^\vsqbox\Phi
  \]
  and
  \[
    \big(
      \varphi'(e), \tau(e), \tau(e), \varphi(e)
    \big)
    = \Phi(e)
  \]
  for all $e\in\CC_0$.
\end{theorem}

This theorem shows that if $(\CC^\smallbullet,\CC^\perp)$ is a double category, then a functor $\Phi$ from a category $\Gamma$ to $\CC^\smallbullet$ can be considered as a generalised natural transformation from $\alpha^\perp\Phi$ to $\beta^\perp\Phi$.
We will later see ({§III}) another generalisation of the notion of natural transformation, namely the notion of a \emph{quintet} \cite{3e}.

\begin{longcomm}{68.1}
  \emph{Lax transformations.}

  This remark is very important.
  Indeed, it leads to a comprehensive study of lax transformations (in the sense of Kelly--Street~\cite{comm59}, called \emph{pseudo-transformations} by Gray~\cite{comm40} and \emph{catadeses} by Bourn~\cite{comm14}), which are found in this way when $(\CC^\smallbullet,\CC^\perp)$ is the double category of squares of a 2-category (cf. \cite[Comment~105.1]{coll64}).

  Thanks to this approach (generalised to multiple categories, as stated in \cite[Remark~3, p.~399]{coll117}), we obtained existence theorems for general lax limits in \cite{coll119,coll121}.
  These theorems are proved by a short structural proof, which encompasses Bourn's, Gray's, and Street's results on 2-functors \cite{comm14,comm40,comm92}.

  Note that Charles has already suggested this idea to S.~Legrand, who began to develop it in \cite{comm67}, but she lacked this meaningful example to motivate her.
\end{longcomm}


\subsection{$n$-fold categories}
\label{section:ii.5}

By \cref{theorem:ii-2}, the category $\overline{\FF}$ of double functors is a category of homomorphisms $(\MM,p_\FF\overline{p_\FF},\overline{\FF},\overline{\FF}_\gamma)$ over $\MM$.
We will see in \cref{section:ii.7} that this category of homomorphisms is right solving and has finite products.
Consequently, we can define $\overline{\FF}$-structured functors, and, more general, give the following definition:

\begin{definition}{15}
\label{definition:ii-15}
  Let $\FF^{[n-1]}$ be the category of $(n-1)$-fold functors considered as a category of homomorphisms over $\MM$.
  Then an $\FF^{[n-1]}$-structured category is called an \emph{$n$-fold category}, and an $\FF^{[n-1]}$-structured functor an \emph{$n$-fold functor}.
  In particular, a 2-fold category is a double category.
\end{definition}

By \cref{theorem:ii-13} and Corollary~2 of \cref{theorem:ii-14}, if $\FF^{[n-1]}$ is a category of homomorphisms with finite products, right solving over $\MM$, then so too is the category $\FF^{[n]}=\overline{\FF^{[n-1]}}$ of $\FF^{[n-1]}$-structured functors, which justifies the inductive definition.
From \cref{theorem:ii-13}, it also follows that, if $(\CC^{\perp_i})_{i\leq n}$ and $(\overline{\CC}^{\top_i})_{i\leq n}$ are $n$-fold categories, then the class $\CC\times\overline{\CC}$, endowed with the compositions laws $(\perp_i)\times(\top_i)$ for $i\leq n$, is an $n$-fold category.

\begin{theorem}{8}
\label{theorem:ii-8}
  Let $\CC$ be a class, and let $\perp_i$ (for $i\leq n$) be composition laws on $\CC$ such that $\CC^{\perp_i}$ is a category.
  For $(\CC^{\perp_i})_{i\leq n}$ to be an $n$-fold category, it is necessary and sufficient that the following conditions be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      Let $\alpha^i$ and $\beta^i$ be the source and target maps in $\CC^{\perp_i}$;
      then $\alpha^i$ and $\beta^i$ are functors from $\CC^{\perp_i}$ to $\CC^{\perp_j}$ for all $i,j\leq n$ with $i\neq j$.

    \item[\normalfont(2)]
      If the composites $(g'\perp_i g)\perp_j(f'\perp_i f)$ and $(g'\perp_j f')\perp_i(g\perp_j f)$ are defined, then
      \[
        (g'\perp_i g)\perp_j(f'\perp_i f)
        = (g'\perp_j f')\perp_i(g\perp_i f)
      \]
      for $i,j\leq n$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  Suppose that the theorem has been proven for $m$-fold categories, for all $m\leq n-1$; we will prove it for an $n$-fold category.
  Let $(\CC^{\perp_1},(\CC^{\perp_i})_{2\leq i\leq n})$ be an $n$-fold category.
  By hypothesis, $\alpha^1$ is a $(n-1)$-fold functor.
\oldpage{397}
  Let $e^1\in\CC_0^{\perp_1}$;
  we have that $\alpha^i(e^1)\in\CC_0^{\perp_1}$, since $\CC_0^{\perp_1}$ is by definition an $(n-1)$-fold subcategory of the $(n-1)$-fold category $(\CC^{\perp_i})_{2\leq i\leq n}$.
  Suppose that $g\perp_1 f$ is defined;
  since the class $\CC^{\perp_i}\star\CC^{\perp_i}$ of $\perp_i$-composible pairs is an $(n-1)$-fold subcategory of the product category $(\CC^{\perp_i})_{2\leq i\leq n}\times(\CC^{\perp_i})_{2\leq i\leq n}$, the composite $(\alpha^i(g))\perp_i(\alpha^i(f))$ is defined;
  from the fact that the map
  \[
    \chi^{\perp_1}
    \colon (g,f)
    \longmapsto g\perp_1f
  \]
  is an $(n-1)$-fold functor, we deduce that
  \[
    \chi^{\perp_1}(\alpha^i(g),\alpha^i(f))
    = \chi^{\perp_1}(\alpha^i(g,f))
    = \alpha^i(g\perp_1 f)
  \]
  whence
  \[
    \alpha^i(g)\perp_1\alpha^i(f)
    = \alpha^i(g\perp_1 f).
  \]
  This proves that $\alpha^i$ is a functor from $\CC^{\perp_1}$ to $\CC^{\perp_1}$;
  consequently, condition~(1) of the theorem is satisfied.
  Condition~(2) follows from the fact that $\chi^{\perp_1}$ is an $(n-1)$-fold functor.

  Conversely, suppose that conditions~(1) and (2) of the theorem are satisfied.
  Since $\alpha^i$ is a functor from $\CC^{\perp_j}$ to $\CC^{\perp_j}$, if $j\neq i$, we have that
  \[
    \alpha^i(\alpha^1(f))
    = \alpha^1(\alpha^i(f))
  \]
  where $f\in\CC$, and
  \[
    \alpha^1(e^1\perp_i e'^1)
    = e^1\perp_i e'^1
  \]
  where $e^1,e'^1\in\CC_0^{\perp_1}$;
  thus $\CC_0^{\perp_1}$ is an $(n-1)$-fold subcategory of $(\CC^{\perp_i})_{2\leq i\leq n}$.
  We will prove that $(\CC^{\perp_1})\star(\CC^{\perp_1})$ is an $(n-1)$-fold subcategory of the product $(n-1)$-fold category $(\CC^{\perp_i})_{2\leq i\leq n}\times(\CC^{\perp_i})_{i\leq 2\leq n}$.
  Suppose that $(g,f)\in(\CC^{\perp_1})\star(\CC^{\perp_1})$;
  since $\alpha^i$ is a functor from $\CC^{\perp_1}$ to $\CC^{\perp_1}$, we have that
  \[
    \alpha^i(g\perp_1 f)
    = \alpha^i(g)\perp_1\alpha^i(f)
  \]
  and so $(\alpha^i(g),\alpha^i(f))\in(\CC^{\perp_1})\star(\CC^{\perp_1})$;
  similarly, $(\beta^i(g),\beta^i(f))\in(\CC^{\perp_1})\star(\CC^{\perp_1})$.
  Suppose further that $(g',f')\in(\CC^{\perp_1})\star(\CC^{\perp_1})$ such that $g'\perp_i g$ and $f'\perp_i f$ are defined for all $2\leq i\leq n$.
  We see that
  \[
    \begin{aligned}
      \alpha^1(g'\perp_i g)
      &= \alpha^1(g')\perp_i\alpha^1(g)
    \\&= \beta^1(f')\perp_i\beta^1(f)
    \\&= \beta^1(f'\perp_i f);
    \end{aligned}
  \]
  consequently,
  \[
    \big(
      (g'\perp_i g), (f'\perp_i f)
    \big)
    \in(\CC^{\perp_1})\star(\CC^{\perp_1})
  \]
  for $2\leq i\leq n$, and $(\CC^{\perp_1})\star(\CC^{\perp_1})$ is thus a subcategory.
  It remains only to show that $\chi^{\perp_1}$ is an $(n-1)$-fold functor.
  We have that
  \[
    \chi^{\perp_1}\big(
      (g',f')\perp_i(g,f)
    \big)
    = (g'\perp_i g)\perp_1(f'\perp_i f);
  \]
  \oldpage{398}
  since
  \[
    \begin{aligned}
      \alpha^i(g'\perp_1 f')
      &= \alpha^i(g')\perp_1\alpha^i(f')
    \\&= \beta^i(g)\perp_1\beta^i(f)
    \\&= \beta^i(g\perp_1 f),
    \end{aligned}
  \]
  the composite $(g'\perp_1 f')\perp_i(g\perp_1 f)$ is defined;
  condition~(2) implies that
  \[
    \begin{aligned}
      \chi^{\perp_1}\big(
        (g',f')\perp_i(g,f)
      \big)
      &= (g'\perp_i g)\perp_1(f'\perp_i f)
    \\&= (g'\perp_1 f')\perp_i(g\perp_1 f)
    \\&= \chi^{\perp_1}(g',f')\perp_i\chi^{\perp_1}(g,f).
    \end{aligned}
  \]
  This proves the theorem.
\end{proof}

Let $(\CC^{\perp_i})_{i\leq n}$ be an $n$-fold category.
Denote by $\lambda^{i_1}\ldots\lambda^{i_p}$ the $(n-p)$-fold endofunctor of $(\CC^{\perp_j})_{i_1,\ldots,i_p\neq j<n}$ such that, for all $j\leq p$, we have
\[
  \begin{gathered}
    1\leq i_j\leq n,
    \quad i_j\neq i_j'\text{ if }j\neq j',
  \\\text{and}\quad\lambda^{i_j}\in\{\alpha^{i_j},\beta^{i_j}\}.
  \end{gathered}
\]

Such a functor is invariant under any permutation of the set $(i_1,\ldots,i_p)$ by the Axiom of permutability (condition~(2) of \cref{theorem:ii-8}).
The image of $f\in\CC$ by such a functor is called the \emph{$(n-p)$-face of $f$}.
The 0-faces are called the \emph{vertices} of $f$;
the class of vertices of $\CC$ is the class $\bigcap_{i\leq n}\CC_0^{\perp_i}$.
The 1-faces are called the \emph{edges} of $\CC$.

\begin{remarks}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      Let $(\gamma_1,\ldots,\gamma_n)$ be a sequence of functors such that $\lambda_i\in\{\alpha^i,\beta^i,\Id\}$, and $\lambda_i\neq\Id$ for exactly $p$-many indices $i$.
      For all $f\in\CC$, the family $((\gamma_1\ldots\gamma_n)(f))_{(\gamma_1\ldots\gamma_n)}$ is called the \emph{$(n-p)$-frame of $f$}, and denoted $c_{n-p}(f)$.
      In particular, the $(n-1)$-frames form an $n$-fold category, with the composition law $\perp_i$ for all $i\leq n$ being defined by
      \[
        c_{n-1}(f')\perp_i c_{n-1}(f)
        = c_{n-1}(f'\perp_i f)
        \qquad\text{if and only if $f'\perp_i f$ is defined.}
      \]
      This $n$-fold category is a quotient $n$-fold category of $(\CC^{\perp_i})_{i\leq n}$.

    \item[\normalfont(2)]
      Let $\CC^\perp$ be a category.
      By induction, we can define an $n$-fold category $(\CC^{[n]})_{i\leq n}^{\perp_i}$ in which every element is identified with its $1$-frame:
      \[
        \begin{gathered}
          (\CC^{[1]})^{\perp_1}
          = \CC^\perp
        \\\CC^{[n]}
          = \sq\big(
            (\CC^{[n-1]})^{\perp_1}, (\CC^{[n-1]})^{\perp_1}
          \big);
        \end{gathered}
      \]
      by induction, we can show that, for all $i\leq(n-1)$, there exists a bijection $\varepsilon_n^i$ from $\CC^{[n]}$ to $\sq((\CC^{[n-1]})^{\perp_i},(\CC^{[n-1]})^{\perp_i})$.

      \begin{longcomm}{70.5}
        To construct $\varepsilon_n^{n-1}$ by induction, one has to use the isomorphism
        \[
          \begin{aligned}
            \vsq\big(\vsq(A,A),\vsq(A,A)\big)
            &\longrightarrow
            \sq\big(\vsq(A,A),\vsq(A,A)\big)^\perp
            \hookrightarrow \hsq(A,A)^4
          \\Q=(\hat{q}',q',q,\hat{q})
            &\longmapsto
            \big(
              \hat{q}',
              \sq({}'\beta^\hsqbox)(Q),
              \sq({}'\alpha^\hsqbox)(Q),
              \hat{q}
            \big)
          \end{aligned}
        \]
        where ${}'\alpha^\hsqbox$ and ${}'\beta^\hsqbox$ are the source and target functors $\vsq(A,A)\to A$;
        this isomorphism is well defined for any category $A$.

        A simpler construction of the $n$-fold category $\CC^\boxnum{n}$ is done on p.~95.
        Cf. also the definition in \cite{coll120} of the functor
        \[
          \operatorname{Square}_{n,m}
          \colon \mathsf{Cat}_n
          \to \mathsf{Cat}_m
        \]
        for $n<m$, where the $n$-fold category $\operatorname{Square}_{n-1,n}\CC^\boxnum{n-1}$ is the same as $\CC^\boxnum{n}$, except for the fact that the first and last compositions are interchanged.
      \end{longcomm}

      The composition law $\perp_i$ on on $\CC^{[n]}$ is the inverse image under $\varepsilon_n^i$ of the longitudinal multiplication on $\varepsilon_n^i(\CC^{[n]})$.
      The composition law $\perp_n$ is defined by
      \[
        (\overline{h}',\overline{k}',\overline{k},\overline{h})
        \perp (h',k',k',h)
        = (\overline{h}'\hmult h', \overline{k}'\hmult k', \overline{k}\hmult k, \overline{h}\hmult h)
      \]
      if and only if $\overline{h}'\hmult h'$, $\overline{k}'\hmult k'$, $\overline{k}\hmult k$, and $\overline{h}\hmult h$ are all defined in $\hsq((\CC^{[n-1]})^{\perp_1},(\CC^{[n-1]})^{\perp_1})$.
      The $n$-fold category $(\CC^{[n]})_{i\leq n}^{\perp_i}$ admits as an $n$-fold subcategory the class $\CC^\boxnum{n}$, defined inductively by
      \[
        \CC^\boxnum{1} = \CC
        \textand
        \CC^\boxnum{n} = \sq\big((\CC^\boxnum{n-1}){^\perp_1}\big).
      \]
      \oldpage{399}
      In particular,
      \[
        \CC^\boxnum{2}
        = \sq\CC.
      \]

    \item[\normalfont(3)]
      Let $\CC_p=(\CC^{\perp_i})_{i\leq p}$ be a $p$-fold category, and $\overline{\CC}_n=(\overline{\CC}^{\perp_i})_{i\leq n}$ an $n$-fold category.
      The class $\FF(\overline{\CC}_n,\CC_p)$ of $p$-fold functors from $\CC_p$ to $(\overline{\CC}^{\perp_i})_{i\leq p}$ is an $(n-p)$-fold category for the composition laws $\perp_j$ (for $p<j\leq n-1$) defined by
      \[
        (\Phi'\perp_j\Phi)(f)
        = (\Phi'(f)\perp_j\Phi(f))
      \]
      if and only if $\Phi'(f)\perp_j\Phi(f)$ is defined for all $f\in\CC$.
      In particular, if $p=1$, then the class of functors from $\CC^{\perp_1}$ to $\overline{\CC}^{\perp_1}$ is an $(n-1)$-fold category.
      If $p=(n-1)$, then the class of $(n-1)$-fold functors from $\CC_{n-1}$ to $(\overline{\CC}^{\perp_i})_{i\leq n-1}$ is a category.
      An element $\Phi$ of this latter category can be considered as a \emph{generalised natural transformation from the $(n-1)$-fold functor $\alpha^{\perp_n}\Phi$ to the $(n-1)$-fold functor $\beta^{\perp_n}\Phi$}.

      \begin{longcomm}{71.1}
        Cf. Comment~68.1.
        We have proved:
        \begin{itemize}
          \item in \cite{coll119}, that $\FF(\overline{\CC}_n,\CC_p)$ defines the internal Hom on the category of all multiple categories;
          \item in \cite{coll120}, that the closure functor of the cartesian category $\mathsf{Cat}_n$ sends $(\overline{C}_n,\CC_n)$ the $n$-fold category $\FF(\sq_n\overline{\CC}_n,\CC_n)$, where $\sq_n\overline{\CC}_n$ is the $2n$-fold category obtained from $\operatorname{Square}_{n,2n}\overline{\CC}_n$ (cf. Comment~70.5) by the interchange of compositions
          \[
            (1,2,\ldots,2n)
            \longmapsto (1,3,\ldots,2n-1,2,4,\ldots,2n).
          \]
        \end{itemize}
      \end{longcomm}
  \end{enumerate}
\end{remarks}

\begin{proposition}{15}
\label{proposition:ii-15}
  For an $n$-fold category $(\CC^{\perp_1},(\CC^{\perp_i})_{2\leq i\leq n})$ to be an $\FF^{[n-1]}$-structured groupoid, it is necessary and sufficient that $\CC^{\perp_1}$ be a groupoid.
\end{proposition}

\begin{proof}
  The condition is evidently necessary; we will show that it is sufficient.
  For all $f\in\CC$, we denote by $f^{-1}$ the inverse of $f$ in the groupoid $\CC^{\perp_1}$.
  It suffices to prove that the map $f\mapsto f^{-1}$ is an $(n-1)$-fold functor from $(\CC^{\perp_i})_{2\leq i\leq n}$ to $(\CC^{\perp_i})_{2\leq i\leq n}$.
  Since $\alpha^{\perp_i}$ is a functor from $\CC^{\perp_1}$ to $\CC^{\perp_1}$, we have that
  \[
    (z^i)^{-1}
    = \big(\alpha^{\perp_i}(z^i)\big)^{-1}
    = \alpha^{\perp_i}\big((z^i)^{-1}\big)
    \in\CC_0^{\perp_i}
  \]
  for all $z^i\in\CC_0^{\perp_i}$ and $2\leq i\leq n$.
  Since $\chi^{\perp_i}$ is a functor from $\CC^{\perp_1}\star\CC^{\perp_1}$ to $\CC^{\perp_1}$, we see that
  \[
    \begin{aligned}
      (g^{-1}\perp_i f^{-1})
      &= \chi^{\perp_i}(g^{-1},f^{-1})
    \\&= \chi^{\perp_i}\big((g,f)^{-1}\big)
    \\&= \big(\chi^{\perp_i}(g,f)\big)^{-1}
    \\&= (g\perp_i f)^{-1};
    \end{aligned}
  \]
  thus the map $f\mapsto f^{-1}$ is a functor from $\CC^{\perp_i}$ to $\CC^{\perp_i}$ for $2\leq i\leq n$, and $(\CC^{\perp_1},(\CC^{\perp_i})_{2\leq i\leq n})$ is an $\FF^{[n-1]}$-structured groupoid
\end{proof}

\begin{definition}{16}
\label{definition:ii-16}
  We defined an \emph{$n$-fold groupoid} to be an $n$-fold category $(\CC^{\perp_i})_{i\leq n}$ such that $\CC^{\perp_i}$ is a groupoid for all $i\leq n$.
\end{definition}

In particular, it follows from \cref{proposition:ii-15} that, if $(\CC^\smallbullet,\CC^\perp)$ is a double groupoid, then $(\CC^\smallbullet,\CC^\perp)$ and $(\CC^\perp,\CC^\smallbullet)$ are both $\FF$-structured groupoids.\comm{71.2}{They are also structured groupoids in the category of groupoids. Double groupoids are studied by Brown--Spencer~\cite{comm16} with a view to applications in homotopy theory; e.g. they prove that the category of crossed modules is equivalent to a subcategory of the category of double groupoids.}


\subsection{Order structures on a category}
\label{section:ii.6}

\oldpage{400}

\begin{definition}{17}
\label{definition:ii-17}
  We say that an $n$-fold category $(\CC^{\perp_i})_{i\leq n}$ defines an \emph{$n$-fold order}\footnote{The notion of an $n$-fold order is meant to evoke that of an $n$-fold ordered class of Cantor~\cite{6}.} if each of the categories $\CC^{\perp_i}$ defines an order $<_i$ on the class of its units.
\end{definition}

In this case, the class $\Delta$ of vertices of $(\CC^{\perp_i})_{i\leq n}$ is endowed with $n$ orders, induced by the $<_i$.
Note that the data of $\Delta$ and of the $n$ induced orders does not determine $(\CC^{\perp_i})_{i\leq n}$.
In particular, consider a class endowed with orders $<_1$ and $<_2$; let $\Delta_0^\smallbullet$ (resp. $\Delta_0^\perp$) be the category of pairs $(E,e)$ where $e<_1E$ (resp. $e<_2E$);
the double category $\sq(\Delta_0^\smallbullet,\Delta_0^\perp)$ is the largest double category that defines a double order that induces on $\Delta$ the orders $<_1$ and $<_2$;
this implies that every double category that defines a double order that induces on $\Delta$ the orders $<_1$ and $<_2$ can be identified with a double subcategory of $\sq(\Delta_0^\smallbullet,\Delta_0^\perp)$.
This result can be generalised to the case where we give $n$ orders on the class $\Delta$.

\begin{proposition}{16}
\label{proposition:ii-16}
  Let $(\CC^{\perp_i})_{i\leq n}$ be an $n$-fold category satisfying the following condition:
  \begin{quote}
    Any two elements of $\CC$ that have the same set of vertices are identical.
  \end{quote}
  Then $(\CC^{\perp_i})_{i\leq n}$ defines an $n$-fold order.
\end{proposition}

\begin{proof}
  The class of vertices of $f\in\CC$ is identical to the union of the classes of vertices of $\alpha^{\perp_i}f$ and $\beta^{\perp_i}f$;
  thus, if $f$ and $g$ have the same set of units in $\CC^{\perp_i}$, then they also have the same set of vertices, and so $f=g$.
\end{proof}

Let $\widetilde{\Omega}$ be the category of homomorphisms between ordered classes\comm{72.1}{A homomorphism between posets is just a monotone map.}, and $(\MM,\omega,\widetilde{\Omega},\Omega)$ the category of homomorphisms described in \cref{section:i}.
Then $(\MM,\omega,\widetilde{\Omega},\Omega)$ is a category of homomorphisms with finite products that is also right solving.
The product of $(A,<)$ with $(A',<)$ is the ordered class $(A\times A',<)$, whose order is the product order of the orders of $A$ and of $A'$.

For $(\CC^\smallbullet,<)$ to be an $\widetilde{\Omega}$-structured category, it is necessary and sufficient that the following conditions be satisfied:
\begin{enumerate}
  \item[\normalfont(1)]
    $\CC^\smallbullet$ is a category, and $(\CC,<)$ is an ordered class.
  \item[\normalfont(2)]
    If $f'<f$ then $\alpha(f')<\alpha(f)$ and $\beta(f')<\beta(f)$.
  \item[\normalfont(3)]
    If $f'<f$ and $g'<g$, and if $g\smallbullet f$ and $g'\smallbullet f'$ are defined, then $g'\smallbullet f'<g\smallbullet f$.
\end{enumerate}
For $(\CC^\smallbullet,<)$ to be an $\widetilde{\Omega}$-structured groupoid, it is further required that:
\begin{enumerate}
  \item[\normalfont(4)]
    If $f'<f$ then $f'^{-1}<f^{-1}$.
\end{enumerate}

\begin{proposition}{17}
\label{proposition:ii-17}
  For $(\CC^\smallbullet,<)$ to be an $\widetilde{\Omega}$-structured category, it is necessary and sufficient that there exist a double category $(\SS^\smallbullet,\SS^\perp)$ that satisfies the following conditions:
  \oldpage{401}
  \begin{enumerate}
    \item[\normalfont(1)]
      $\CC^\smallbullet$ can be identified with $(\SS_0^\perp)^\smallbullet$;
    \item[\normalfont(2)]
      $\SS^\perp$ defines the order $<$ on $\CC^\smallbullet$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  If there exists a double category $(\SS^\smallbullet,\SS^\perp)$ that satisfies conditions~(1) and (2), then set $\CC^\smallbullet=(\SS_0^\perp)^\smallbullet$ and endow $\CC^\smallbullet$ with the relation
  \[
    [f' < f]
    \quad\text{if and only if}\quad
    \big[\text{there exists $k\in\SS$ such that $f=\beta^\perp(k)$ and $f'=\alpha^\perp(k)$}\big].
  \]
  If $f'<f$ then
  \[
    \alpha^\smallbullet(f) = \beta^\perp(\alpha^\smallbullet(k))
    \textand
    \alpha^\smallbullet(f') = \alpha^\perp(\alpha^\smallbullet(k))
  \]
  whence $\alpha^\smallbullet(f')<\alpha^\smallbullet(f)$;
  similarly, $\beta^\smallbullet(f')<\beta^\smallbullet(f)$.
  Let $g\in\CC$ be such that $g\smallbullet f$ is defined;
  let $g'\in\CC$ be such that $g'\smallbullet f'$ is defined and such that there exists $k_1\in\SS$ with
  \[
    g=\beta^\perp(k_1)
    \textand
    g'=\alpha^\perp(k_1);
  \]
  since $\SS^\perp$ defines an order on $(\SS_0^\perp)$, the equalities
  \[
    \begin{gathered}
      \alpha^\perp(\alpha^\smallbullet(k_1))
      = \alpha^\perp(\beta^\smallbullet(k))
      = \alpha^\smallbullet(g')
    \\\beta^\perp(\alpha^\smallbullet(k_1))
      = \beta^\perp(\beta^\smallbullet(k))
      = \alpha^\smallbullet(g)
    \end{gathered}
  \]
  imply that $\alpha^\smallbullet(k_1)=\beta^\smallbullet(k)$;
  thus $k_1\smallbullet k$ is defined, and we see that
  \[
    g\smallbullet f = \beta^\perp(k_1\smallbullet k)
    \textand
    g'\smallbullet f' = \alpha^\perp(k_1\smallbullet k)
  \]
  and so $g'\smallbullet f'<g\smallbullet f$.
  This shows that $(\CC^\smallbullet,<)$ is an $\widetilde{\Omega}$-structured category.

  Conversely, if $(\CC^\smallbullet,<)$ is $\widetilde{\Omega}$-structured, let $\mathcal{O}$ be the category of pairs $(E,e)$, with $e,E\in\CC_0^\smallbullet$, such that $e<E$.
  Then the class $\SS$ of quadruples $((E_1,e_1),f,f',(E,e))$, with $f'<f$ and
  \[
    \begin{array}{cc}
      \alpha(f')=e,
      & \beta(f')=e_1,
    \\\alpha(f)=E,
      &\beta(f)=E_1,
    \end{array}
  \]
  forms a double subcategory of $\sq(\mathcal{O},\CC^\smallbullet)$ that satisfies (1) and (2).
\end{proof}

Let $\widetilde{\Omega}'$ be the subcategory of $\widetilde{\Omega}$ consisting of strict homomorphisms, i.e. triples $((A',<),h,(A,<))$ such that the relations $z'<z$ and $h(z')=h(z)$ imply that $z=z'$.

\begin{definition}{18}
\label{definition:ii-18}
  An $\widetilde{\Omega}(\widetilde{\Omega}',\widetilde{\Omega})$-structured category is called an \emph{ordered category};
  an $\widetilde{\Omega}((\widetilde{\Omega}',\widetilde{\Omega}'),\widetilde{\Omega})$-structured groupoid is called a \emph{strictly ordered groupoid}.
\end{definition}

For an $\widetilde{\Omega}$-structured category $(\CC^\smallbullet,<)$ to be an ordered category, it is necessary and sufficient that the conditions
\[
  \begin{gathered}
    f'<f,
  \\\alpha(f')=\alpha(f)
    \textand
    \beta(f')=\beta(f)
  \end{gathered}
\]
imply that $f'=f$.

\begin{longcomm}{73.1}
  This condition is essential in most applications;
  however, it implies that there do not exist ordered categories that are also monoids;
  in particular, ordered groups (in the usual sense) are not ordered categories (in this sense).

  Ordered categories and, more specifically, inductive and local groupoids are studied in a long series of papers, summarised in the "Guide" \cite{coll86}.
  More special problems are considered in the theses of Joubert~\cite{comm57}, S.~Legrand~\cite{comm68}, and Leblond~\cite{comm66} (cf. \cite[Part~II]{coll}).
\end{longcomm}

\begin{proposition}{18}
\label{proposition:ii-18}
  \oldpage{402}
  An $\widetilde{\Omega}$-structured groupoid $(\CC^\smallbullet,<)$ is an ordered category.
\end{proposition}

\begin{proof}
  Let $g,g'\in\CC$ be such that
  \[
    \begin{gathered}
      g'<g,
    \\\alpha(g')=\alpha(g)
      \textand
      \beta(g')=\beta(g).
    \end{gathered}
  \]
  We have that
  \[
    \begin{aligned}
      \beta(g)
      &= \beta(g')
      = g'\smallbullet g'^{-1}
      < g\smallbullet g'^{-1}
      < g\smallbullet g^{-1}
      = \beta(g)
    \\\alpha(g)
      &= \alpha(g')
      = g'^{-1}\smallbullet g'
      < g'^{-1}\smallbullet g
      < g^{-1}\smallbullet g
      = \alpha(g).
    \end{aligned}
  \]
  We thus deduce that
  \[
    g\smallbullet g'^{-1} = \beta(g)
    \textand
    g'^{-1}\smallbullet g = \alpha(g)
  \]
  and thus that
  \[
    g'^{-1}=g^{-1}
    \textand
    g=g'.
    \qedhere
  \]
\end{proof}

\begin{proposition}{19}
\label{proposition:ii-19}
  For an $\widetilde{\Omega}$-structured groupoid $(\CC^\smallbullet,<)$ to be a strictly ordered groupoid, it is necessary and sufficient that the following condition be satisfied:
  \begin{quote}
    For all $f\in\CC$ and all $e<\alpha(f)$, there exists at most one $f'\in\CC$ such that both $f'<f$ and $\alpha(f')=e$.
  \end{quote}
\end{proposition}

\begin{proof}
  For $(\CC^\smallbullet,<)$ to be a strictly ordered groupoid, it is necessary and sufficient that there exist a double category $(\SS^\smallbullet,\SS^\perp)$ satisfying conditions~(1) and (2) of \cref{proposition:ii-17}, that $\CC^\smallbullet$ be a groupoid, and that we have the following:
  \begin{enumerate}
    \item[\normalfont(3)]
      For $k,k'\in\SS$, the relations $\beta^\perp(k)=\beta^\perp(k')$ and $\alpha^\smallbullet(k)=\alpha^\smallbullet(k')$ imply that $k=k'$.
      \qedhere
  \end{enumerate}
\end{proof}

\begin{definition}{19}
\label{definition:ii-19}
  We define a \emph{functorially ordered category} (resp. $\emph{functorially ordered groupoid}$), to be a category (resp. groupoid) $\CC^\smallbullet$ endowed with an order relation that satisfies the following condition:
  \begin{enumerate}
    \item[\normalfont(1)]
      The map that sends $f\in\CC$ to the class of elements $f'<f$ is a generalised functor\comm{74.1}{This means that a morphism less than an identity is an identity, and that a morphism less than a composite $g\smallbullet f$ is of the form $g'\smallbullet f'$ with $g'<g$ and $f'<f$.} \cite{3a} from $\CC$ to $\CC$.
  \end{enumerate}
\end{definition}

By a proposition of \cite{3a}, a functorially ordered groupoid is also a strictly ordered groupoid.

\begin{longcomm}{74.2}
  More precisely, if $(\CC^\smallbullet,<)$ is a functorially ordered groupoid, and if $e<\alpha(f)$, then there exists exactly one $g<f$ with $\alpha(g)=e$.
  Indeed, since $\alpha(f)=f^{-1}\smallbullet f$, there exist $g<f$ and $g'<f^{-1}$ such that $e=g'\smallbullet g$, whence $\alpha(g)=e$.
  Now, that $g$ is unique: if $f'<f$ and $\alpha(f')=e$, then
  \[
    g\smallbullet f'^{-1}
    < f\smallbullet f^{-1}
    =  \beta(f)
  \]
  and so $g\smallbullet f'^{-1}$ is also an identity, and $g=f'$.
\end{longcomm}

\begin{proposition}{20}
\label{proposition:ii-20}
  For $(\CC^\smallbullet,<)$ to be a functorially ordered groupoid, it is necessary and sufficient that $\CC^\smallbullet$ be a groupoid that there exist a double category $(\SS^\smallbullet,\SS^\perp)$ satisfying conditions~(1) and (2) of \cref{proposition:ii-17}, as well as the following condition:
  \begin{enumerate}
    \item[\normalfont(3\textquotesingle)]
      Let $f\in\SS_0^\perp$ and $z\in\SS_0^\smallbullet$ be such that $\alpha^\smallbullet(f^\perp)=\beta^\perp(z)$.
      Then there exists exactly one $k\in\SS$ such that
      \[
        \beta^\perp(k)=f
        \textand
        \alpha^\smallbullet(k)=z.
      \]
  \end{enumerate}
\end{proposition}

\begin{proof}
  \oldpage{403}
  The conditions are necessary by virtue of the proposition of \cite{3a} mentioned above.
  Conversely, suppose that we have a double category $(\SS^\smallbullet,\SS^\perp)$ that satisfies conditions~(1), (2), and (3');
  \begin{longcomm}{75.1}
    We need the stronger result, indicated in Comment~74.2.
  \end{longcomm}
  then, by \cref{proposition:ii-18}, $(\CC^\smallbullet,<)$ is an ordered groupoid.
  Taking conditions~(1) and (2) into account, condition~(3') implies that, if $f\in\CC$ and $e\in\CC_0^\smallbullet$ with $e<\alpha(f)$, then there exists exactly one $f'\in\CC$ such that both $f'<f$ and $\alpha(f')=e$.
  In particular, the relations $e\in\CC_0^\smallbullet$ and $g<e$ imply that $\alpha(g)<e$, whence $g=\alpha(g)$.
  Let $d<g\smallbullet f$.
  By hypothesis, there exist $k,k'\in\SS$ such that
  \[
    \begin{aligned}
      \alpha^\smallbullet(k)
      &=(\alpha(f),\alpha(d)),
    \\\beta^\perp(k)
      &=f,
    \\\beta^\perp(k')
      &=g,
    \\\alpha^\smallbullet(k')
      &=\beta^\smallbullet(k).
    \end{aligned}
  \]
  It thus follows that
  \[
    d = \big(\alpha^\perp(k')\big)\smallbullet\big(\alpha^\perp(k)\big).
    \qedhere
  \]
\end{proof}

Let $\widetilde{\Omega}''$ be the subcategory of $\widetilde{\Omega}$ consisting of triples $((A',<),h,(A,<))$ such that $h$ satisfies the following condition:
\begin{quote}
  If $e'<h(z)$, then there exists $z'<z$ such that $h(z')=e'$.
\end{quote}

\begin{proposition}{21}
\label{proposition:ii-21}
  For $(\CC^\smallbullet,<)$ to be a functorially ordered groupoid, it is necessary and sufficient that $(\CC^\smallbullet,<)$ be a $\widetilde{\Omega}((\widetilde{\Omega}'\cap\widetilde{\Omega}'',\widetilde{\Omega}'\cap\widetilde{\Omega}''),\widetilde{\Omega})$-structured groupoid.
\end{proposition}

\begin{proof}
  This follows from \cref{proposition:ii-20}.
\end{proof}

Let $\II_0$ be the subclass of $\Omega_0$ consisting of inductive classes \cite{3a}, i.e. of ordered classes $(A,<)$ such that every bounded-above subclass admits an upper bound, called the \emph{aggregate}.
Let $\II$ be the subcategory of $\widetilde{\Omega}$ consisting of inductive maps between inductive classes \cite{3a}, i.e. whose elements are the triples $((A',<),h,(A,<))$ such that $h$ satisfies the following conditions:
\begin{enumerate}
  \item[\normalfont(1)]
    If $z'<z$ and $z''<z$, then $h(z\cap z')=h(z)\cap h(z')$, where $z\cap z'$ denotes the lower bound, or \emph{intersection}, of $z$ and $z'$ in $A$.
  \item[\normalfont(2)]
    Let $C$ be a bounded-above class in $A$, and let $\cup C$ be its aggregate in $A$;
    we have that
    \[
      h(\cup C)
      = \cup h(C).
    \]
\end{enumerate}
Then $(\MM,\omega,\II,\II\cap\Omega)$ is a category of homomorphisms with finite products that is right solving.
A substructure of $(A,<)$ in $\II$ is a weakly sub-inductive subset \cite{3a} of $A$.\comm{75.3}{A weakly sub-inductive subset $A$ is closed under finite meets and arbitrary joins of families bounded in $A$.}
Since every substructure in $\II$ is \emph{a fortiori} a substructure in $\widetilde{\Omega}$, an $\II$-structured category is also $\widetilde{\Omega}$-structured.

\oldpage{404}
For $(\CC^\smallbullet,<)$ to be an $\II$-structured category, it is necessary and sufficient that $(\CC,<)$ be an inductive class and that the following conditions be satisfied:
\begin{enumerate}
  \item[\normalfont(I\textsubscript{1})]
    The relations $f'<f$ and $f''<f$ imply that
    \[
      \alpha(f'\cap f'') = \alpha(f')\cap\alpha(f'')
      \textand
      \beta(f'\cap f'') = \beta(f')\cap\beta(f'').
    \]
  \item[\normalfont(I\textsubscript{2})]
    The relations $f_i<f$, for $i\in I$, imply that
    \[
      \alpha\left(\bigcup_{i\in I}f_i\right)
      = \bigcup_{i\in I}\alpha(f_i)
      \textand
      \beta\left(\bigcup_{i\in I}f_i\right)
      = \bigcup_{i\in I}\beta(f_i)
    \]
    for all $i\in I$.
  \item[\normalfont(I\textsubscript{3})]
    The relations $g_i<g$, $f_i<f$, and $(g_i,f_i)\in\CC^\smallbullet\star\CC^\smallbullet$, for $i\in I$, with $(g,f)\in\CC^\smallbullet\star\CC^\smallbullet$, imply that
    \[
      \begin{aligned}
        (g_i\cap g_j)\smallbullet(f_i\cap f_j)
        &= (g_i\smallbullet f_i)\cap(g_j\smallbullet f_j)
      \\\left(\bigcup_{i\in I}g_i\right)\smallbullet\left(\bigcup_{i\in I}f_i\right)
        &= \bigcup_{i\in I}(g_i\smallbullet f_i)
      \end{aligned}
    \]
    for all $i,j\in I$.
\end{enumerate}

\begin{proposition}{22}
\label{proposition:ii-22}
  Let $(\CC^\smallbullet,<)$ be an $\II$-structured category;
  let $g,f\in\CC$;
  let $H$ be the class of elements $g'\smallbullet f'$ such that $g'<g$ and $f'<f$.
  Then the class $H$ admits a largest element.
\end{proposition}

\begin{proof}
  Let $\langle{g,f}\rangle$ be the class of pairs $(g',f')$, with $g',f'\in\CC$, such that
  \[
    \begin{gathered}
      \alpha(g')=\beta(f')
    \\g'<g
      \textand
      f'<f.
    \end{gathered}
  \]
  Let $G$ be the class of the $g'$ such that there exists $(g',f')\in\langle{g,f}\rangle$;
  let $F$ be the class of the $f'$ such that there exists $(g',f')\in\langle{g,f}\rangle$.
  The class $\alpha(G)$ is then equal to the class $\beta(F)$.
  By condition~(2), the class $G$, bounded above by $g$, admits an aggregate $\cup G<g$ such that $\alpha(\cup G)=\cup\alpha(G)$;
  similarly, $F$ admits an aggregate $\cup F<f$ such that $\beta(\cup F)=\cup\beta(F)$.
  Then $\alpha(\cup G)=\beta(\cup F)$, and $(\cup G)\smallbullet(\cup F)$ is defined;
  since $(\cup G)\smallbullet(\cup F)$ belongs to $H$, we see that $\cup H=(\cup G)\smallbullet(\cup F)$.
\end{proof}

\begin{definition}{20}
\label{definition:ii-20}
  With the conditions of \cref{proposition:ii-22}, the largest element $\cup H$ of $H$ is denoted $gf$, and called the \emph{pseudo-product of $g$ and $f$}.
\end{definition}

Note that the composition law $(g,f)\mapsto gf$, which is everywhere defined, is not necessarily associative.

\begin{proposition}{23}
\label{proposition:ii-23}
  Let $(\CC^\smallbullet,<)$ be an $\II$-structured category;
  the pseudo-product $(g,f)\mapsto gf$ satisfies the following conditions:
  \begin{enumerate}
    \item[\normalfont(1)]
      Let $g,g',f,f'\in\CC$ be such that $g'<g$ and $f'<f$.
      Then $g'f'<gf$.
    \item[\normalfont(2)]
      Let $g,f\in\CC$.
      Then
      \[
        \beta(gf)<\beta(g)
        \textand
        \alpha(gf)<\alpha(f).
      \]
    \item[\normalfont(3)]
      \oldpage{405}
      Let $s\in\CC_0$ and $S\in\CC_0^\smallbullet$ be such that $s<S$.
      Then
      \[
        \alpha(Ss)
        = s
        = \beta(sS).
      \]
  \end{enumerate}
\end{proposition}

\begin{proof}
  Conditions~(1) and (2) follow from the definition of the pseudo-product.
  Suppose that $s<S$ in $\CC_0^\smallbullet$.
  Then $\alpha(Ss)<s$.
  Furthermore, $s\smallbullet s<Ss$, so
  \[
    s < \alpha(Ss) < s
    \textand
    s = \alpha(Ss).
  \]
  Similarly
  \[
    \beta(sS)
    = s.
  \]
\end{proof}

Using the subcategories $\widetilde{\Omega}'$ and $\widetilde{\Omega}''$ defined above, we set
\[
  \II' = \II\cap\widetilde{\Omega}'
  \textand
  \II'' = \II\cap\widetilde{\Omega}''.
\]

The elements of $\II'$ are the strict inductive maps \cite{3a}.
The subcategory $\II'$ of $\II$ contains the groupoid of invertible elements of $\II$ and satisfies condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}), since every restriction of a strict inductive map is a strict inductive map.
The subcategory $\II''$ of $\II$ also contains $\II\cap\Omega$, but $\II''$ does not satisfy condition~($\sigma$).
The subcategories $\II'$ and $\II''$ of $\II$ are stable under products (but they are not categories of homomorphisms with finite products over $\MM$).

\begin{definition}{21}
\label{definition:ii-21}
  An $\II(\II',\II)$-structured category is called an \emph{inductive category};
  if $(\CC^\smallbullet,<)$ is an inductive category, then an element $f'$ such that $f'<f$ is said to be \emph{induced by $f$}.
\end{definition}

\begin{theorem}{9}
\label{theorem:ii-9}
  Let $\CC^\smallbullet)$ be a category and $(\CC,<)$ an inductive class.
  For $(\CC^\smallbullet,<)$ to be an inductive category, it is necessary and sufficient that it satisfy axioms~(I\textsubscript(1)) and (I\textsubscript{2}), as well as the following axioms:
  \begin{enumerate}
    \item[\normalfont(I\textquotesingle\!\textsubscript{3})]
      The conditions $g'<g$, $f'<f$, $(g,f),(g',f')\in\CC^\smallbullet\star\CC^\smallbullet$ imply that $g'\smallbullet f'<g\smallbullet f$.
    \item[\normalfont(I\textquotesingle\!\textsubscript{4})]
      The conditions $g'<g$, $\alpha(g')=\alpha(g)$, and $\beta(g')=\beta(g)$ imply that $g'=g$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  The conditions are clearly necessary; we will show that they are sufficient, i.e. that they imply axiom~(I\textsubscript{3}), from which we take our notation.
  Since we have
  \[
    \alpha(g_i\cap g_j)
    = \alpha(g_i)\cap\alpha(g_j)
    = \beta(f_i)\cap\beta(f_j),
  \]
  the composite $h=(g_i\cap g_j)\smallbullet(f_i\cap f_j)$ is defined and, by (I\textquotesingle\!\textsubscript{3}), we have that
  \[
    h < (g_i\smallbullet f_i)\cap(g_j\smallbullet f_j).
  \]
  Since $g_i\smallbullet f_i<g\smallbullet f$ and $g_j\smallbullet f_j<g\smallbullet f$, by using (I\textsubscript{1}) we find that
  \[
    \begin{aligned}
      \alpha(g_i\smallbullet f_i\cap g_j\smallbullet f_j)
      &= \alpha(f_i)\cap\alpha(f_j)
    \\&= \alpha(f_i\cap f_j)
    \\&= \alpha(h)
    \end{aligned}
  \]
  and
  \[
    \begin{aligned}
      \beta(g_i\smallbullet f_i\cap g_j\smallbullet f_j)
      &= \beta(g_i)\cap\beta(g_j)
    \\&= \beta(g_i\cap g_j)
    \\&= \beta(h).
    \end{aligned}
  \]
  \oldpage{406}
  From axiom~(I\textquotesingle\!\textsubscript{4}) we then deduce that
  \[
    h
    = (g_i\smallbullet f_i)\cap(g_j\smallbullet f_j).
  \]
  We can show, in an analogous manner, the second relation of axiom~(I\textquotesingle\!\textsubscript{3}).
\end{proof}

\begin{corollary}{1}
  For $(\CC^\smallbullet,<)$ to be an inductive category in the sense of \cite{3c}, it is necessary and sufficient that $(\CC^\smallbullet,<)$ be an $\II(\II',\II'')$-structured category.
\end{corollary}

\begin{proof}
  Indeed, conditions~(I\textsubscript{1}), (I\textsubscript{2}), (I\textquotesingle\!\textsubscript{3}), and (I\textquotesingle\!\textsubscript{4}) imply that $(\CC^\smallbullet,<)$ satisfies all the axioms of an inductive category in the sense of \cite{3c}, with the exception of the following axiom:
  \begin{enumerate}
    \item[\normalfont(I\textquotesingle\!\textsubscript{5})]
      If $k<g\smallbullet f$, then there exist $g'<g$ and $f'<f$ such that $k=g'\smallbullet f'$;
      axiom~(I\textquotesingle\!\textsubscript{3}) is equivalent to the condition $((\CC,<),\chi^\smallbullet,(\CC^\smallbullet\star\CC^\smallbullet,<))\in\II''$.
      \qedhere
  \end{enumerate}
\end{proof}

\begin{corollary}{2}
  In an inductive category (in the sense of \cite{3c}), any two elements have a pseudo-product, and the composition law $(g,f)\mapsto gf$ is associative.
\end{corollary}

\begin{remark}
  In what follows in this article, we will see that the $\HH(\HH',\HH'')$-structured categories such that $\HH'$ and $\HH''$ satisfy condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}) enjoy numerous properties.
  It is this reason that motivated the new terminology used here, since the class of inductive categories in the sense of \cref{definition:ii-21} is more stable under certain operations than the class of inductive categories in the sense of \cite{3c}.
\end{remark}

\begin{proposition}{24}
\label{proposition:ii-24}
  Let $(\CC^\smallbullet)$ be an inductive category;
  let $f,f'\in\CC$ be such that $f'<f$;
  then we have that
  \[
    f'
    = \beta(f')\big(f\alpha(f')\big)
    = \big(\beta(f')f)\alpha(f').
  \]
\end{proposition}

\begin{proof}
  Using \cref{proposition:ii-23}, we find that
  \[
    \begin{gathered}
      f'
      = f'\smallbullet\alpha(f')
      < f\alpha(f'),
    \\f'
      = \beta(f')\smallbullet f'
      < \beta(f')\big(f\alpha(f'\big),
    \\\alpha\left(\beta(f')\big(f\alpha(f')\big)\right)
      < \alpha\big(f\alpha(f')\big)
      < \alpha(f')
    \\\beta\left(\beta(f')\big(f\alpha(f')\big)\right)
      < \beta(f').
    \end{gathered}
  \]
  Let $f''=\beta(f')(f\alpha(f'))$;
  since $f'<f''$, we have that
  \[
    \alpha(f')<\alpha(f'')
    \textand
    \beta(f')<\beta(f'').
  \]
  It thus follows that
  \[
    \alpha(f')=\alpha(f'')
    \textand
    \beta(f')=\beta(f'').
  \]
  Since $[\beta,\alpha]$ is a strict inductive map, the relations
  \[
    \begin{gathered}
      f'<f''
    \\\alpha(f')=\alpha(f'')
      \textand
      \beta(f')=\beta(f'')
    \end{gathered}
  \]
  \oldpage{407}
  imply that $f'=f''$.
  We can similarly show the equality
  \[
    f'
    = \big(\beta(f')f\big)\alpha(f').
    \qedhere
  \]
\end{proof}

\begin{corollary*}
  Let $(\CC^\smallbullet,<)$ be an inductive category;
  the conditions
  \[
    s,S\in\CC_0^\smallbullet
    \textand
    s<S
  \]
  imply that
  \[
    s
    = s(Ss)
    = (sS)s.
  \]
\end{corollary*}

\begin{proposition}{25}
\label{proposition:ii-25}
  Let $(\CC^\smallbullet,<)$ be an inductive category.
  For $(\CC^\smallbullet,<)$ to be an $\II(\II',\II'')$-structured category, it is necessary and sufficient that the pseudo-product $(g,f)\mapsto gf$ be associative.
\end{proposition}

\begin{proof}
  The condition is necessary by \cref{theorem:ii-9} and its corollary.
  If it is satisfied, let $k<g\smallbullet f$;
  by \cref{proposition:ii-24}, we have that
  \[
    k
    = \beta(k)(g\smallbullet f)\alpha(k)
    = \big(\beta(k)g\big)\big(f\alpha(k)\big),
  \]
  using the associativity of the pseudo-product.
  From the definition of the pseudo-product, it follows that
  \[
    k
    = (\cup G)\smallbullet(\cup F)
  \]
  where $G$ is a class bounded above by $(\beta(k)g)$, and $f$ is a class bounded above by $(f\alpha(k))$, and so $\cup G<g$ and $\cup F<f$.
  This proves that axiom (I\textquotesingle\!\textsubscript{3}) is satisfied.
\end{proof}

Let $(\CC^\smallbullet,<)$ be an $\II$-structured category.
Let $\CC^l$ be the class of triples $(S',f,S)$, with $f\in\CC$ and $S,S'\in\CC_0^\smallbullet$, such that
\[
  \alpha(f)<S
  \textand
  \beta(f)<S'.
\]

Endowed with the composition law
\[
  \begin{gathered}
    (S'',f',S'_1)\smallbullet(S',f,S)
    = (S'',f'\smallbullet f,S)
  \\\text{if and only if}\qquad
    \big[\alpha(f')=\beta(f)\textand S'_1=S'\big],
  \end{gathered}
\]
$\CC^l$ is a category;
the units of $\CC^l$ are the triples $(S,e,S)$ where $e\in\CC_0^\smallbullet$ and $e<S$.
The map $f\mapsto(\beta(f),f,\alpha(f))$ identifies $\CC$ with a subcategory of $\CC^l$.

\begin{proposition}{26}
\label{proposition:ii-26}
  With the above notation, $(\CC^l,<)$ is an $\II$-structured category, with the order relation defined by
  \[
    (S'_1,f_1,S_1)<(S',f,S)
    \qquad\text{if and only if}\qquad
    \big[
      S'_1<S', S_1<S, f_1<f
    \big].
  \]
  If $(\CC^\smallbullet,<)$ is an inductive category (resp. an $\II(\II',\II'')$-structured category), then $(\CC^l,<)$ is an inductive category (resp. an $\II(\II',\II'')$-structured category).
\end{proposition}

\begin{proof}
  \oldpage{408}
  Suppose that
  \[
    \overline{f}_i
    = (S'_i,f_i,S_i)
    < \overline{f}
    = (S',f,S)
  \]
  for all $i\in I$;
  we have that
  \[
    \bigcup_{i\in I}\overline{f}_i
    = \left(\bigcup_{i\in I}S'_i, \bigcup_{i\in I}f_i, \bigcup_{i\in I}S_i\right)
    \textand
    \bar{f}_i\cap\bar{f}_j
    = (S'_i\cap S'_j, f_i\cap f_j, S_i\cap S_j),
  \]
  whence
  \[
    \begin{aligned}
      \alpha\left(\bigcup_{i\in I}\overline{f}_i\right)
      = \bigcup_{i\in I}\alpha(\overline{f}_i)
      &\textand
      \alpha(\overline{f}_i\cap\overline{f}_j)
      = \alpha(\overline{f}_i)\cap\alpha(\overline{f}_j),
    \\\beta\left(\bigcup_{i\in I}\overline{f}_i\right)
      = \bigcup_{i\in I}\beta(\overline{f}_i)
      &\textand
      \beta(\overline{f}_i\cap\overline{f}_j)
      = \beta(\overline{f}_i)\cap\beta(\overline{f}_j).
    \end{aligned}
  \]
  So conditions~(I\textsubscript{1}) and (I\textsubscript{2}) are satisfied.
  Let
  \[
    \overline{g}_i
    = (S''_i,g_i,S'_i)
    < \overline{g}
    = (S'',g,S')
  \]
  be such that $\overline{g}_i\smallbullet\overline{f}_i$ and $\overline{g}\smallbullet\overline{f}$ are defined;
  since $g_i\smallbullet f_i<g\smallbullet f$, we also have that $\overline{g}_i\smallbullet\overline{f}_i<\overline{g}\smallbullet\overline{f}$.
  From the relations
  \[
    \overline{g}_i\smallbullet\overline{f}_i
    = (S''_i,g_i\smallbullet f_i,S_i),
  \]
  we deduce that
  \[
    \begin{aligned}
      (\overline{g}_i\smallbullet\overline{f}_i)\cap(\overline{g}_j\smallbullet\overline{f}_j)
      &= \big(
        S''_i\cap S''_j,
        (g_i\cap g_j)\smallbullet(f_i\cap f_j),
        S_i\cap S_j
      \big)
    \end{aligned}
  \]
  and
  \[
    \begin{aligned}
      \bigcup_{i\in I}(\overline{g}_i\smallbullet\overline{f}_i)
      &= \left(
        \bigcup_{i\in I}S''_i,
        \bigcup_{i\in I}(g_i\smallbullet f_i),
        \bigcup_{i\in I}S_i
      \right)
    \\&= \left(\bigcup_{i\in I}\overline{g}_i\right)\smallbullet\left(\bigcup_{i\in I}\overline{f}_i\right).
    \end{aligned}
  \]
  Thus $(\CC^l,<)$ is an $\II$-structured category.

  If $(\CC^\smallbullet,<)$ is an inductive category, then the conditions
  \[
    \begin{gathered}
      \overline{f}_i<\overline{f}
    \\\alpha(\overline{f}_i)=\alpha(\overline{f})
      \textand
      \beta(\overline{f}_i)=\beta(\overline{f})
    \end{gathered}
  \]
  imply that $S_i=S$, $S'_i=S'$, and $f_i=f$, whence
  \[
    \overline{f}_i
    = \overline{f}.
  \]
  And so axiom~(I\textquotesingle\!\textsubscript{4}) is also satisfied in $(\CC^l,<)$.

  Finally, if $(\CC^\smallbullet,<)$ is an $\II(\II',\II'')$-structured category, let
  \[
    \overline{h}
    = (S''_1,h,S_1)
    < (S'',g,S')\smallbullet(S',f,S);
  \]
  since
  \[
    h = g'\smallbullet f'
  \]
  where $g'<g$ and $f'<f$, we find that
  \[
    \overline{h}
    = \big(S''_1,g',\alpha(g')\big)\smallbullet\big(\alpha(g'),f',S_1\big);
  \]
  thus $(\CC^l,<)$ is an $\II(\II',\II'')$-structured category.
\end{proof}

\begin{corollary*}
  If $(\CC^\smallbullet,<)$ is an $\II$-structured groupoid, then $(\CC^l,<)$ is an $\II$-structured groupoid.
\end{corollary*}

\begin{proof}
  \oldpage{409}
  Indeed, the condition $(S'_1<f_1,S_1)<(S',f,S)$ implies that $f_1^{-1}<f^{-1}$, whence
  \[
    (S_1,f_1^{-1},S'_1)
    < (S,f^{-1},S').
    \qedhere
  \]
\end{proof}

\begin{definition}{22}
\label{definition:ii-22}
  With the above notation, the $\II$-structured category (resp. the $\II$-structured groupoid) $(\CC^l,<)$ is called the \emph{category of local homomorphisms} (resp. the \emph{groupoid of local homomorphisms}) associated to the $\II$-structured category (resp. to the $\II$-structured groupoid) $(\CC^\smallbullet,<)$.
\end{definition}

\begin{remark}
  The class $\CC^l$ can also be endowed with the composition law
  \[
    (S''_1,f',S'_1)\perp(S',f,S)
    = (S'',f'f,S)
    \quad\text{if and only if}\quad
    S'=S'_1
  \]
  where $f'f$ denotes the pseudo-product of $f'$ and $f$ in $(\CC^\smallbullet,<)$.
  Let $<_\perp$ be the order relation on $\CC^l$ defined by
  \[
    (S'_1,f_1,S_1)
    <_\perp (S',f,S)
    \quad\text{if and only if}\quad
    \big[
      S'=S'_1,
      S=S_1,
      f'<f
    \big].
  \]
\end{remark}

\begin{longcomm}{81.1}
  The original contains the following false proposition:

  \begin{proposition}{26~bis}
    If $(\CC^\smallbullet,<)$ is an $\II$-structured category, then $((\CC^l)^\perp,<_\perp)$ is an $\II$-structured category.
  \end{proposition}

  Indeed, note that (even if $\CC=\MM$)
  \[
    \left(\bigcup_{i\in I}g_i\right)\left(\bigcup_{i\in I}f_i\right)
    = \bigcup_{(i,j)\in I\times I}g_jf_i
    \neq \bigcup_{i\in I}g_if_i.
  \]
\end{longcomm}

Note that, even if $(\CC^\smallbullet,<)$ is an inductive category, then $((C^l)^\perp,<_\perp)$ is not an $\II(\II',\II)$-structured category.

Let $\CC^\smallbullet$ be a groupoid.
Recall (see \cite{3a}) that $(\CC^\smallbullet,<)$ is an inductive groupoid if $(\CC,<)$ is an inductive class and $(\CC^\smallbullet,<)$ is a functorially ordered groupoid.

\begin{theorem}{10}
\label{theorem:ii-10}
  The following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(1)]
      $(\CC^\smallbullet,<)$ is an inductive groupoid.
    \item[\normalfont(2)]
      $(\CC^\smallbullet,<)$ is an $\II((\II'\cap\II'',\II'\cap\II''),\II)$-structured groupoid.
    \item[\normalfont(3)]
      $(\CC^\smallbullet,<)$ is an $\II(\II,\II'\cap\II'')$-structured groupoid.
  \end{enumerate}
\end{theorem}

\begin{proof}
  Conditions~(1) and (2) are equivalent by \cref{proposition:ii-21}.
  \begin{longcomm}{81.2}
    This proof is too short: if $(\CC^\smallbullet,<)$ is an inductive groupoid, it is still necessary to prove that (I\textsubscript{1}) and (I\textsubscript{2}) are satisfied.
    Indeed, with the notation of (I\textsubscript{1}), there exists a morphism $g<f$ with source $\alpha(f')\cap\alpha(f'')$;
    since $\alpha(g)<\alpha(f')$ and $f'=f\alpha(f')$, it follows that $g<f'$;
    also $g<f''$, whence $g<f'\cap f''$.
    But the relation
    \[
      \alpha(f'\cap f'')
      < \alpha(f')\cap\alpha(f'')
      = \alpha(g)
    \]
    implies that $f'\cap f''<g$.
    So $g=f'\cap f''$, and (I\textsubscript{1}) is satisfied.
    For (I\textsubscript{2}), we can similarly prove that $\cup f_i$ is the unique morphism less than $f$ with source $\cup\alpha(f_i)$.
  \end{longcomm}
  We will show the equivalence between conditions~(1) and (3).
  An inductive groupoid is an inductive category in the sense of \cite{3c};
  from Corollary~1 of \cref{theorem:ii-9}, it follows that $(\CC^\smallbullet,<)$ is an $\II(\II,\II'')$-structured category;
  since $f'<f$ implies that $f'^{-1}<f^{-1}$, we see that $(\CC^\smallbullet,<)$ is also an $\II(\II,\II'')$-structured groupoid.
  Furthermore, the relations
  \[
    \begin{gathered}
      g'\smallbullet f'=g\smallbullet f
    \\g'<g
      \textand
      f'<f
    \end{gathered}
  \]
  imply that
  \[
    \alpha(f)=\alpha(f')
    \textand
    \beta(g')=\beta(g),
  \]
  and, by \cref{proposition:ii-20}, we have that $g'=g$ and $f'=f$.
  This proves that $(\CC^\smallbullet,<)$ is an $\II(\II,\II'\cap\II'')$-structured groupoid.
  Conversely, let $(\CC^\smallbullet,<)$ be an $\II(\II,\II'\cap\II'')$-structured groupoid.
  By \cref{proposition:ii-18} and Corollary~1 of \cref{theorem:ii-9}, $(\CC^\smallbullet,<)$ is an inductive category in the sense of \cite{3c}.
  \oldpage{410}
  It remains only to prove that the conditions $g<e$ and $e\in\CC_0^\smallbullet$ imply that $g\in\CC_0^\smallbullet$.
  Indeed, we have that
  \[
    \alpha(g)<e
    \textand
    \beta(g)<e
  \]
  i.e., using condition~(I\textsubscript{2}),
  \[
    \begin{aligned}
      \big(\beta(g)\cap g\big)\smallbullet\big(g\cap\alpha(g)\big)
      &= \big(\beta(g)\smallbullet g\big)\cap\big(g\smallbullet\alpha(g)\big)
    \\&= \beta(g)\smallbullet g;
    \end{aligned}
  \]
  since the map $\chi^\smallbullet$ belongs to $\II'$, it thus follows that $g\cap\alpha(g)=g$, whence
  \[
    g<\alpha(g).
  \]
  From the relations
  \[
    g^{-1}\smallbullet g=\alpha(g)\smallbullet\alpha(g)
    \textand
    g^{-1}<\alpha(g)
  \]
  we also deduce, for the same reason, that
  \[
    g
    = \alpha(g)
    \in \CC_0^\smallbullet.
    \qedhere
  \]
\end{proof}

\begin{remarks}
---
  \begin{enumerate}
    \item[\normalfont(1)]
      Even if $(\CC^\smallbullet,<)$ is an inductive groupoid, the associated groupoid $(\CC^l,<)$ of local isomorphisms is not an inductive groupoid;
      indeed, the conditions $e,S\in\CC_0^\smallbullet$ and $e<S$ imply that $(e,e,S)<(S,S,S)$, even though $(e,e,S)$ is not a unit of $\CC^l$.

    \item[\normalfont(2)]
      For an inductive category $(\CC^\smallbullet,<)$ to be functorially ordered (\cref{definition:ii-19}), it is necessary and sufficient that $(\CC^\smallbullet,<)$ be an $\II(\II',\II'')$-structured category, that $(\CC_\gamma,<)$ be an inductive groupoid (where $\CC_\gamma$ is the groupoid of invertible elements of $\CC^\smallbullet$), and that $\CC_\gamma$ be closed under induction in $\CC$.
      \emph{Example:} the category of surjection.

      \begin{longcomm}{82.2}
        Let us prove that, if $(\CC^\smallbullet,<)$ is functorially ordered, then $\CC_\gamma$ is closed under induction.
        Indeed, let $g$ be an isomorphism and let $g'<g$;
        since $\alpha(g')<\alpha(g)$, there exists (Comment~74.2) an isomorphism $f$ such that $f<g$ and $\alpha(f)=\alpha(g')$.
        Then $g'\smallbullet f^{-1}$ is an identity, because it is less than the identity $g\smallbullet g^{-1}$;
        hence $g'=f$.
      \end{longcomm}
  \end{enumerate}
\end{remarks}


\subsection{General theorems on structured categories}
\label{section:ii.7}

All throughout this section, we suppose that the category of homomorphisms $(\MM,p,\HH,\Gamma)$ with finite products is right solving.\comm{82.3}{So $p\colon\HH\to\MM$ is a concrete functor creating canonical finite products and equalisers.}
$\HH'$ and $\HH''$ denote subcategories of $\HH$ that contain $\Gamma$.

\begin{proposition}{27}
\label{proposition:ii-27}
  For $(\CC^\smallbullet,s)$ to be an $\HH$-structured category, it is necessary and sufficient that the following conditions be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $\CC^\smallbullet$ is a category, $s\in\HH_0$, and $p(s)=\CC$.
    \item[\normalfont(2)]
      $(s,\alpha,s),(s,\beta,s)\in\HH$.
    \item[\normalfont(3)]
      The conditions $(s\times s,\iota,s')\in\HH$ and $p(s')=\CC^\smallbullet\star\CC^\smallbullet$ imply that $(s,\chi^\smallbullet,s')\in\HH$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  These conditions are necessary;
  indeed, if $s'\subs s\times s$ and $p(s')=\CC^\smallbullet\star\CC^\smallbullet$, let $s''\in\HH_0$ be such that $p(s'')=\CC^\smallbullet\star\CC^\smallbullet$ and $(s\times s,\iota,s'')\in\HH$.
  By the definition of a substructure, we also have that $(s',\iota,s'')\in\HH$, and so $(s,\chi^\smallbullet,s'')\in\HH$.
  We will now show that the conditions are sufficient.
  \oldpage{411}
  By axiom~(R) of \cref{definition:i-9}~(\cref{section:i}), the pair $((s,\alpha,s),(s,\iota,s))$ admits a $p$-kernel $s_0\subs s$ such that $p(s_0)$ is the class of $f\in\CC$ for which $f=\alpha(f)$, i.e. $p(s_0)=\CC_0^\smallbullet$.
  Since
  \[
    \alpha(p(s))=\CC_0^\smallbullet
    \textand
    \beta(p(s))=\CC_0^\smallbullet
  \]
  we also have that
  \[
    (s_0,\alpha,s)\in\HH
    \textand
    (s_0,\beta,s)\in\HH
  \]
  which proves that axiom~(1) of $\HH$-structured categories is satisfied.
  Let $p_1$ and $p_2$ be the canonical projections from $p(s)\times p(s)$ to $p(s)$;
  we have that
  \[
    (s,\alpha p_1,s\times s)
    = (s\alpha,s)\smallbullet(s,p_1,s\times s)
    \in\HH
    \textand
    (s,\beta p_2,s\times s)
    \in\HH.
  \]
  Axiom~(R) in \cref{definition:i-9} ensures that the pair $((s,\alpha p_1,s\times s),(s,\beta p_2,s\times s))$ admits a $p$-kernel $s'\subs s\times s$ such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$.
  Thus $(\CC^\smallbullet,s)$ is an $\HH$-structured category.
\end{proof}

\begin{proposition}{28}
\label{proposition:ii-28}
  Suppose that $\HH'$ satisfies condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}).
  For $(\CC^\smallbullet,s)$ to be an $\HH(\HH',\HH'')$-structured category (resp. an $\HH((\HH',\HH'),\HH'')$-structured category), it is necessary and sufficient that the following conditions be satisfied:
  \begin{enumerate}
    \item[\normalfont(1)]
      $\CC^\smallbullet$ is a category, $s\in\HH_0$, and $p(s)=\CC$.
    \item[\normalfont(2)]
      $(s\times s,[\beta,\alpha],s)\in\HH'$ (resp. $(s,\alpha,s),(s,\beta,s)\in\HH'$).
    \item[\normalfont(3)]
      If $s'\subs s\times s$ and $p(s')=\CC^\smallbullet\star\CC^\smallbullet$, then $(s,\chi,s')\in\HH''$.
  \end{enumerate}
\end{proposition}

\begin{proof}
  Suppose that $(\CC^\smallbullet,s)$ is an $\HH(\HH',\HH'')$-structured category.
  By \cref{proposition:i-5} and \cref{proposition:ii-27}, there exists $s_0\subs s$ such that
  \[
    p(s_0)=\CC_0^\smallbullet
    \textand
    (s_0\times s_0,[\beta,\alpha],s)
    \in\HH'.
  \]
  By \cref{proposition:ii-3}, we have that $s_0\times s_0\subs s\times s$, and so, with the help of condition~($\sigma$), we find that $s_0\times s_0\subs s\times s$ in $\HH'$, and
  \[
    (s\times s, [\beta,\alpha], s)
    \in\HH'.
  \]
  Thus conditions~(1), (2), and (3) are necessary.

  We now show that these conditions are sufficient.
  An analogous argument to that in the proof of \cref{proposition:ii-27} shows that, in $\HH$, there exist
  \[
    \begin{aligned}
      s_0\subs s
      &\quad\text{such that}\quad
      p(s_0)=\CC_0^\smallbullet
    \\s'\subs s\times s
      &\quad\text{such that}\quad
      p(s')=\CC^\smallbullet\star\CC^\smallbullet.
    \end{aligned}
  \]
  Then axiom~(2) of \cref{definition:ii-3} is satisfied.
  Furthermore, since $s_0\times s_0\subs s\times s$ in $\HH'$, we see, using condition~(2), that
  \[
    (s_0\times s_0,[\beta,\alpha],s)
    \in\HH'.
  \]
  The $\HH((\HH',\HH'),\HH'')$-structured case is dealt with in an analogous way.
\end{proof}

\begin{corollary*}
  \oldpage{412}
  If $\HH'$ and $\HH''$ satisfy condition~($\sigma$) then, for $(\CC^\smallbullet,s)$ to be an $\HH((\HH',\HH'),\HH'')$-structured groupoid it is necessary and sufficient that it satisfy conditions~(1) and (3) of \cref{proposition:ii-28} as well as the following conditions:
  \begin{enumerate}
    \item[\normalfont(2\textquotesingle)]
      $(s,\alpha,s)\in\HH'$.
    \item[\normalfont(4)]
      $\CC^\smallbullet$ is a groupoid, and $(s,j,s)\in\HH$, where $j$ denotes the map $f\mapsto f^{-1}$ for $f\in\CC$.
  \end{enumerate}
\end{corollary*}

\begin{proof}
  The conditions are evidently necessary.
  Conversely, if they are satisfied, then\comm{84.1}{This is true since (4) implies that $(s,j,s)\in\Gamma$, and $\HH'$ contains $\Gamma$.}
  \[
    (s,\beta,s)
    = (s,\alpha,s)\smallbullet(s,j,s)
    \in\HH'
  \]
  and so condition~(2) of \cref{proposition:ii-28} is also satisfied.
\end{proof}

\begin{proposition}{29}
\label{proposition:ii-29}
  If $\HH'$ is stable under products and satisfies condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}), then $\overline{\HH}((\HH',\HH'),\HH'')$ is a full subcategory of $\overline{\HH}(\HH',\HH'')$.
\end{proposition}

\begin{proof}
  Let $s\in\HH_0$.
  By axiom~(R) of \cref{definition:i-9}~(\cref{section:i}), the pair $((s,p_1,s\times s),(s,p_2,s\times s))$, where $p_1$ and $p_2$ are the canonical projections from $p(s)\times p(s)$ to $p(s)$, admits a $p$-kernel $s^1\subs s\times s$ such that $p(s^1)$ is the diagonal $\Delta$ of $p(s)\times p(s)$.
  Suppose that $(\CC^\smallbullet,s)\in\overline{\HH}((\HH',\HH'),\HH'')_0$.
  The relations $(s,\alpha,s),(s,\beta,s)\in\HH'$ imply that
  \[
    (s\times s, \beta\times\alpha, s\times s)
    \in\HH'.
  \]
  Since $\HH'$ satisfies condition~($\sigma$), we have that
  \[
    (s\times s,\iota,s^1)\in\HH'
  \]
  whence
  \[
    (s\times s,[\beta,\alpha],s^1)
    = (s\times s,\beta\times\alpha,s\times s)
    \in\HH'.
  \]
  Thus $(\CC^\smallbullet,s)$ is an $\HH(\HH',\HH'')$-structured category, which proves the proposition, since $(s^1,[\iota,\iota],s)\in\Gamma$ (see \cref{theorem:ii-12}).
\end{proof}

In the following, we use the notation of \cref{section:ii.2}

\begin{theorem}{11}
\label{theorem:ii-11}
  $(\HH,\overline{p}_\HH,\overline{\HH}(\HH',\HH''),\overline{\Gamma})$ and $(\HH,\overline{p}_\HH,\overline{\GG}(\HH',\HH''),\overline{\Gamma}_\GG)$ are categories of homomorphisms, saturated over $\HH$.
\end{theorem}

\begin{proof}
  The only point to prove is that the conditions
  \[
    (\CC^\smallbullet,s)\in\overline{\HH}(\HH',\HH'')
    \textand
    (\overline{s},F,s)\in\Gamma
  \]
  imply the existence of $(\overline{\CC}^\smallbullet,\overline{s})$ such that
  \[
    \big((\overline{\CC}^\smallbullet,\overline{s}),F,(\CC^\smallbullet,s)\big)
    \in\overline{\Gamma}.
  \]
  Since $\FF$ is saturated over $\MM$, there exists $\overline{\CC}^\smallbullet$ such that
  \[
    (\overline{\CC}^\smallbullet,F,\CC^\smallbullet)
    \in\overline{\FF}_\gamma.
  \]
  \oldpage{413}
  Let $s_0\subs s$ be such that $p(s_0)=\CC_0^\smallbullet$.
  Since $s_0$ is a $p$-kernel (see the proof of \cref{proposition:ii-28}), by \cref{proposition:i-16}~(\cref{section:i}), there exists
  \[
    \overline{s}_0\subs\overline{s}
    \quad\text{such that}\quad
    (\overline{s}_0,F\iota,s_0)
    \in\Gamma;
  \]
  we then have that $p(\overline{s}_0)=\overline{\CC}_0^\smallbullet$.
  Since $\HH'$ contains $\Gamma$, we find that
  \[
    (\overline{s}_0\times\overline{s}_0,[\overline{\beta},\overline{\alpha}],\overline{s})
    = (\overline{s}_0\times\overline{s}_0,F\iota\times F\iota,s_0\times s_0)\smallbullet(s_0\times s_0,[\beta,\alpha],s)\smallbullet(s,F^{-1},\overline{s})
    \in\HH'
  \]
  where $\overline{\alpha}$ and $\overline{\beta}$ denote the source and target maps in $\overline{\CC}_0^\smallbullet$ (respectively).
  Let $s'\subs s\times s$ be such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$.
  Using the relation
  \[
    (\overline{s}\times\overline{s},F\times F,s\times s)
    \in\Gamma,
  \]
  \cref{proposition:i-16}~(\cref{section:i}) ensures the existence of $\overline{s}'\subs\overline{s}\times\overline{s}$ such that
  \[
    (\overline{s}',(F\times F)\iota,s')\in\Gamma
    \textand
    p(\overline{s}')=\overline{\CC}^\smallbullet\star\overline{\CC}^\smallbullet.
  \]
  Consequently,
  \[
    (\overline{s},\overline{\chi}^\smallbullet,\overline{s}')
    = (\overline{s},F,s)\smallbullet(s,\chi^\smallbullet,s')\smallbullet(\overline{s}',(F\times F)\iota,s')^{-1}
    \in\HH''.
  \]
  It thus follows that
  \[
    (\overline{\CC}^\smallbullet,\overline{s})\in\overline{\HH}(\HH',\HH'')
    \textand
    \big((\overline{\CC}^\smallbullet,\overline{s}),F,(\CC^\smallbullet,s)\big)\in\overline{\HH}(\HH',\HH'').
  \]
  If, further, $(\CC^\smallbullet,s)\in\overline{\GG}(\HH',\HH'')_0$, then
  \[
    (\overline{s},\overline{j},\overline{s})
    = (\overline{s},F,s)\smallbullet(s,j,s)\smallbullet(s,F^{-1},\overline{s})
    \in\Gamma
  \]
  where $j$ and $\overline{j}$ denote the map $f\mapsto f^{-1}$ in $\CC^\smallbullet$ and $\overline{\CC}^\smallbullet$ (respectively).
  Thus
  \[
    \big((\overline{\CC}^\smallbullet,\overline{s}),F,(\CC^\smallbullet,s)\big)
    \in\overline{\GG}(\HH',\HH'').
    \qedhere
  \]
\end{proof}

\begin{corollary*}
  $(\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma})$ and $(\MM,p_\FF\overline{p},\overline{\GG}(\HH',\HH''),\overline{\Gamma}_\GG)$ are categories of homomorphisms.
\end{corollary*}

\begin{proof}
  Suppose that we have
  \[
    \big((\overline{\CC}^\smallbullet,\overline{s}),F,(\CC^\smallbullet,s)\big)
    \in\overline{\Gamma}
    \textand
    (\CC^\perp,s_1)
    \in\overline{\HH}(\HH',\HH'')_0.
  \]
  Since $(\MM,p,\Gamma)$ is a species of structures, there exists $\overline{s}_1\in\HH_0$ such that
  \[
    (\overline{s}_1,F,s_1)
    \in\Gamma,
  \]
  and it follows from \cref{theorem:ii-11} that we then have that
  \[
    \big((\overline{\CC}^\perp,\overline{s}_1),F,(\CC^\perp,s_1)\big)
    \in\overline{\Gamma}.
    \qedhere
  \]
\end{proof}

\begin{theorem}{12}
\label{theorem:ii-12}
  \[
    (\HH,\overline{p}_\HH,\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}')
    \textand
    (\HH,\overline{p}_\HH,\overline{\GG}((\HH',\HH'),\HH''),\overline{\Gamma}'_\GG)
  \]
  are categories of homomorphisms, saturated over $\HH$;
  \oldpage{414}
  \[
    (\MM,p_\FF\overline{p},\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}')
    \textand
    (\MM,p_\FF\overline{p},\overline{\GG}((\HH',\HH'),\HH''),\overline{\Gamma}'_\GG)
  \]
  are categories of homomorphisms, and $\HH$ can be identified with a full subcategory of $\overline{\HH}((\HH',\HH'),\HH'')$.
\end{theorem}

\begin{proof}
  The first part of this theorem is proven in an analogous manner to \cref{theorem:ii-11}.
  Let $s\in\HH_0$ and set $\CC=p(s)$.
  We endow $\CC$ with the (trivial) composition law
  \[
    (f',f)\longmapsto f'\smallbullet f=f
    \quad\text{if and only if}\quad
    f'=f.
  \]
  We have that $(s,\alpha,s)\in\Gamma$, since $\alpha(f)=f$ for all $f\in\CC$.
  By axiom~(R) of \cref{definition:i-9}~(\cref{section:i}), there exists $s'\subs s\times s$ such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$ is equal to the diagonal $\Delta$ of $\CC\times\CC$.
  The relations
  \[
    (s\times s,[\iota,\iota],s)\in\HH
    \textand
    [\iota,\iota](\CC)=\Delta
  \]
  imply that $(s',[\iota,\iota],s)\in\HH$.
  Also, $(s,p_1\iota,s')\in\HH$, where $p_1$ is the projection from $p(s)\times p(s)$ to $p(s)$.
  From the equalities
  \[
    (s',[\iota,\iota],s)\smallbullet(s,p_1\iota,s')=s'
    \textand
    (s,p_1\iota,s')\smallbullet(s',[\iota,\iota],s)=s
  \]
  it follows that
  \[
    (s,\chi^\smallbullet,s')
    = (s,p_1\iota,s')
    \in\Gamma.
  \]
  Thus $(\CC^\smallbullet,s)$ is an $\overline{\HH}((\Gamma,\Gamma),\Gamma)$-structured category.
  Finally, the map
  \[
    (\overline{s},g,s)
    \longmapsto \big((p(\overline{s}),\overline{s}),g,(p(s),s)\big)
  \]
  is an isomorphism from $\HH$ to a full subcategory of $\overline{\HH}((\HH',\HH'),\HH'')$.\comm{86.3}{Let $|\cdot|\colon\overline{\HH}((\HH',\HH'),\HH'')\to\HH$ be the non-faithful functor mapping $F(\CC'^\smallbullet,s')\to(\CC''^\smallbullet,s'')$ to its restriction $F_0\colon s'_0\to s_0''$ to the objects; this functor admits a left adjoint, which maps $s$ onto the \emph{discrete structured category $(\CC^\smallbullet,s)$}.}
\end{proof}

\begin{theorem}{13}
\label{theorem:ii-13}
  If $\HH'$ and $\HH''$ are subcategories of $\HH$ that are stable under products, then the categories of homomorphisms
  \[
    (\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma})
    \textand
    (\MM,p_\FF\overline{p},\overline{\GG}(\HH',\HH''),\overline{\Gamma}_\GG)
    \textand
    (\MM,p_\FF\overline{p},\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}')
  \]
  are categories of homomorphisms with finite products.
\end{theorem}

\begin{proof}
  Since $\FF$ and $\HH$ are categories of homomorphisms with finite limits over $\MM$, to show that $(\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma})$ is a category of homomorphisms with finite products, the only point to prove is that the relations
  \[
    (\CC^\smallbullet,s),(\overline{\CC}^\smallbullet,\overline{s})
    \in\overline{\HH}(\HH',\HH'')_0
  \]
  imply that
  \[
    (\CC^\smallbullet\times\overline{\CC}^\smallbullet,s\times\overline{s})
    \in\overline{\HH}(\HH',\HH'')_0.
  \]
  By \cref{proposition:ii-3}, we have that
  \[
    s_0\times\overline{s}_0\subs s\times\overline{s}
    \textand
    p(s_0\times\overline{s}_0)=(\CC^\smallbullet\times\overline{\CC}^\smallbullet)_0.
  \]
  \oldpage{415}
  Since
  \[
    (s_0\times s_0,[\beta,\alpha],s),(\overline{s}_0\times \overline{s}_0,[\overline{\beta},\overline{\alpha}],\overline{s})
    \in\HH'
  \]
  we also have that
  \[
    \big(
      (s_0\times s_0)\times(\overline{s}_0\times\overline{s}_0),
      [\beta,\alpha]\times[\overline{\beta}\times\overline{\alpha}],
      s\times\overline{s}
    \big)\in\HH'.
  \]
  By \cref{proposition:ii-4}, there exists
  \[
    \big(
      (s_0\times\overline{s}_0)\times(s_0\times\overline{s}_0),
      \gamma,
      (s_0\times s_0)\times(\overline{s}_0\times\overline{s}_0)
    \big)\in\Gamma
  \]
  such that
  \[
    \gamma\big((f',f),(\overline{f}',\overline{f})\big)
    = \big((f',\overline{f}'),(f,\overline{f})\big);
  \]
  whence
  \[
    \begin{aligned}
      &\big(
        (s_0\times\overline{s}_0)\times(s_0\times\overline{s}_0),
        \gamma([\beta,\alpha]\times[\overline{\beta},\overline{\alpha}]),
        s\times\overline{s})
      \big)
    \\= &\big(
        (s_0\times\overline{s}_0)\times(s_0\times\overline{s}_0),
        [\beta\times\overline{\beta},\alpha\times\overline{\alpha}],
        s\times\overline{s})
      \big)
      \in\HH'.
    \end{aligned}
  \]
  There also exists $s''\subs(s\times\overline{s})\times(s\times\overline{s})$ such that\comm{87.1}{Indeed, $s''$ is the $p$-kernel of $(\alpha\times\overline{\alpha}),(\beta\times\overline{\beta})\colon s\times\overline{s}\to s\times\overline{s}$.}
  \[
    p(s'')
    = (\CC^\smallbullet\times\overline{\CC}^\smallbullet)\star(\CC^\smallbullet\times\overline{\CC}^\smallbullet).
  \]
  From \cref{proposition:ii-4} and \cref{proposition:ii-7} it follows that
  \[
    \big(
      (s\times\overline{s})\times(s\times\overline{s}),
      \gamma,
      (s\times s)\times(\overline{s}\times\overline{s})
    \big)\in\Gamma
    \textand
    (s'',\gamma\iota,s'\times\overline{s}')\in\Gamma;
  \]
  since $\HH''$ is stable under products, from the relations
  \[
    (s,\chi^\smallbullet,s'),
    (\overline{s},\overline{\chi}^\smallbullet,\overline{s}')
    \in\HH''
  \]
  we deduce that
  \[
    \big(
      s\times\overline{s},
      (\chi^\smallbullet\times\overline{\chi}^\smallbullet)(\gamma\iota)^{-1},
      s''
    \big)
    \in\HH''.
  \]
  Thus $(\CC^\smallbullet\times\overline{\CC}^\smallbullet,s\times\overline{s})$ is an $\HH(\HH',\HH'')$-structured category.
\end{proof}

\begin{remark}
  The proof of this theorem can easily be modified if we suppose $\HH$ to be saturated over $\MM$ instead of supposing $(\MM,p,\HH,\Gamma)$ to be right solving.
  Indeed, in this case, \cref{proposition:i-15}~(\cref{section:i}) ensures the existence of $s''\subs(s\times\overline{s})\times(s\times\overline{s})$ such that
  \[
    p(s'')=(\CC^\smallbullet\times\overline{\CC}^\smallbullet)\star(\CC^\smallbullet\times\overline{\CC}^\smallbullet)
    \textand
    (s'',\gamma\iota,s'\times\overline{s}')\in\Gamma.
  \]
\end{remark}

The above remark allows us to state, using \cref{theorem:ii-3}:

\begin{theorem}{13~bis}
\label{theorem:ii-13bis}
  If $\HH$ is saturated over $\MM$, and if $\HH'$ and $\HH''$ are stable under products, then
  \[
    (\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma})
    \textand
    (\MM,p_\FF\overline{p},\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}')
  \]
  are categories of homomorphisms with finite products, even if $(\MM,p,\HH,\Gamma)$ is not right solving.
\end{theorem}

\begin{theorem}{14}
\label{theorem:ii-14}
  Suppose that $\HH'$ and $\HH''$ satisfy condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}).
  Let $(\CC^\smallbullet,s)$ be an $\HH(\HH',\HH'')$-structured category (resp. an $\HH(\HH',\HH'')$-structured groupoid).
  Let $\overline{s}\subs s$ be such that $p(\overline{s})$ is a subcategory (resp. a subgroupoid) $\overline{C}$ of $\CC^\smallbullet$.
  \oldpage{416}
  Then $(\overline{\CC}^\smallbullet,\overline{s})$ is an $\HH(\HH',\HH'')$-structured subcategory (resp. an $\HH(\HH',\HH'')$-structured subgroupoid) of $(\CC^\smallbullet,s)$.

  Furthermore, we can replace $\HH(\HH',\HH'')$ by $\HH((\HH',\HH'),\HH'')$ in this statement.
\end{theorem}

\begin{proof}
  Using condition~($\sigma$) and \cref{proposition:ii-3}, the relations $\overline{s}\subs s$ and
  \[
    (s\times s,[\beta,\alpha]\iota,\overline{s})\in\HH'
    \textand
    [\beta,\alpha](\overline{\CC})\subset\overline{\CC}\times\overline{\CC}
  \]
  imply that $\overline{s}\times\overline{s}\subs s\times s$ and
  \[
    (\overline{s}\times\overline{s},[\beta,\alpha]\iota,\overline{s})
    = (\overline{s}\times\overline{s},[\overline{\beta},\overline{\alpha}],\overline{s})
    \in\HH'
  \]
  where $\overline{\alpha}$ and $\overline{\beta}$ denote the source and target maps in $\overline{\CC}^\smallbullet$ (respectively).
  Now, suppose also that
  \[
    \begin{gathered}
      s'\subs s\times s,
      \quad
      \overline{s}'\subs\overline{s}\times\overline{s},
    \\p(s')=\CC^\smallbullet\star\CC^\smallbullet,
      \quad
      p(\overline{s}')=\overline{\CC}^\smallbullet\star\overline{\CC}^\smallbullet.
    \end{gathered}
  \]
  By \cref{proposition:ii-3} and \cref{theorem:i-1}~(\cref{section:i}), we have that
  \[
    \overline{s}\times\overline{s}\subs s\times s
    \textand
    \overline{s}'\subs s';
  \]
  since
  \[
    (s,\overline{\chi}^\smallbullet,s')
    = (s,\chi^\smallbullet,s')\smallbullet(s',\iota,\overline{s}')
    \in\HH
    \textand
    \chi^\smallbullet(p(\overline{s}'))
    \subset\overline{\CC}
  \]
  we find that $(\overline{s},\overline{\chi}^\smallbullet,\overline{s}')\in\HH$, where $\overline{\chi}^\smallbullet$ is the restriction of $\chi^\smallbullet$ to $\overline{\CC^\smallbullet}\star\overline{\CC^\smallbullet}$.
  Thus $(\overline{\CC}^\smallbullet,\overline{s})$ is an $\HH(\HH',\HH'')$-structured category, and
  \[
    \big(
      (\CC^\smallbullet,s),
      \iota,
      (\overline{\CC}^\smallbullet,\overline{s})
    \big)
    \in\overline{\HH}(\HH',\HH'').
  \]
  From the relations
  \[
    \big(
      (\CC^\smallbullet,s),
      g,
      (\SS^\smallbullet,\sigma)
    \big)
    \in\overline{\HH}(\HH',\HH'')
    \textand
    g(p(\sigma))
    \subset\overline{\CC},
  \]
  we deduce that
  \[
    (\overline{\CC}^\smallbullet,g,\SS^\smallbullet)\in\FF
    \textand
    (\overline{s},g,\sigma)\in\HH,
  \]
  whence
  \[
    \big(
      (\CC^\smallbullet,s),
      g,
      (\SS^\smallbullet,\sigma)
    \big)
    \in\overline{\HH}(\HH',\HH'')
    \textand
    (\overline{\CC}^\smallbullet,\overline{s})
    \subs_{\overline{p}} (\CC^\smallbullet,s).
  \]

  The same proof applies for $\HH((\HH',\HH',\HH''))$-structured categories.
\end{proof}

\begin{corollary}{1}
  If $\HH'$ and $\HH''$ satisfy condition~($\sigma$), then the following conditions are equivalent:
  \begin{enumerate}
    \item[\normalfont(1)]
      $(\overline{\CC}^\smallbullet,\overline{s})\subs_{\overline{p}}(\CC^\smallbullet,s)$ in $\overline{\HH}(\HH',\HH'')$ (resp. in $\overline{\GG}(\HH',\HH'')$) and there exists $\overline{s}^1\subs_p s$ such that $p(\overline{s}^1)=\overline{\CC}$.

    \item[\normalfont(2)]
      $(\CC^\smallbullet,s)\in\overline{\HH}(\HH',\HH'')_0$, $\overline{\CC}$ is a subcategory (resp. a subgroupoid) of $\CC^\smallbullet$, and $\overline{s}\subs_p s$ in $\HH$ with $p(\overline{s})=\overline{\CC}$.
  \end{enumerate}
\end{corollary}

\begin{proof}
  \oldpage{417}
  If condition~(1) is satisfied, then
  \[
    (\overline{\CC}^\smallbullet,\overline{s})\subs_{\overline{p}}(\CC^\smallbullet,s)
    \textand
    (\overline{\CC}^\smallbullet,\overline{s}^1)\subs_{\overline{p}}(\CC,s)
  \]
  so
  \[
    (\overline{\CC}^\smallbullet,\overline{s})=(\overline{\CC}^\smallbullet,\overline{s}^1)
    \textand
    \overline{s}=\overline{s}^1.
    \qedhere
  \]
\end{proof}

\begin{corollary}{2}
  If $\HH'$ and $\HH''$ satisfy condition~($\sigma$), then the categories of homomorphisms
  \[
    \begin{gathered}
      \big(\FF,\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma}\big),
      \quad
      \big(\FF,\overline{p},\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}'\big),
      \quad
      (\FF,\overline{p},\overline{\GG},\overline{\Gamma}_\GG),
    \\\big(\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma}\big)
      \textand
      \big(\MM,p_\FF\overline{p},\overline{\HH}((\HH',\HH'),\HH''),\overline{\Gamma}'\big)
    \end{gathered}
  \]
  are right solving.
\end{corollary}

\begin{proof}
  This corollary follows from \cref{theorem:ii-14}, \cref{proposition:i-14}~(\cref{section:i}), and the fact that $(\MM,p_\FF,\FF,\FF_\gamma)$ and $(\MM,p,\HH,\Gamma)$ are right solving.
\end{proof}

\begin{remarks}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      In general, $(\overline{\CC}^\smallbullet,\overline{s})\subs_{\overline{p}}(\CC^\smallbullet,s)$ does not imply that $\overline{s}\subs_p s$.
      This is the case, however, if $(\MM,p,\HH,\Gamma)$ satisfies the following condition:
      \begin{quote}
        If $(S,\iota,s')\in\HH$ then there exists $s\subs S$ such that $p(s)=p(s')$.
      \end{quote}
      In particular, $\FF$, $\widetilde{\TT}$, and $\II$ satisfy this condition.

    \item[\normalfont(2)]
      In \cref{theorem:ii-14}, the hypothesis that $\HH'$ and $\HH''$ satisfy condition~($\sigma$) is necessary.
      For example, let $(\CC^\smallbullet,<)$ be an inductive groupoid;
      a subgroupoid of $\CC^\smallbullet$ that is a weakly inductive subclass of $(\CC,<)$ cannot be an inductive subgroupoid of $(\CC^\smallbullet,<)$.
      A substructure of $(\CC^\smallbullet,<)$ in $\overline{\II}(\II,\II'')$ or in $\overline{\II}((\II'\cap\II'',\II'\cap\II''),\II)$ is a subgroupoid of $\overline{\CC}^\smallbullet$ that satisfies the following conditions:
      \begin{enumerate}
        \item[\normalfont(a)]
          $\overline{\CC}$ is a weakly sub-inductive subset of $(\CC,<)$;
        \item[\normalfont(b)]
          If $f\in\overline{\CC}$ and $e\in\overline{\CC}_0$ with $e<\alpha(f)$, then $fe\in\overline{\CC}$.
      \end{enumerate}

    \item[\normalfont(3)]
      By \cref{proposition:i-14}~(\cref{section:i}), for $(\CC_1^\smallbullet,s_1)$ to be an $\HH(\HH',\HH'')$-structured subcategory of $(\CC^\smallbullet,s)$, it is necessary and sufficient that $(\CC_1^\smallbullet,s_1)\subs(\CC^\smallbullet,s)$ in $(\MM,p_\FF\overline{p},\overline{\HH}(\HH',\HH''),\overline{\Gamma})$.
  \end{enumerate}
\end{remarks}

For the rest of this section, we will suppose that $\HH'$ is a subcategory of $\HH$ that is stable under products and that satisfies condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}).
The canonical projection from a product class $e_1\times e_2$ to $e_i$ will be denoted (or eventually $p'_i$, to avoid confusion) for $i=1,2$.

Let $(\CC^\smallbullet,s)$ be an $\HH$-structured category.
Using axiom~(R) of \cref{definition:i-9}~(\cref{section:i}) along with \cref{proposition:ii-4}, we can construct the following elements:
\begin{enumerate}
  \item[\normalfont(a)]
    $s_\alpha\subs s_0\times s$ such that $p(s_\alpha)$ is the class of pairs $(\alpha(f),f)$;
    we have that
    \[
      \begin{aligned}
        \gamma_\alpha
        &= (s,p_2\iota,s_\alpha)
        = (s,p_2,s_0\times s)\smallbullet(s_0\times s,\iota,s_\alpha)
        \in\HH
      \\\overline{\gamma}_\alpha
        &= (s_\alpha,\alpha\times\iota,s\times s)\smallbullet(s\times s,[\iota,\iota],s)
        \in\HH
      \end{aligned}
    \]
    \oldpage{418}
    whence
    \[
      \overline{\gamma}_\alpha\smallbullet\gamma_\alpha = s_\alpha
      \textand
      \gamma_\alpha\smallbullet\overline{\gamma}_\alpha = s
    \]
    i.e. $\gamma_\alpha\in\Gamma$.

  \item[\normalfont(b)]
    $s'_\alpha\subs s\times s_0$ such that $p(s'_\alpha)$ is the class of pairs $(f,\alpha(f))$;
    we have that
    \[
      \gamma'_\alpha
      = (s,p_1\iota,s'_\alpha)
      \in\Gamma.
    \]

  \item[\normalfont(c)]
    $s_\beta\subs s_0\times s$ (resp. $s'_\beta\subs s\times s_0$) such that $p(s_\beta)$ (resp. $p(s'_\beta)$) is the class of pairs $(\beta(f),f)$ (resp. $(f,\beta(f))$);
    we have that
    \[
      \gamma_\beta = (s,p_2\iota,s_\beta) \in \Gamma
      \textand
      \gamma'_\beta = (s,p_1\iota,s'_\beta) \in \Gamma.
    \]

  \item[\normalfont(d)]
    $s_{\beta\alpha}\subs s_0\times(s_0\times s)$ such that $p(s_{\beta\alpha})$ is the class of pairs $(\beta(f),(\alpha(f),f))$;
    we have that
    \[
      \gamma_{\beta\alpha}
      = (s,p_2p'_2\iota,s_{\beta\alpha})
      \in\Gamma.
    \]
\end{enumerate}

\begin{proposition}{30}
\label{proposition:ii-30}
  Let $s\in\HH_0$, and let $\perp$ be the composition law on $p(s)\times p(s)$ defined by
  \[
    (x'',x'_1)\perp(x',x) = (x'',x)
    \quad\text{if and only if}\quad
    x'_1 = x'.
  \]
  Then $((p(s)\times p(s))^\perp, s\times s)$ is an $\HH(\Gamma,\HH)$-structured groupoid.\comm{90.1}{This \emph{``indiscrete'' structured groupoid} is a cofree object generated by $s$ with respect to the functor $|\cdot|\colon\overline{\HH}(\HH',\HH)\to\HH$ (cf. Comment~86.3).}
\end{proposition}

\begin{proof}
  Set $p(s)=\CC$.
  The class of units of $(\CC\times\CC)^\perp$ can be identified with the diagonal $\Delta$ of $\CC\times\CC$.
  Let $s_0\subs s\times s$ be such that $p(s_0)=\Delta$;
  we have that (see the proof of \cref{theorem:ii-12})
  \[
    (s_0,[\iota,\iota],s)
    \in \Gamma
  \]
  whence
  \[
    (s_0\times s_0,[\beta^\perp,\alpha^\perp],s\times s)
    = (s_0\times s_0,[\iota,\iota]\times[\iota,\iota],s\times s)
    \in\Gamma.
  \]
  Let $s'^\perp\subs(s\times s)\times(s\times s)$ be such that
  \[
    p(s'^\perp)
    = (\CC\times\CC)^\perp\star(\CC\times\CC)^\perp;
  \]
  then
  \[
    (s\times s,\chi^\perp,s'^\perp)
    = (s\times s,[p_1p'_1,p_2p'_2]\iota,s'^\perp)
    \in\HH
  \]
  where $p'_i$ are the canonical projections from $(s\times s)\times(s\times s)$ to $s\times s$, and $p_i$ the canonical projections from $s\times s$ to $s$, for $i=1,2$.
  So
  \[
    \big((\CC\times\CC)^\perp,s\times s\big)
    \in\overline{\HH}(\Gamma,\HH).
  \]
  Finally, it follows from \cref{proposition:ii-4} that
  \[
    (s\times s,j,s\times s)\in\Gamma
  \]
  where $j(x',x)=(x,x')$.
  Thus $((\CC\times\CC)^\perp,s\times s)$ is an $\HH(\Gamma,\HH)$-structured groupoid.
\end{proof}

\begin{theorem}{15}
\label{theorem:ii-15}
  Let $(\CC^\smallbullet,s)$ and $(\overline{\CC}^\smallbullet,\overline{s})$ be $\HH(\HH',\HH)$-structured categories such that $\CC_0^\smallbullet=\overline{\CC}_0^\smallbullet$ and such that the conditions $s_0\subs s$ and $p(s_0)=\overline{\CC}_0^\smallbullet$ imply that $s_0\subs\overline{s}$.
  \oldpage{419}
  Then there exists $\sq(s,\overline{s})\in\HH_0$ such that
  \[
    \big(\vsq(\CC^\smallbullet,\overline{\CC}^\smallbullet),\sq(s,\overline{s})\big)
    \textand
    \big(\hsq(\CC^\smallbullet,\overline{\CC}^\smallbullet),\sq(s,\overline{s})\big)
  \]
  are $\HH(\HH',\HH)$-structured categories.
\end{theorem}

\begin{proof}
  A quadruple belonging to $\sq(\CC^\smallbullet,\overline{\CC}^\smallbullet)$ can be identified with an element $((f',\overline{f}'),(\overline{f},f))\in(\CC\times\overline{\CC})\times(\overline{\CC}\times\CC)$ such that
  \[
    \left(
      \big(\beta(f'),\overline{\alpha}(\overline{f}')\big),
      \big(\overline{\beta}(\overline{f}),\alpha(f)\big)
    \right)
    =
    \left(
      \big(\overline{\beta}(\overline{f}'),\beta(f)\big),
      \big(\alpha(f'),\overline{\alpha}(\overline{f})\big)
    \right)
  \]
  where $\alpha$ and $\beta$ (resp. $\overline{\alpha}$ and $\overline{\beta}$) denote the source and target maps in $\CC^\smallbullet$ (resp. in $\overline{\CC}^\smallbullet$).
  By \cref{proposition:ii-4}, we have that
  \[
    \begin{aligned}
      \overline{\gamma}
      &= \big(
        (\overline{s}\times s)\times(s\times\overline{s}),
        \gamma,
        (s\times\overline{s})\times(\overline{s}\times s)
      \big)
      \in\Gamma
    \\\overline{\gamma}_0
      &= \big(
        (s_0\times s_0)\times(s_0\times s_0),
        \gamma_0,
        (s_0\times s_0)\times(s_0\times s_0)
      \big)
      \in\Gamma
    \end{aligned}
  \]
  where
  \[
    \gamma\big((f',\overline{f}'),(\overline{f},f)\big)
    = \big((\overline{f}',f),(f',\overline{f})\big);
  \]
  axiom~(R) of \cref{definition:i-9}~(\cref{section:i}) ensures that the pair $(\overline{h}',\overline{h})$, where
  \[
    \begin{aligned}
      \overline{h}
      &= \big(
        (s_0\times s_0)\times(s_0\times s_0),
        (\beta\times\overline{\alpha})\times(\overline{\beta}\times\alpha),
        (s\times\overline{s})\times(\overline{s}\times s)
      \big)
    \\\overline{h}'
      &= \big(
        (s_0\times s_0)\times(s_0\times s_0),
        (\overline{\beta}\times\beta)\times(\alpha\times\overline{\alpha}),
        (\overline{s}\times s)\times(s\times\overline{s})
      \big)\smallbullet\overline{\gamma},
    \end{aligned}
  \]
  admits a $p$-kernel $\sq(s,\overline{s})$ such that $p(\sq(s,\overline{s}))=\sq(\CC^\smallbullet,\overline{\CC}^\smallbullet)$.
  It follows from \cref{theorem:ii-13} that
  \[
    \Sigma
    = \big(
      (\CC\times\CC)^\perp\times(\overline{\CC}^\smallbullet\times\overline{\CC}^\smallbullet),
      (s\times s)\times(s\times s)
    \big)
  \]
  is an $\HH(\HH',\HH)$-structured category, where $(\CC\times\CC)^\perp$ is the category considered in \cref{proposition:ii-30}.
  By \cref{proposition:ii-4}, we have that
  \[
    \overline{\gamma}'
    = \big(
      (s\times s)\times(\overline{s}\times\overline{s}),
      \gamma',
      (s\times\overline{s})\times(\overline{s}\times s)
    \big)
    \in\Gamma
  \]
  where
  \[
    \gamma'\big((f',\overline{f}'),(\overline{f},f)\big)
    = \big((f',f),(\overline{f}',\overline{f})\big).
  \]
  By \cref{proposition:i-16}~(\cref{section:i}), there exists $S\subs(s\times s)\times(\overline{s}\times\overline{s})$ such that
  \[
    (S,\gamma'\iota,\sq(s,\overline{s}))
    \in\Gamma.
  \]
  We see that $\gamma'\iota$ is an isomorphism from $\vsq(\CC^\smallbullet,\overline{\CC}^\smallbullet)$ to a subcategory of $(\CC\times\CC)^\perp\times(\overline{\CC}^\smallbullet\times\overline{\CC}^\smallbullet)$.
  By \cref{theorem:ii-14}, $(\gamma'(\vsq(\CC^\smallbullet,\overline{\CC}^\smallbullet)),S)$ is an $\HH(\HH',\HH)$-structured subcategory of $\Sigma$.
  Thus, by \cref{theorem:ii-12}, $(\vsq(\CC^\smallbullet,\overline{\CC}^\smallbullet),\sq(s,\overline{s}))$ is an $\HH(\HH',\HH)$-structured category.
  An analogous proof shows that we also have that
  \[
    \big(\hsq(\CC^\smallbullet,\overline{\CC}^\smallbullet,\sq(s,\overline{s})\big)
    \in\overline{\HH}(\HH',\HH)_0.
    \qedhere
  \]
\end{proof}

\begin{theorem}{16}
\label{theorem:ii-16}
  \oldpage{420}
  Let $(\CC^\smallbullet,s)$ be an $\HH(\HH',\HH)$-structured category (resp. an $\HH((\HH',\HH'),\HH)$-structured category).
  Then there exists $\sq s\in\HH_0$ such that $(\vsq\CC^\smallbullet,\sq s)$ and $(\hsq\CC^\smallbullet,\sq s)$ are $\HH(\HH',\HH)$-structured categories (resp. $\HH((\HH',\HH'),\HH)$-structured categories).
  If $(\CC^\smallbullet,s)$ belongs to $\overline{\GG}(\HH',\HH)_0$ (resp. to $\overline{\GG}((\HH',\HH'),\HH)_0$), then so too do $(\vsq\CC^\smallbullet,\sq s)$ and $(\hsq\CC^\smallbullet,\sq s)$.
\end{theorem}

\begin{longcomm}{92.1}
  This theorem is also valid if $p$ only creates pullbacks (cf. \cite{coll109}).
  It implies that \emph{the 2-category of structured categories is representable} (in the sense of Gray~\cite{comm39}), and this result still holds for internal categories in a category admitting pullbacks (\cite{coll115,comm39}).
\end{longcomm}

\begin{proof}
  Suppose that $(\CC^\smallbullet,s)\in\overline{\HH}(\HH',\HH)_0$.
  A quartet $(h',f',f,h)$ belonging to $\sq\CC^\smallbullet$ can be identified with an element $((h',f'),(f,h))$ of $\sq(\CC^\smallbullet,\CC^\smallbullet)$ such that $h'\smallbullet f=f'\smallbullet h$.
  By \cref{proposition:ii-4}, we have that
  \[
    \big(
      (s\times s)\times(s\times s),
      \gamma,
      (s\times s)\times(s\times s)
    \big)
  \]
  where
  \[
    \gamma\big((h',f'),(f,h)\big)
    = \big((h',f),(f',h)\big).
  \]
  Let $s'\subs s\times s$ be such that $p(s')=\CC^\smallbullet\star\CC^\smallbullet$;
  by \cref{proposition:ii-3}, we have that
  \[
    s'\times s'
    \subs (s\times s)\times(s\times s);
  \]
  furthermore, $s'\times s'$ is a $p$-kernel, and \cref{proposition:i-16}~(\cref{section:i}) ensures the existence of
  \[
    (s'\times s',\gamma_1,S)
    \in\Gamma
  \]
  where $\gamma_1<\gamma$.
  By axiom~(R) of \cref{definition:i-9}~(\cref{section:i}), the pair $((s,\chi^\smallbullet p_1\gamma_1,S),(s,\chi^\smallbullet p_2\gamma_1,S))$ admits a $p$-kernel $\sq s\subs\sq(s,s)$ (see \cref{theorem:ii-15}) such that
  \[
    p(\sq s) = \sq\CC^\smallbullet.
  \]
  Consequently, it follows from \cref{theorem:ii-14} that
  \[
    (\vsq\CC^\smallbullet,s)
    \textand
    (\hsq\CC^\smallbullet,s)
  \]
  are $\HH(\HH',\HH)$-structured categories.
  If, further, $(\CC^\smallbullet,s)\in\overline{\GG}_0$\comm{92.2}{$\overline{\GG}=\overline{\GG}(\HH,\HH)$ by definition.}, then, again denoting by $j$ the map $f\mapsto f^{-1}$ in $\CC$, the relations
  \[
    \big(
      (s\times s)\times(s\times s),
      \gamma_2(\iota\times j)\times(j\times\iota)\iota,
      \sq s
    \big)
    \in\HH
    \textand
    \gamma_2(\iota\times j)\times(j\times\iota)(\sq\CC^\smallbullet)
    \subset\sq\CC^\smallbullet,
  \]
  where
  \[
    \gamma_2\big((h',f'),(f,h)\big)
    = \big((h,f'),(f,h')\big),
  \]
  imply that $(\sq s,\vsq j,\sq s)\in\Gamma$, where $\vsq j$ denotes the map $\overline{k}\mapsto\overline{k}^{-1}$ in $\vsq\CC^\smallbullet$.
  This proves that $(\vsq\CC^\smallbullet,\sq s)\in\overline{\GG}_0$;
  we similarly have that $(\hsq\CC^\smallbullet,\sq s)\in\overline{\GG}_0$.

  Now suppose that $(\CC^\smallbullet,s)\in\overline{\HH}((\HH',\HH'),\HH)_0$;
  by the above, we have that $(\vsq\CC^\smallbullet,\sq s)\in\overline{\HH}_0$.
  Let $\vsq s_0\subs\sq s$ be such that $p(\vsq s_0)=(\vsq\CC^\smallbullet)_0$.
  Let $\mu$ be the map $h\mapsto((h,\beta(h)),(\alpha(h),h))$ from $\CC$ to $(\vsq\CC^\smallbullet)_0$;
  the relations
  \[
    \begin{aligned}
      \overline{\mu}
      &= (\vsq s_0,\mu,s)
      = (\vsq s_0,[[\iota,\beta],[\alpha,\iota]],s)
      \in\HH
    \\\overline{\mu}'
      &= (s,\mu^{-1},\vsq s_0)
      = (s,p'_1p_1\iota,\vsq s_0)
      \in\HH
    \end{aligned}
  \]
  \oldpage{421}
  imply that
  \[
    \overline{\mu}\smallbullet\overline{\mu}' = \vsq s_0
    \textand
    \overline{\mu}'\smallbullet\overline{\mu} = s
  \]
  whence $\overline{\mu}\in\Gamma$.
  We will show that $(\vsq s_0,\alpha^\vsqbox,\sq s)\in\HH'$.
  Let
  \[
    \overline{a}_1
    = \big(
      (s\times s)\times(s\times s),
      (\beta\times\iota)\times(\alpha\times\iota),
      (s\times s)\times(s\times s)
    \big)
    \in\HH'.
  \]
  Let $s_1$ be the $p$-kernel of the pair\comm{93.1}{We have that $p(s_1)=\{(\beta(f'),f',\alpha(h),h)\mid\alpha(f')=\beta(h)\}$.}
  \[
    \big(
      (s_0,\alpha p_2p'_1\iota,s_\beta\times s_\alpha),
      (s_0,\beta p_2p'_2\iota,s_\beta\times s_\alpha)
    \big).
  \]
  Since $p(\overline{a}_1)(\sq\CC^\smallbullet)\subset p(s_1)$, we have, by \cref{proposition:i-10}~(\cref{section:i}), that
  \[
    \overline{a}'_1
    = \overline{a}_1
    \vdash_p (s_1,\sq s)
    \in\HH'.
  \]
  We also have that\comm{93.2}{Pointwise, we have \[(h',f',f,h)\xmapsto{\overline{a}_1}(h',\beta f',\alpha f,h)\xmapsto{\overline{a}_2}(h',\alpha f,h)\xmapsto{\overline{a}_3}(\alpha h',\alpha f,h)\xmapsto{\gamma_{\beta\alpha}}h.\]}
  \[
    \begin{aligned}
      \overline{a}_2
      &= (s\times s_\alpha,\gamma_\beta\times\iota,s_\beta\times s_\alpha)
      \in\Gamma
    \\\overline{a}_3
      &= (s_0\times s,\alpha\times\iota,s\times s_\alpha)
      \in\HH'
    \end{aligned}
  \]
  whence $\overline{a}_3\smallbullet\overline{a}_2\in\HH'$.
  Since $p(\overline{a}_3\smallbullet\overline{a}_2)(p(s_1))\subset p(s_{\beta\alpha})$, we find that
  \[
    \overline{a}'_2
    = (\overline{a}_3\smallbullet\overline{a}_2)
    \vdash_p (s_{\beta\alpha},s_1)
    \in\HH'.
  \]
  Finally, we obtain that
  \[
    \big(\vsq s_0,\alpha^\vsqbox,\sq s\big)
    = \overline{\mu}^{-1}\smallbullet\overline{\gamma}_{\beta\alpha}\smallbullet\overline{a}'_2\smallbullet\overline{a}'_1
    \in\HH'.
  \]
  We can similarly prove that $(\vsq s_0,\beta^\vsqbox,\sq s)\in\HH'$.
  Thus\comm{93.3}{In the case $\HH((\HH',\HH'),\HH)$, the proof is more complex because the indiscrete structured groupoid on $s$ (used in the proof of \cref{theorem:ii-15}) is not $\HH((\HH',\HH'),\HH)$-structured. This remark also applies to \cref{theorem:ii-17}.}
  \[
    (\vsq\CC^\smallbullet,\sq s)
    \in\overline{\HH}((\HH',\HH'),\HH)_0
  \]
  and, for the same reason,
  \[
    (\hsq\CC^\smallbullet,\sq s)
    \in\overline{\HH}((\HH',\HH'),\HH)_0
    \qedhere
  \]
\end{proof}

\begin{corollary*}
  There exist functors $\ovsq$ and $\ohsq$ from the category $\overline{H}(\HH',\HH')$ (resp. $\overline{\HH}((\HH',\HH'),\HH)$, resp. $\overline{\GG}(\HH',\HH)$, resp. $\overline{\GG}((\HH',\HH'),\HH)$) to itself, and a natural equivalence $(\ohsq,\overline{\varepsilon},\ovsq)$ that project under $\overline{p}$ to the natural equivalence $(\hsq,\varepsilon,\vsq)$.
\end{corollary*}

\begin{proof}
  Let $((\overline{\CC}^\smallbullet,\overline{s}),g,(\CC^\smallbullet,s))\in\overline{\HH}$;
  by \cref{theorem:ii-13}, we have that
  \[
    \big(
      (\overline{\CC}^\smallbullet,\overline{s})^4,
      (g\times g)\times(g\times g),
      (\CC^\smallbullet,s)^4
    \big)
    \in\overline{\HH}
  \]
  whence
  \[
    \big(
      (\overline{s}\times\overline{s})\times(\overline{s}\times\overline{s}),
      ((g\times g)\times(g\times g))\iota,
      \sq s
    \big)
    \in\HH.
  \]
  \oldpage{422}
  Since $g^4(\sq\CC^\smallbullet)=(\sq g)(\sq\CC^\smallbullet)\subset\sq\overline{\CC}^\smallbullet$, it follows from the definition of $\sq\overline{s}$ that
  \[
    (\sq\overline{s},\sq g,\sq s)\in\HH
  \]
  i.e. that
  \[
    \big(
      (\vsq\overline{\CC}^\smallbullet,\sq\overline{s}),
      \sq g,
      (\vsq\CC^\smallbullet,\sq s)
    \big)
    \in\overline{\HH}.
  \]
  Since $\vsq$ is a functor from $\FF$ to $\FF$, the map
  \[
    \ovsq\colon
    \big(
      (\overline{\CC}^\smallbullet,\overline{s}),
      g,
      (\CC^\smallbullet,s)
    \big)
    \longmapsto
    \big(
      (\vsq\overline{\CC}^\smallbullet,\sq\overline{s}),
      \sq g,
      (\vsq\CC^\smallbullet,\sq s)
    \big)
  \]
  is a functor from $\overline{\HH}$ to $\overline{\HH}$.
  Similarly, the map
  \[
    \ohsq\colon
    \big(
      (\overline{\CC}^\smallbullet,\overline{s}),
      g,
      (\CC^\smallbullet,s)
    \big)
    \longmapsto
    \big(
      (\hsq\overline{\CC}^\smallbullet,\sq\overline{s}),
      \sq g,
      (\hsq\CC^\smallbullet,\sq s)
    \big)
  \]
  is a functor from $\overline{\HH}$ to $\overline{\HH}$.

  Finally, by \cref{proposition:i-4}~(\cref{section:i}) and \cref{proposition:ii-7}~(\cref{section:i}), we find that
  \[
    \big(
      (s\times s)\times(s\times s),
      \gamma,
      (s\times s)\times(s\times s)
    \big)
    \in\Gamma,
  \]
  where
  \[
    \begin{aligned}
      \gamma\big((h',f'),(f,h)\big)
      &= \big((f',h'),(h,f)\big)
    \\\varepsilon(s)
      &= (\sq s,\gamma\iota,\sq s)
      \in\Gamma.
    \end{aligned}
  \]
  Then
  \[
    \overline{\varepsilon}(\CC^\smallbullet,s)
    = \big(
      (\hsq\CC^\smallbullet,\sq s),
      \gamma\iota,
      (\vsq\CC^\smallbullet,\sq s)
    \big)
    \in\overline{\Gamma}
  \]
  and $(\ohsq,\overline{\varepsilon},\ovsq)$ is a natural equivalence.
  Furthermore, we have that
  \[
    \overline{p}(\overline{\varepsilon}(\CC^\smallbullet,s))
    = \varepsilon(\CC^\smallbullet).
    \qedhere
  \]
\end{proof}

\begin{remark}
  With the hypotheses of \cref{theorem:ii-15}, a proof analogous to that of the end of the proof of \cref{theorem:ii-16} allows us to prove the following:
\end{remark}

\begin{theorem}{15~bis}
\label{theorem:ii-15bis}
  If $(\CC^\smallbullet,s)$ and $(\overline{\CC}^\smallbullet,\overline{s})$ are $\overline{\HH}((\HH',\HH'),\HH)$-structured categories, then so too is $(\vsq(\CC^\smallbullet,\overline{\CC}^\smallbullet),\sq(s,\overline{s}))$.
\end{theorem}

\begin{examples}
  ---
  \begin{enumerate}
    \item[\normalfont(1)]
      If $(\CC^\smallbullet,s)$ is a topological category, then $(\vsq\CC^\smallbullet,\sq s)$ is a topological category.

    \item[\normalfont(2)]
      If $(\CC^\smallbullet,s)$ is an ordered category (resp. ordered groupoid), then $(\vsq\CC^\smallbullet,\sq s)$ is an ordered category (resp. ordered groupoid).
      If $(\CC^\smallbullet,s)$ is an inductive category, then $(\vsq\CC^\smallbullet,\sq s)$ is an inductive category.

    \item[\normalfont(3)]
      If $(\CC^\smallbullet,\CC^\perp)$ is a double category, then $(\vsq\CC^\smallbullet,\CC^{\sq\perp},\hsq\CC^\smallbullet)$ is a triple category, where $\CC^{\sq\perp}$ denotes the class $\sq\CC^\smallbullet$ endowed with its structure as a subcategory of the product category $(\CC^\perp)^4$.
      \oldpage{423}
      More generally, if $(\CC^{\perp_i})_{i\leq n}$ is an $n$-fold category, then $(\vsq\CC^{\perp_1},(\CC^{\sq\perp_i})_{2\leq i\leq n})$ is an $n$-fold category, and
      \[
        \big(
          \vsq\CC^{\perp_1},
          (\CC^{\sq\perp_i})_{2\leq i\leq n},
          \hsq\CC^{\perp_1}
        \big)
      \]
      is an $(n+1)$-fold category.
      In particular, let $\CC$ be a category.
      By induction on  $n$, we construct the $n$-fold category
      \[
        \CC^\boxnum{n}
        = \big(\CC^{\boxnum{n}\perp_i}\big)_{i\leq n}
      \]
      defined by
      \[
        \CC^\boxnum{2} = (\vsq\CC,\hsq\CC)
        \textand
        \CC^\boxnum{n+1} = \left(
          \vsq\big(\CC^\boxnum{n}\big),
          \big(\big(\CC^\boxnum{n}\big)^{\sq\perp_i}\big)_{i\leq n},
          \hsq\big(\CC^\boxnum{n}\big)
        \right).
      \]
      We obtain the formulas
      \[
        \CC^\boxnum{n+1}
        = \left(
          \vsq^n\CC,
          \big((\sq(\hsq^{p-1}\CC))^{\sq^{n-p}\hsq}\big)_{1\leq p\leq n}
        \right)
      \]
      where
      \[
        \vsq^0\CC = \CC
        \textand
        \vsq^n\CC = \vsq(\vsq^{n-1}\CC);
      \]
      the symbol $(\sq(\hsq^{p-1}\CC))^{\sq^{n-p}\hsq}$ denotes, in agreement with the conventions above, the class $\sq(\vsq^{p-1}\CC)$ endowed with its structure as a subcategory of the product category $(\hsq(\vsq^{p-1}\CC))^{4^{n-p}}$.
      The $n$-fold category $\CC^\boxnum{n}$ is identical to the $n$-fold category $\CC^\boxnum{n}$ constructed in the final remark of \cref{section:ii.5}.
  \end{enumerate}
\end{examples}

Recall that, if $\CC^\smallbullet$ is a category, then we define the \emph{category of trios} of $\CC$, denoted $\trio\CC^\smallbullet$, to be the class of triples $((f',f),h)\in(\CC\times\CC)\times\CC$ such that
\[
  \alpha(f)=\alpha(h)
  \textand
  \alpha(f')=\beta(h),
\]
endowed with the composition law $\sqsupset$ given by
\[
  ((\overline{f}',\overline{f}),\overline{h}) \sqsupset ((f',f),h)
  = ((\overline{f}',f),\overline{h}\smallbullet h)
  \quad\text{if and only if}\quad
  \overline{f}=f'.
\]

\begin{theorem}{17}
\label{theorem:ii-17}
  Let $(\CC^\smallbullet,s)$ be an $\HH(\HH',\HH)$-structured category (resp. an $\HH((\HH',\HH'),\HH)$-structured category).
  Then there exists $\trio s\in\HH_0$ such that $(\trio\CC^\smallbullet,\trio s)$ is an $\HH(\HH',\HH')$-structured category (resp. an $\HH((\HH',\HH'),\HH)$-structured category);
  if $(\CC^\smallbullet,s)\in\overline{\GG}(\HH',\HH)_0$, then we also have that $(\trio\CC^\smallbullet,\trio s)\in\overline{\GG}(\HH',\HH)_0$.
\end{theorem}

\begin{proof}
  Using \cref{proposition:ii-4}, we see that
  \[
    \begin{aligned}
      \overline{g}
      &= (s\times s,\alpha p_2\times\beta, (s\times s)\times s)
      \in\HH
    \\\overline{g}'
      &= (s\times s,\pi(\alpha p_1\times\alpha), (s\times s)\times s)
      \in\HH
    \end{aligned}
  \]
  where $\pi(f_1,f_2)=(f_2,f_1)$.
  Since $\trio\CC^\smallbullet$ is the class of elements $((f',f),h)$ such that
  \[
    p(\overline{g})\big((f',f),h\big)
    = (\alpha(f),\beta(h))
    = p(\overline{g}')\big((f',f),h\big),
  \]
  \oldpage{424}
  axiom~(R) of \cref{definition:i-9}~(\cref{section:i}) ensures the existence of $\trio s\subs(s\times s)\times s$ with $p(\trio s)=\trio\CC^\smallbullet$.
  Since $\trio\CC^\smallbullet$ is a subcategory of $(\CC\times\CC)^\perp\times\CC^\smallbullet$, it follows from \cref{theorem:ii-14} and \cref{proposition:ii-30} that $(\trio\CC^\smallbullet,\trio s)$ is an $\HH(\HH',\HH)$-structured category.
  If, further, $(\CC^\smallbullet,s)\in\overline{\GG}(\HH',\HH)_0$, then, for the same reason, we also have that $(\trio\CC^\smallbullet,\trio s)\in\overline{\GG}(\HH',\HH)_0$.
  If $(\CC^\smallbullet,s)$ is an $\HH((\HH',\HH'),\HH)$-structured category, then there exists $\trio s_0\subs\trio s$ such that
  \[
    p(\trio s_0)
    = (\trio\CC^\smallbullet)_0.
  \]
  We will show that $(\trio s_0,\alpha^{\trio},\trio s)\in\HH'$.
  Using \cref{proposition:i-4}~\cref{section:i} and \cref{proposition:i-7}~(\cref{section:i}), we find that
  \[
    \begin{aligned}
      \overline{a}_1
      = &\big(
        s\times(s_0\times s),
        \gamma,
        (s\times s_0)\times s
      \big)
    \\\smallbullet
      &\big(
        (s\times s_0)\times s,
        \pi\times\iota,
        (s_0\times s)\times s
      \big)
    \\\smallbullet
      &\big(
        (s_0\times s)\times s,
        (\alpha\times\iota)\times\iota,
        (s\times s)\times s
      \big)
    \end{aligned}
  \]
  where\comm{96.1}{``Pointwise'', we get \[((f',f),h)\xmapsto{\overline{a}_1}(f,(\beta h, h))\xmapsto{\overline{a}_2}(f,\alpha h)\xmapsto{\overline{a}_3}((f,f),\alpha f).\]}
  \[
    \begin{aligned}
      \gamma((f',e),h)
      &= (f',(e,h))
    \\\overline{a}_2
      &= (s\times s_0,\iota\times\alpha,s\times s)\smallbullet(s\times s,\iota\times\gamma_\beta,s\times s_\beta)
      \in\HH'
    \\\overline{a}_3
      &= \big(
        (s\times s)\times s_0,
        ([\iota,\iota]\times\iota)\iota,
        s'_\alpha
      \big)
      \vdash_p (\trio s_0,s'_\alpha)
      \in\Gamma.
    \end{aligned}
  \]
  Axiom~(R) allows us to construct $s_1\subs s\times s_\beta$ such that $p(s_1)$ is the class of triples $(f,(\beta(h),h))$ for which $\alpha(f)=\alpha(h)$.
  From the relations
  \[
    p(\overline{a}_1)(\trio\CC^\smallbullet)\subs p(s_1)
    \textand
    p(\overline{a}_2)(p(s_1))\subs p(s'_\alpha)
  \]
  we deduce, with the help of \cref{proposition:i-10}~(\cref{section:i}), that
  \[
    \overline{a}'_1 = \overline{a}_1 \vdash_p (s_1,\trio s)
    \in\HH'
    \textand
    \overline{a}'_2 = \overline{a}_2 \vdash_p (s'_\alpha,s_1)
    \in\HH'.
  \]
  It thus follows that
  \[
    (\trio s_0,\alpha^{\trio},\trio s)
    = \overline{a}_3\smallbullet\overline{a}'_2\smallbullet\overline{a}'_1
    \in\HH'
    \textand
    (\trio\CC^\smallbullet,\trio s)
    \in\overline{\HH}((\HH',\HH'),\HH)_0.
    \qedhere
  \]
\end{proof}

\begin{corollary*}
  Let $(\CC^\smallbullet,s)$ be an $\HH$-structured category;
  we have that
  \[
    \overline{\tau}
    = \big(
      (\trio\CC^\smallbullet,\trio s),
      \tau,
      (\hsq\CC^\smallbullet,\sq s)
    \big)
    \in\overline{\HH}
  \]
  where
  \[
    \tau\big((h',f'),(f,h)\big)
    = ((f',f),h).
  \]
  If $(\CC^\smallbullet,s)$ is an $\HH$-structured groupoid, then $\overline{\tau}\in\overline{\Gamma}$.
\end{corollary*}

\begin{proof}
  By \cref{proposition:i-4}~(\cref{section:i}) and \cref{proposition:i-7}~(\cref{section:i}), we have that
  \[
    (\trio s,\tau,\sq s)
    = \big(
      (s\times s)\times s,
      \gamma'(p_2\times\iota),
      (s\times s)\times(s\times s)
    \big)
    \vdash_p (\trio s,\sq s)
    \in\HH
  \]
  where
  \[
    \gamma'(f',(f,h))
    = ((f',f),h).
  \]
  \oldpage{425}
  We will show that, if further $(\CC^\smallbullet,s)\in\overline{\GG}_0$, then we also have that $(\sq s,\tau^{-1},\trio s)\in\HH$.
  Indeed, by \cref{proposition:ii-4}, we have that
  \[
    (s\times s,\pi,s\times s)
    \in\Gamma
  \]
  where $\pi(f,h)=(h,f)$.
  Let
  \[
    \overline{b}_1
    = \big(
      s\times(s\times s),
      \iota\times(\iota\times j),
      s\times(s\times s)
    \big)
    \smallbullet
    \big(
      s\times(s\times s),
      (\iota\times\pi)\gamma'^{-1},
      (s\times s)\times s
    \big)
    \in\Gamma;
  \]
  \cref{proposition:i-16}~(\cref{section:i}) ensures the existence of $s_1\subs s\times(s\times s)$ such that
  \[
    \overline{b}'_1
    = \overline{b}_1 \vdash_p (s_1,\trio s)
    \in\Gamma.
  \]
  By \cref{theorem:i-1}~(\cref{section:i}), we have that
  \[
    s_1\subs s\times s'
  \]
  where $p(s')=\CC^\smallbullet\star\CC^\smallbullet$, whence
  \[
    (s\times s,(\iota\times\chi^\smallbullet)\iota,s_1)
    \in\HH;
  \]
  since $(\iota\times\chi^\smallbullet)(p(s_1))\subset p(s')$, we find that
  \[
    \overline{b}_2
    = (s\chi^\smallbullet,s') \smallbullet (s',(\iota\times\chi^\smallbullet)\iota,s_1)
    \in\HH.
  \]
  By \cref{proposition:ii-4}, we have that
  \[
    \overline{\gamma}_1
    = \big(
      (s\times s)\times(s\times s),
      \gamma_1,
      s\times((s\times s)\times s)
    \big)
    \in\Gamma
  \]
  where
  \[
    \gamma_1\big(h',((f',f),h)\big)
    = \big((h',f'),(f,h)\big).
  \]
  It thus follows that\comm{97.1}{``Pointwise'', these maps are \[((f',f),h)\xmapsto{\overline{b}_1}(f',(h,f^{-1}))\xmapsto{\overline{b}_2}f'\smallbullet h\smallbullet f^{-1}\] and \[((f',f),h)\xmapsto{\overline{b}_3}((f'\smallbullet h\smallbullet f^{-1},f'),(f,h)).\]}
  \[
    \overline{b}_3
    = \overline{\gamma}_1\smallbullet(\overline{b}_2\smallbullet\overline{b}'_1\times\trio s)\smallbullet(\trio s\times\trio s,[\iota,\iota],\trio s)
    \in\HH
  \]
  and
  \[
    p(\overline{b}_3)(\trio\CC^\smallbullet)
    = \tau^{-1}(\trio\CC^\smallbullet)
    \subset \sq\CC^\smallbullet.
  \]
  Thus
  \[
    \overline{b}_3
    \vdash_p (\sq s,\trio s)
    = (\sq s,\tau^{-1},\trio s)
    \in\HH
    \textand
    (\trio s,\tau,\sq s)
    \in\Gamma.
    \qedhere
  \]
\end{proof}

\begin{remark}
  In general, if $(\CC^\smallbullet,s)$ belongs to $\overline{\HH}(\HH',\HH'')_0$, then the same is not true of $(\vsq\CC^\smallbullet,\sq s)$ or $(\trio\CC^\smallbullet,\trio s)$.
  However, if $\HH''$ is a subcategory of $\HH$ that is stable under products, that satisfies condition~($\sigma$) of \cref{proposition:i-10}~(\cref{section:i}), and that contains $\HH'$, then we have the following:
\end{remark}

\begin{theorem}{18}
\label{theorem:ii-18}
  If $(\CC^\smallbullet,s)$ belongs to $\overline{\HH}(\HH',\HH'')_0$, then so too do $(\vsq\CC^\smallbullet,\sq s)$, $(\hsq\CC^\smallbullet,\sq s)$, and $(\trio\CC^\smallbullet,\trio s)$.
\end{theorem}

\begin{longcomm}{97.2}
  \cref{theorem:ii-18} should read as follows:
  \begin{quote}
    \itshape
    If $(\CC^\smallbullet,s)$ belongs to $\overline{\HH}(\HH',\HH'')_0$ (resp. to $\overline{\HH}((\HH',\HH'),\HH'')_0$), then so too do $(\vsq\CC^\smallbullet,\sq s)$ and $(\hsq\CC^\smallbullet,\sq s)$ (resp. and also for $(\trio\CC^\smallbullet,\trio s)$).
  \end{quote}
  That is, $(\trio\CC^\smallbullet,\trio s)$ may not be $\HH(\HH',\HH'')$-structured even when $(\CC^\smallbullet,s)$ is (counterexamples exist).

  The proof is not evident.
  Suppose that $(\CC^\smallbullet,s)$ is $\HH(\HH',\HH'')$-structured.
  To prove the claim for $(\vsq\CC^\smallbullet,\sq s)$, the idea is to lift the following composite in $\HH''$ by a process similar to the one used in the preceding proof:
  \[
    \begin{aligned}
      \big(
        (h'',g',g,h'),
        (h',f',f,h)
      \big)
      &\xmapsto{\iota\times[\beta,\alpha]^2\times\iota}
      \big(
        h'', g', g, \beta h', \alpha h', \beta h', \alpha h', f', f, h
      \big)
    \\&\xmapsto{\cong}
      \big(
        h'',
        (g',\alpha g'),
        (g,\alpha g),
        (\beta f',f'),
        (\beta f, f),
        h
      \big)
    \\&\xmapsto{\iota\times(\gamma'_\alpha)^2\times(\gamma'_\beta)^2\times\iota}
      \big(
        h'', g', g, f', f, h
      \big)
    \\&\xmapsto[\cong]{\iota\times\chi^2\times\iota}
      \big(
        h'', g'\smallbullet f', g\smallbullet f, h
      \big)
    \end{aligned}
  \]
  \[
    \begin{tikzcd}
      {}
      & {} \ar[l,swap,"g'"]
      & {} \ar[l,swap,"f'"]
    \\{} \ar[u,"h''"]
      & {} \ar[l,"g"] \ar[u,swap,"h'"]
      & {} \ar[l,"f"] \ar[u,swap,"h"]
    \end{tikzcd}
  \]
  (we have omitted the canonical isomorphisms between products).

  If $(\CC^\smallbullet,s)$ is $\HH((\HH',\HH'),\HH'')$-structured, then a similar proof only lifting the sources in $\HH'\subset\HH''$ shows that $(\hsq\CC^\smallbullet,\sq s)$ and $(\trio\CC^\smallbullet,\trio s)$ are $\HH((\HH',\HH'),\HH'')$-structured.
\end{longcomm}

\begin{remark}
  \emph{(Added during the correction of proofs).}

  Let $(\CC^\smallbullet,s)$ be an $\HH$-structured category and $\rho$ an equivalence relation on $\CC$ such that there exists a quotient category $\CC^\smallbullet/\rho$ of $\CC^\smallbullet$.
  If there exists a quotient structure \cite{3e} $s/\rho$ of $s$ by $\rho$ in $(\MM,p,\HH,\Gamma)$, then, in general, $(\CC^\smallbullet/\rho,s/\rho)$ is not an $\HH$-structured category.
  This is why more recently we have avoided defining the notion of a weakly $\HH$-structured category, stable under passing to the quotient (see \cite{coll66}).
\end{remark}





%% Bibliography %%

\begingroup
\let\clearpage\relax
  \printbibliography[keyword={orig},heading=bibintoc,title=Bibliography]
  \printbibliography[keyword={coll},title={Citations to the collected works}]
  \printbibliography[keyword={comm},title={Citations from comments in the collected works}]
\endgroup

\end{document}
